{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/drop_down_editor/ui.drop_down_editor.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport $ from \"../../core/renderer\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport Guid from \"../../core/guid\";\nimport registerComponent from \"../../core/component_registrator\";\nimport { noop, splitPair } from \"../../core/utils/common\";\nimport { focused } from \"../widget/selectors\";\nimport { each } from \"../../core/utils/iterator\";\nimport { isDefined } from \"../../core/utils/type\";\nimport { extend } from \"../../core/utils/extend\";\nimport { getPublicElement } from \"../../core/element\";\nimport errors from \"../widget/ui.errors\";\nimport animationPosition from \"../../animation/position\";\nimport { getDefaultAlignment } from \"../../core/utils/position\";\nimport DropDownButton from \"./ui.drop_down_button\";\nimport Widget from \"../widget/ui.widget\";\nimport messageLocalization from \"../../localization/message\";\nimport { addNamespace, isCommandKeyPressed } from \"../../events/utils/index\";\nimport TextBox from \"../text_box\";\nimport { name as clickEventName } from \"../../events/click\";\nimport devices from \"../../core/devices\";\nimport { FunctionTemplate } from \"../../core/templates/function_template\";\nimport Popup from \"../popup\";\nimport { hasWindow } from \"../../core/utils/window\";\nimport { getElementWidth, getSizeValue } from \"./utils\";\nimport { locate, move } from \"../../animation/translator\";\nvar DROP_DOWN_EDITOR_CLASS = \"dx-dropdowneditor\";\nvar DROP_DOWN_EDITOR_INPUT_WRAPPER = \"dx-dropdowneditor-input-wrapper\";\nvar DROP_DOWN_EDITOR_BUTTON_ICON = \"dx-dropdowneditor-icon\";\nvar DROP_DOWN_EDITOR_OVERLAY = \"dx-dropdowneditor-overlay\";\nvar DROP_DOWN_EDITOR_OVERLAY_FLIPPED = \"dx-dropdowneditor-overlay-flipped\";\nvar DROP_DOWN_EDITOR_ACTIVE = \"dx-dropdowneditor-active\";\nvar DROP_DOWN_EDITOR_FIELD_CLICKABLE = \"dx-dropdowneditor-field-clickable\";\nvar DROP_DOWN_EDITOR_FIELD_TEMPLATE_WRAPPER = \"dx-dropdowneditor-field-template-wrapper\";\nvar isIOs = \"ios\" === devices.current().platform;\nvar DropDownEditor = TextBox.inherit({\n  _supportedKeys: function () {\n    return extend({}, this.callBase(), {\n      tab: function (e) {\n        if (!this.option(\"opened\")) {\n          return;\n        }\n\n        if (\"instantly\" === this.option(\"applyValueMode\")) {\n          this.close();\n          return;\n        }\n\n        var $focusableElement = e.shiftKey ? this._getLastPopupElement() : this._getFirstPopupElement();\n        $focusableElement && eventsEngine.trigger($focusableElement, \"focus\");\n        e.preventDefault();\n      },\n      escape: function (e) {\n        if (this.option(\"opened\")) {\n          e.preventDefault();\n        }\n\n        this.close();\n        return true;\n      },\n      upArrow: function (e) {\n        if (!isCommandKeyPressed(e)) {\n          e.preventDefault();\n          e.stopPropagation();\n\n          if (e.altKey) {\n            this.close();\n            return false;\n          }\n        }\n\n        return true;\n      },\n      downArrow: function (e) {\n        if (!isCommandKeyPressed(e)) {\n          e.preventDefault();\n          e.stopPropagation();\n\n          if (e.altKey) {\n            this._validatedOpening();\n\n            return false;\n          }\n        }\n\n        return true;\n      },\n      enter: function (e) {\n        if (this.option(\"opened\")) {\n          e.preventDefault();\n\n          this._valueChangeEventHandler(e);\n        }\n\n        return true;\n      }\n    });\n  },\n  _getDefaultButtons: function () {\n    return this.callBase().concat([{\n      name: \"dropDown\",\n      Ctor: DropDownButton\n    }]);\n  },\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      value: null,\n      onOpened: null,\n      onClosed: null,\n      opened: false,\n      acceptCustomValue: true,\n      applyValueMode: \"instantly\",\n      deferRendering: true,\n      activeStateEnabled: true,\n      dropDownButtonTemplate: \"dropDownButton\",\n      fieldTemplate: null,\n      openOnFieldClick: false,\n      showDropDownButton: true,\n      buttons: void 0,\n      dropDownOptions: {\n        showTitle: false\n      },\n      popupPosition: this._getDefaultPopupPosition(),\n      onPopupInitialized: null,\n      applyButtonText: messageLocalization.format(\"OK\"),\n      cancelButtonText: messageLocalization.format(\"Cancel\"),\n      buttonsLocation: \"default\",\n      useHiddenSubmitElement: false\n    });\n  },\n  _useTemplates: function () {\n    return true;\n  },\n  _getDefaultPopupPosition: function (isRtlEnabled) {\n    var position = getDefaultAlignment(isRtlEnabled);\n    return {\n      offset: {\n        h: 0,\n        v: -1\n      },\n      my: position + \" top\",\n      at: position + \" bottom\",\n      collision: \"flip flip\"\n    };\n  },\n  _defaultOptionsRules: function () {\n    return this.callBase().concat([{\n      device: function (_device) {\n        var isGeneric = \"generic\" === _device.platform;\n        return isGeneric;\n      },\n      options: {\n        popupPosition: {\n          offset: {\n            v: 0\n          }\n        }\n      }\n    }]);\n  },\n  _inputWrapper: function () {\n    return this.$element().find(\".\" + DROP_DOWN_EDITOR_INPUT_WRAPPER).first();\n  },\n  _init: function () {\n    this.callBase();\n\n    this._initVisibilityActions();\n\n    this._initPopupInitializedAction();\n\n    this._updatePopupPosition(this.option(\"rtlEnabled\"));\n\n    this._options.cache(\"dropDownOptions\", this.option(\"dropDownOptions\"));\n  },\n  _updatePopupPosition: function (isRtlEnabled) {\n    var {\n      my: my,\n      at: at\n    } = this._getDefaultPopupPosition(isRtlEnabled);\n\n    var currentPosition = this.option(\"popupPosition\");\n    this.option(\"popupPosition\", extend({}, currentPosition, {\n      my: my,\n      at: at\n    }));\n  },\n  _initVisibilityActions: function () {\n    this._openAction = this._createActionByOption(\"onOpened\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n    this._closeAction = this._createActionByOption(\"onClosed\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _initPopupInitializedAction: function () {\n    this._popupInitializedAction = this._createActionByOption(\"onPopupInitialized\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _initMarkup: function () {\n    this._renderSubmitElement();\n\n    this.callBase();\n    this.$element().addClass(DROP_DOWN_EDITOR_CLASS);\n    this.setAria(\"role\", \"combobox\");\n  },\n  _render: function () {\n    this.callBase();\n\n    this._renderOpenHandler();\n\n    this._attachFocusOutHandler();\n\n    this._renderOpenedState();\n  },\n  _renderContentImpl: function () {\n    if (!this.option(\"deferRendering\")) {\n      this._createPopup();\n    }\n  },\n  _renderInput: function () {\n    this.callBase();\n\n    this._wrapInput();\n\n    this._setDefaultAria();\n  },\n  _wrapInput: function () {\n    this._$container = this.$element().wrapInner($(\"<div>\").addClass(DROP_DOWN_EDITOR_INPUT_WRAPPER)).children().eq(0);\n  },\n  _setDefaultAria: function () {\n    this.setAria({\n      haspopup: \"true\",\n      autocomplete: \"list\"\n    });\n  },\n  _readOnlyPropValue: function () {\n    return !this._isEditable() || this.callBase();\n  },\n  _cleanFocusState: function () {\n    this.callBase();\n\n    if (this.option(\"fieldTemplate\")) {\n      this._detachFocusEvents();\n    }\n  },\n  _getFieldTemplate: function () {\n    return this.option(\"fieldTemplate\") && this._getTemplateByOption(\"fieldTemplate\");\n  },\n  _renderMask: function () {\n    if (this.option(\"fieldTemplate\")) {\n      return;\n    }\n\n    this.callBase();\n  },\n  _renderField: function () {\n    var fieldTemplate = this._getFieldTemplate();\n\n    fieldTemplate && this._renderTemplatedField(fieldTemplate, this._fieldRenderData());\n  },\n  _renderPlaceholder: function () {\n    var hasFieldTemplate = !!this._getFieldTemplate();\n\n    if (!hasFieldTemplate) {\n      this.callBase();\n    }\n  },\n  _renderValue: function () {\n    if (this.option(\"useHiddenSubmitElement\")) {\n      this._setSubmitValue();\n    }\n\n    var promise = this.callBase();\n    promise.always(this._renderField.bind(this));\n  },\n  _renderTemplatedField: function (fieldTemplate, data) {\n    var isFocused = focused(this._input());\n    var $container = this._$container;\n\n    this._detachKeyboardEvents();\n\n    this._refreshButtonsContainer();\n\n    this._detachWrapperContent();\n\n    this._detachFocusEvents();\n\n    $container.empty();\n    var $templateWrapper = $(\"<div>\").addClass(DROP_DOWN_EDITOR_FIELD_TEMPLATE_WRAPPER).appendTo($container);\n    fieldTemplate.render({\n      model: data,\n      container: getPublicElement($templateWrapper),\n      onRendered: () => {\n        var $input = this._input();\n\n        if (!$input.length) {\n          throw errors.Error(\"E1010\");\n        }\n\n        this._integrateInput();\n\n        isFocused && eventsEngine.trigger($input, \"focus\");\n      }\n    });\n\n    this._attachWrapperContent($container);\n  },\n\n  _detachWrapperContent() {\n    var _this$_$submitElement, _this$_$beforeButtons, _this$_$afterButtonsC;\n\n    var useHiddenSubmitElement = this.option(\"useHiddenSubmitElement\");\n    useHiddenSubmitElement && (null === (_this$_$submitElement = this._$submitElement) || void 0 === _this$_$submitElement ? void 0 : _this$_$submitElement.detach());\n    var beforeButtonsContainerParent = null === (_this$_$beforeButtons = this._$beforeButtonsContainer) || void 0 === _this$_$beforeButtons ? void 0 : _this$_$beforeButtons[0].parentNode;\n    var afterButtonsContainerParent = null === (_this$_$afterButtonsC = this._$afterButtonsContainer) || void 0 === _this$_$afterButtonsC ? void 0 : _this$_$afterButtonsC[0].parentNode;\n    null === beforeButtonsContainerParent || void 0 === beforeButtonsContainerParent ? void 0 : beforeButtonsContainerParent.removeChild(this._$beforeButtonsContainer[0]);\n    null === afterButtonsContainerParent || void 0 === afterButtonsContainerParent ? void 0 : afterButtonsContainerParent.removeChild(this._$afterButtonsContainer[0]);\n  },\n\n  _attachWrapperContent($container) {\n    var _this$_$submitElement2;\n\n    var useHiddenSubmitElement = this.option(\"useHiddenSubmitElement\");\n    $container.prepend(this._$beforeButtonsContainer);\n    useHiddenSubmitElement && (null === (_this$_$submitElement2 = this._$submitElement) || void 0 === _this$_$submitElement2 ? void 0 : _this$_$submitElement2.appendTo($container));\n    $container.append(this._$afterButtonsContainer);\n  },\n\n  _refreshButtonsContainer() {\n    this._$buttonsContainer = this.$element().children().eq(0);\n  },\n\n  _integrateInput: function () {\n    this._renderFocusState();\n\n    this._refreshValueChangeEvent();\n\n    this._refreshEvents();\n\n    this._refreshEmptinessEvent();\n  },\n  _refreshEmptinessEvent: function () {\n    eventsEngine.off(this._input(), \"input blur\", this._toggleEmptinessEventHandler);\n\n    this._renderEmptinessEvent();\n  },\n  _fieldRenderData: function () {\n    return this.option(\"value\");\n  },\n  _initTemplates: function () {\n    this._templateManager.addDefaultTemplates({\n      dropDownButton: new FunctionTemplate(function (options) {\n        var $icon = $(\"<div>\").addClass(DROP_DOWN_EDITOR_BUTTON_ICON);\n        $(options.container).append($icon);\n      })\n    });\n\n    this.callBase();\n  },\n  _renderOpenHandler: function () {\n    var $inputWrapper = this._inputWrapper();\n\n    var eventName = addNamespace(clickEventName, this.NAME);\n    var openOnFieldClick = this.option(\"openOnFieldClick\");\n    eventsEngine.off($inputWrapper, eventName);\n    eventsEngine.on($inputWrapper, eventName, this._getInputClickHandler(openOnFieldClick));\n    this.$element().toggleClass(DROP_DOWN_EDITOR_FIELD_CLICKABLE, openOnFieldClick);\n\n    if (openOnFieldClick) {\n      this._openOnFieldClickAction = this._createAction(this._openHandler.bind(this));\n    }\n  },\n  _attachFocusOutHandler: function () {\n    if (isIOs) {\n      this._detachFocusOutEvents();\n\n      eventsEngine.on(this._inputWrapper(), addNamespace(\"focusout\", this.NAME), event => {\n        var newTarget = event.relatedTarget;\n        var popupWrapper = this.content ? $(this.content()).closest(\".\" + DROP_DOWN_EDITOR_OVERLAY) : this._$popup;\n\n        if (newTarget && this.option(\"opened\")) {\n          var isNewTargetOutside = 0 === $(newTarget).closest(\".\" + DROP_DOWN_EDITOR_OVERLAY, popupWrapper).length;\n\n          if (isNewTargetOutside) {\n            this.close();\n          }\n        }\n      });\n    }\n  },\n  _detachFocusOutEvents: function () {\n    isIOs && eventsEngine.off(this._inputWrapper(), addNamespace(\"focusout\", this.NAME));\n  },\n  _getInputClickHandler: function (openOnFieldClick) {\n    return openOnFieldClick ? e => {\n      this._executeOpenAction(e);\n    } : e => {\n      this._focusInput();\n    };\n  },\n  _openHandler: function () {\n    this._toggleOpenState();\n  },\n  _executeOpenAction: function (e) {\n    this._openOnFieldClickAction({\n      event: e\n    });\n  },\n  _keyboardEventBindingTarget: function () {\n    return this._input();\n  },\n  _focusInput: function () {\n    if (this.option(\"disabled\")) {\n      return false;\n    }\n\n    if (this.option(\"focusStateEnabled\") && !focused(this._input())) {\n      this._resetCaretPosition();\n\n      eventsEngine.trigger(this._input(), \"focus\");\n    }\n\n    return true;\n  },\n  _resetCaretPosition: function () {\n    var ignoreEditable = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : false;\n\n    var inputElement = this._input().get(0);\n\n    if (inputElement) {\n      var {\n        value: value\n      } = inputElement;\n      var caretPosition = isDefined(value) && (ignoreEditable || this._isEditable()) ? value.length : 0;\n\n      this._caret({\n        start: caretPosition,\n        end: caretPosition\n      }, true);\n    }\n  },\n  _isEditable: function () {\n    return this.option(\"acceptCustomValue\");\n  },\n  _toggleOpenState: function (isVisible) {\n    if (!this._focusInput()) {\n      return;\n    }\n\n    if (!this.option(\"readOnly\")) {\n      isVisible = arguments.length ? isVisible : !this.option(\"opened\");\n      this.option(\"opened\", isVisible);\n    }\n  },\n  _renderOpenedState: function () {\n    var opened = this.option(\"opened\");\n\n    if (opened) {\n      this._createPopup();\n    }\n\n    this.$element().toggleClass(DROP_DOWN_EDITOR_ACTIVE, opened);\n\n    this._setPopupOption(\"visible\", opened);\n\n    this.setAria({\n      expanded: opened\n    });\n    this.setAria(\"owns\", opened ? this._popupContentId : void 0, this.$element());\n  },\n  _createPopup: function () {\n    if (this._$popup) {\n      return;\n    }\n\n    this._$popup = $(\"<div>\").addClass(DROP_DOWN_EDITOR_OVERLAY).appendTo(this.$element());\n\n    this._renderPopup();\n\n    this._renderPopupContent();\n  },\n  _renderPopupContent: noop,\n  _renderPopup: function () {\n    var popupConfig = extend(this._popupConfig(), this._options.cache(\"dropDownOptions\"));\n    this._popup = this._createComponent(this._$popup, Popup, popupConfig);\n\n    this._popup.on({\n      showing: this._popupShowingHandler.bind(this),\n      shown: this._popupShownHandler.bind(this),\n      hiding: this._popupHidingHandler.bind(this),\n      hidden: this._popupHiddenHandler.bind(this),\n      contentReady: this._contentReadyHandler.bind(this)\n    });\n\n    this._contentReadyHandler();\n\n    this._setPopupContentId(this._popup.$content());\n\n    this._bindInnerWidgetOptions(this._popup, \"dropDownOptions\");\n  },\n\n  _setPopupContentId($popupContent) {\n    this._popupContentId = \"dx-\" + new Guid();\n    this.setAria(\"id\", this._popupContentId, $popupContent);\n  },\n\n  _contentReadyHandler: noop,\n  _popupConfig: function () {\n    return {\n      onInitialized: this._popupInitializedHandler(),\n      position: extend(this.option(\"popupPosition\"), {\n        of: this.$element()\n      }),\n      showTitle: this.option(\"dropDownOptions.showTitle\"),\n      _ignoreFunctionValueDeprecation: true,\n      width: () => getElementWidth(this.$element()),\n      height: \"auto\",\n      shading: false,\n      wrapperAttr: {\n        class: DROP_DOWN_EDITOR_OVERLAY\n      },\n      hideOnParentScroll: true,\n      closeOnOutsideClick: this._closeOutsideDropDownHandler.bind(this),\n      animation: {\n        show: {\n          type: \"fade\",\n          duration: 0,\n          from: 0,\n          to: 1\n        },\n        hide: {\n          type: \"fade\",\n          duration: 400,\n          from: 1,\n          to: 0\n        }\n      },\n      deferRendering: false,\n      focusStateEnabled: false,\n      showCloseButton: false,\n      dragEnabled: false,\n      toolbarItems: this._getPopupToolbarItems(),\n      onPositioned: this._popupPositionedHandler.bind(this),\n      fullScreen: false,\n      contentTemplate: null\n    };\n  },\n  _popupInitializedHandler: function () {\n    if (!this.option(\"onPopupInitialized\")) {\n      return null;\n    }\n\n    return e => {\n      this._popupInitializedAction({\n        popup: e.component\n      });\n    };\n  },\n  _dimensionChanged: function () {\n    var popupWidth = getSizeValue(this.option(\"dropDownOptions.width\"));\n\n    if (void 0 === popupWidth) {\n      this._setPopupOption(\"width\", () => getElementWidth(this.$element()));\n    }\n  },\n  _popupPositionedHandler: function (e) {\n    e.position && this._popup.$overlayContent().toggleClass(DROP_DOWN_EDITOR_OVERLAY_FLIPPED, e.position.v.flip);\n  },\n  _popupShowingHandler: noop,\n  _popupHidingHandler: function () {\n    this.option(\"opened\", false);\n  },\n  _popupShownHandler: function () {\n    var _this$_validationMess;\n\n    this._openAction();\n\n    var $popupOverlayContent = this._popup.$overlayContent();\n\n    var position = locate($popupOverlayContent);\n\n    if (this._label.isVisible() && $popupOverlayContent.hasClass(DROP_DOWN_EDITOR_OVERLAY_FLIPPED)) {\n      var $label = this._label.$element();\n\n      move($popupOverlayContent, {\n        top: position.top - parseInt($label.css(\"fontSize\"))\n      });\n    }\n\n    null === (_this$_validationMess = this._validationMessage) || void 0 === _this$_validationMess ? void 0 : _this$_validationMess.option(\"positionRequest\", this._getValidationMessagePositionRequest());\n  },\n  _popupHiddenHandler: function () {\n    var _this$_validationMess2;\n\n    this._closeAction();\n\n    null === (_this$_validationMess2 = this._validationMessage) || void 0 === _this$_validationMess2 ? void 0 : _this$_validationMess2.option(\"positionRequest\", this._getValidationMessagePositionRequest());\n  },\n  _getValidationMessagePositionRequest: function () {\n    var positionRequest = \"below\";\n\n    if (this._popup && this._popup.option(\"visible\")) {\n      var {\n        top: myTop\n      } = animationPosition.setup(this.$element());\n      var {\n        top: popupTop\n      } = animationPosition.setup(this._popup.$content());\n      positionRequest = myTop + this.option(\"popupPosition\").offset.v > popupTop ? \"below\" : \"above\";\n    }\n\n    return positionRequest;\n  },\n  _closeOutsideDropDownHandler: function (_ref) {\n    var {\n      target: target\n    } = _ref;\n    var $target = $(target);\n    var dropDownButton = this.getButton(\"dropDown\");\n    var $dropDownButton = dropDownButton && dropDownButton.$element();\n    var isInputClicked = !!$target.closest(this.$element()).length;\n    var isDropDownButtonClicked = !!$target.closest($dropDownButton).length;\n    var isOutsideClick = !isInputClicked && !isDropDownButtonClicked;\n    return isOutsideClick;\n  },\n  _clean: function () {\n    delete this._openOnFieldClickAction;\n\n    if (this._$popup) {\n      this._$popup.remove();\n\n      delete this._$popup;\n      delete this._popup;\n    }\n\n    this.callBase();\n  },\n  _setPopupOption: function (optionName, value) {\n    this._setWidgetOption(\"_popup\", arguments);\n  },\n  _validatedOpening: function () {\n    if (!this.option(\"readOnly\")) {\n      this._toggleOpenState(true);\n    }\n  },\n  _getPopupToolbarItems: function () {\n    return \"useButtons\" === this.option(\"applyValueMode\") ? this._popupToolbarItemsConfig() : [];\n  },\n  _getFirstPopupElement: function () {\n    return this._popup.$wrapper().find(\".dx-popup-done.dx-button\");\n  },\n  _getLastPopupElement: function () {\n    return this._popup.$wrapper().find(\".dx-popup-cancel.dx-button\");\n  },\n  _popupElementTabHandler: function (e) {\n    var $element = $(e.currentTarget);\n\n    if (e.shiftKey && $element.is(this._getFirstPopupElement()) || !e.shiftKey && $element.is(this._getLastPopupElement())) {\n      eventsEngine.trigger(this._input(), \"focus\");\n      e.preventDefault();\n    }\n  },\n  _popupElementEscHandler: function () {\n    eventsEngine.trigger(this._input(), \"focus\");\n    this.close();\n  },\n  _popupButtonInitializedHandler: function (e) {\n    e.component.registerKeyHandler(\"tab\", this._popupElementTabHandler.bind(this));\n    e.component.registerKeyHandler(\"escape\", this._popupElementEscHandler.bind(this));\n  },\n  _popupToolbarItemsConfig: function () {\n    var buttonsConfig = [{\n      shortcut: \"done\",\n      options: {\n        onClick: this._applyButtonHandler.bind(this),\n        text: this.option(\"applyButtonText\"),\n        onInitialized: this._popupButtonInitializedHandler.bind(this)\n      }\n    }, {\n      shortcut: \"cancel\",\n      options: {\n        onClick: this._cancelButtonHandler.bind(this),\n        text: this.option(\"cancelButtonText\"),\n        onInitialized: this._popupButtonInitializedHandler.bind(this)\n      }\n    }];\n    return this._applyButtonsLocation(buttonsConfig);\n  },\n  _applyButtonsLocation: function (buttonsConfig) {\n    var buttonsLocation = this.option(\"buttonsLocation\");\n    var resultConfig = buttonsConfig;\n\n    if (\"default\" !== buttonsLocation) {\n      var position = splitPair(buttonsLocation);\n      each(resultConfig, function (_, element) {\n        extend(element, {\n          toolbar: position[0],\n          location: position[1]\n        });\n      });\n    }\n\n    return resultConfig;\n  },\n  _applyButtonHandler: function () {\n    this.close();\n    this.option(\"focusStateEnabled\") && this.focus();\n  },\n  _cancelButtonHandler: function () {\n    this.close();\n    this.option(\"focusStateEnabled\") && this.focus();\n  },\n  _popupOptionChanged: function (args) {\n    var options = Widget.getOptionsFromContainer(args);\n\n    this._setPopupOption(options);\n\n    var optionsKeys = Object.keys(options);\n\n    if (-1 !== optionsKeys.indexOf(\"width\") || -1 !== optionsKeys.indexOf(\"height\")) {\n      this._dimensionChanged();\n    }\n  },\n  _renderSubmitElement: function () {\n    if (this.option(\"useHiddenSubmitElement\")) {\n      this._$submitElement = $(\"<input>\").attr(\"type\", \"hidden\").appendTo(this.$element());\n    }\n  },\n  _setSubmitValue: function () {\n    this._getSubmitElement().val(this.option(\"value\"));\n  },\n  _getSubmitElement: function () {\n    if (this.option(\"useHiddenSubmitElement\")) {\n      return this._$submitElement;\n    } else {\n      return this.callBase();\n    }\n  },\n  _dispose: function () {\n    this._detachFocusOutEvents();\n\n    this.callBase();\n  },\n  _optionChanged: function (args) {\n    var _this$_popup;\n\n    switch (args.name) {\n      case \"width\":\n      case \"height\":\n        this.callBase(args);\n        null === (_this$_popup = this._popup) || void 0 === _this$_popup ? void 0 : _this$_popup.repaint();\n        break;\n\n      case \"opened\":\n        this._renderOpenedState();\n\n        break;\n\n      case \"onOpened\":\n      case \"onClosed\":\n        this._initVisibilityActions();\n\n        break;\n\n      case \"onPopupInitialized\":\n        this._initPopupInitializedAction();\n\n        break;\n\n      case \"fieldTemplate\":\n        if (isDefined(args.value)) {\n          this._renderField();\n        } else {\n          this._invalidate();\n        }\n\n        break;\n\n      case \"acceptCustomValue\":\n      case \"openOnFieldClick\":\n        this._invalidate();\n\n        break;\n\n      case \"dropDownButtonTemplate\":\n      case \"showDropDownButton\":\n        this._updateButtons([\"dropDown\"]);\n\n        break;\n\n      case \"dropDownOptions\":\n        this._popupOptionChanged(args);\n\n        this._options.cache(\"dropDownOptions\", this.option(\"dropDownOptions\"));\n\n        break;\n\n      case \"popupPosition\":\n        break;\n\n      case \"deferRendering\":\n        if (hasWindow()) {\n          this._createPopup();\n        }\n\n        break;\n\n      case \"applyValueMode\":\n      case \"applyButtonText\":\n      case \"cancelButtonText\":\n      case \"buttonsLocation\":\n        this._setPopupOption(\"toolbarItems\", this._getPopupToolbarItems());\n\n        break;\n\n      case \"useHiddenSubmitElement\":\n        if (this._$submitElement) {\n          this._$submitElement.remove();\n\n          this._$submitElement = void 0;\n        }\n\n        this._renderSubmitElement();\n\n        break;\n\n      case \"rtlEnabled\":\n        this._updatePopupPosition(args.value);\n\n        this.callBase(args);\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  open: function () {\n    this.option(\"opened\", true);\n  },\n  close: function () {\n    this.option(\"opened\", false);\n  },\n  field: function () {\n    return getPublicElement(this._input());\n  },\n  content: function () {\n    return this._popup ? this._popup.content() : null;\n  }\n});\nregisterComponent(\"dxDropDownEditor\", DropDownEditor);\nexport default DropDownEditor;","map":{"version":3,"sources":["/Users/rahulsharma/node_modules/devextreme/esm/ui/drop_down_editor/ui.drop_down_editor.js"],"names":["$","eventsEngine","Guid","registerComponent","noop","splitPair","focused","each","isDefined","extend","getPublicElement","errors","animationPosition","getDefaultAlignment","DropDownButton","Widget","messageLocalization","addNamespace","isCommandKeyPressed","TextBox","name","clickEventName","devices","FunctionTemplate","Popup","hasWindow","getElementWidth","getSizeValue","locate","move","DROP_DOWN_EDITOR_CLASS","DROP_DOWN_EDITOR_INPUT_WRAPPER","DROP_DOWN_EDITOR_BUTTON_ICON","DROP_DOWN_EDITOR_OVERLAY","DROP_DOWN_EDITOR_OVERLAY_FLIPPED","DROP_DOWN_EDITOR_ACTIVE","DROP_DOWN_EDITOR_FIELD_CLICKABLE","DROP_DOWN_EDITOR_FIELD_TEMPLATE_WRAPPER","isIOs","current","platform","DropDownEditor","inherit","_supportedKeys","callBase","tab","e","option","close","$focusableElement","shiftKey","_getLastPopupElement","_getFirstPopupElement","trigger","preventDefault","escape","upArrow","stopPropagation","altKey","downArrow","_validatedOpening","enter","_valueChangeEventHandler","_getDefaultButtons","concat","Ctor","_getDefaultOptions","value","onOpened","onClosed","opened","acceptCustomValue","applyValueMode","deferRendering","activeStateEnabled","dropDownButtonTemplate","fieldTemplate","openOnFieldClick","showDropDownButton","buttons","dropDownOptions","showTitle","popupPosition","_getDefaultPopupPosition","onPopupInitialized","applyButtonText","format","cancelButtonText","buttonsLocation","useHiddenSubmitElement","_useTemplates","isRtlEnabled","position","offset","h","v","my","at","collision","_defaultOptionsRules","device","_device","isGeneric","options","_inputWrapper","$element","find","first","_init","_initVisibilityActions","_initPopupInitializedAction","_updatePopupPosition","_options","cache","currentPosition","_openAction","_createActionByOption","excludeValidators","_closeAction","_popupInitializedAction","_initMarkup","_renderSubmitElement","addClass","setAria","_render","_renderOpenHandler","_attachFocusOutHandler","_renderOpenedState","_renderContentImpl","_createPopup","_renderInput","_wrapInput","_setDefaultAria","_$container","wrapInner","children","eq","haspopup","autocomplete","_readOnlyPropValue","_isEditable","_cleanFocusState","_detachFocusEvents","_getFieldTemplate","_getTemplateByOption","_renderMask","_renderField","_renderTemplatedField","_fieldRenderData","_renderPlaceholder","hasFieldTemplate","_renderValue","_setSubmitValue","promise","always","bind","data","isFocused","_input","$container","_detachKeyboardEvents","_refreshButtonsContainer","_detachWrapperContent","empty","$templateWrapper","appendTo","render","model","container","onRendered","$input","length","Error","_integrateInput","_attachWrapperContent","_this$_$submitElement","_this$_$beforeButtons","_this$_$afterButtonsC","_$submitElement","detach","beforeButtonsContainerParent","_$beforeButtonsContainer","parentNode","afterButtonsContainerParent","_$afterButtonsContainer","removeChild","_this$_$submitElement2","prepend","append","_$buttonsContainer","_renderFocusState","_refreshValueChangeEvent","_refreshEvents","_refreshEmptinessEvent","off","_toggleEmptinessEventHandler","_renderEmptinessEvent","_initTemplates","_templateManager","addDefaultTemplates","dropDownButton","$icon","$inputWrapper","eventName","NAME","on","_getInputClickHandler","toggleClass","_openOnFieldClickAction","_createAction","_openHandler","_detachFocusOutEvents","event","newTarget","relatedTarget","popupWrapper","content","closest","_$popup","isNewTargetOutside","_executeOpenAction","_focusInput","_toggleOpenState","_keyboardEventBindingTarget","_resetCaretPosition","ignoreEditable","arguments","inputElement","get","caretPosition","_caret","start","end","isVisible","_setPopupOption","expanded","_popupContentId","_renderPopup","_renderPopupContent","popupConfig","_popupConfig","_popup","_createComponent","showing","_popupShowingHandler","shown","_popupShownHandler","hiding","_popupHidingHandler","hidden","_popupHiddenHandler","contentReady","_contentReadyHandler","_setPopupContentId","$content","_bindInnerWidgetOptions","$popupContent","onInitialized","_popupInitializedHandler","of","_ignoreFunctionValueDeprecation","width","height","shading","wrapperAttr","class","hideOnParentScroll","closeOnOutsideClick","_closeOutsideDropDownHandler","animation","show","type","duration","from","to","hide","focusStateEnabled","showCloseButton","dragEnabled","toolbarItems","_getPopupToolbarItems","onPositioned","_popupPositionedHandler","fullScreen","contentTemplate","popup","component","_dimensionChanged","popupWidth","$overlayContent","flip","_this$_validationMess","$popupOverlayContent","_label","hasClass","$label","top","parseInt","css","_validationMessage","_getValidationMessagePositionRequest","_this$_validationMess2","positionRequest","myTop","setup","popupTop","_ref","target","$target","getButton","$dropDownButton","isInputClicked","isDropDownButtonClicked","isOutsideClick","_clean","remove","optionName","_setWidgetOption","_popupToolbarItemsConfig","$wrapper","_popupElementTabHandler","currentTarget","is","_popupElementEscHandler","_popupButtonInitializedHandler","registerKeyHandler","buttonsConfig","shortcut","onClick","_applyButtonHandler","text","_cancelButtonHandler","_applyButtonsLocation","resultConfig","_","element","toolbar","location","focus","_popupOptionChanged","args","getOptionsFromContainer","optionsKeys","Object","keys","indexOf","attr","_getSubmitElement","val","_dispose","_optionChanged","_this$_popup","repaint","_invalidate","_updateButtons","open","field"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,CAAP,MAAc,qBAAd;AACA,OAAOC,YAAP,MAAyB,iCAAzB;AACA,OAAOC,IAAP,MAAiB,iBAAjB;AACA,OAAOC,iBAAP,MAA8B,kCAA9B;AACA,SACIC,IADJ,EAEIC,SAFJ,QAGO,yBAHP;AAIA,SACIC,OADJ,QAEO,qBAFP;AAGA,SACIC,IADJ,QAEO,2BAFP;AAGA,SACIC,SADJ,QAEO,uBAFP;AAGA,SACIC,MADJ,QAEO,yBAFP;AAGA,SACIC,gBADJ,QAEO,oBAFP;AAGA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,iBAAP,MAA8B,0BAA9B;AACA,SACIC,mBADJ,QAEO,2BAFP;AAGA,OAAOC,cAAP,MAA2B,uBAA3B;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,mBAAP,MAAgC,4BAAhC;AACA,SACIC,YADJ,EAEIC,mBAFJ,QAGO,0BAHP;AAIA,OAAOC,OAAP,MAAoB,aAApB;AACA,SACIC,IAAI,IAAIC,cADZ,QAEO,oBAFP;AAGA,OAAOC,OAAP,MAAoB,oBAApB;AACA,SACIC,gBADJ,QAEO,wCAFP;AAGA,OAAOC,KAAP,MAAkB,UAAlB;AACA,SACIC,SADJ,QAEO,yBAFP;AAGA,SACIC,eADJ,EAEIC,YAFJ,QAGO,SAHP;AAIA,SACIC,MADJ,EAEIC,IAFJ,QAGO,4BAHP;AAIA,IAAIC,sBAAsB,GAAG,mBAA7B;AACA,IAAIC,8BAA8B,GAAG,iCAArC;AACA,IAAIC,4BAA4B,GAAG,wBAAnC;AACA,IAAIC,wBAAwB,GAAG,2BAA/B;AACA,IAAIC,gCAAgC,GAAG,mCAAvC;AACA,IAAIC,uBAAuB,GAAG,0BAA9B;AACA,IAAIC,gCAAgC,GAAG,mCAAvC;AACA,IAAIC,uCAAuC,GAAG,0CAA9C;AACA,IAAIC,KAAK,GAAG,UAAUhB,OAAO,CAACiB,OAAR,GAAkBC,QAAxC;AACA,IAAIC,cAAc,GAAGtB,OAAO,CAACuB,OAAR,CAAgB;AACjCC,EAAAA,cAAc,EAAE,YAAW;AACvB,WAAOlC,MAAM,CAAC,EAAD,EAAK,KAAKmC,QAAL,EAAL,EAAsB;AAC/BC,MAAAA,GAAG,EAAE,UAASC,CAAT,EAAY;AACb,YAAI,CAAC,KAAKC,MAAL,CAAY,QAAZ,CAAL,EAA4B;AACxB;AACH;;AACD,YAAI,gBAAgB,KAAKA,MAAL,CAAY,gBAAZ,CAApB,EAAmD;AAC/C,eAAKC,KAAL;AACA;AACH;;AACD,YAAIC,iBAAiB,GAAGH,CAAC,CAACI,QAAF,GAAa,KAAKC,oBAAL,EAAb,GAA2C,KAAKC,qBAAL,EAAnE;AACAH,QAAAA,iBAAiB,IAAIhD,YAAY,CAACoD,OAAb,CAAqBJ,iBAArB,EAAwC,OAAxC,CAArB;AACAH,QAAAA,CAAC,CAACQ,cAAF;AACH,OAZ8B;AAa/BC,MAAAA,MAAM,EAAE,UAAST,CAAT,EAAY;AAChB,YAAI,KAAKC,MAAL,CAAY,QAAZ,CAAJ,EAA2B;AACvBD,UAAAA,CAAC,CAACQ,cAAF;AACH;;AACD,aAAKN,KAAL;AACA,eAAO,IAAP;AACH,OAnB8B;AAoB/BQ,MAAAA,OAAO,EAAE,UAASV,CAAT,EAAY;AACjB,YAAI,CAAC5B,mBAAmB,CAAC4B,CAAD,CAAxB,EAA6B;AACzBA,UAAAA,CAAC,CAACQ,cAAF;AACAR,UAAAA,CAAC,CAACW,eAAF;;AACA,cAAIX,CAAC,CAACY,MAAN,EAAc;AACV,iBAAKV,KAAL;AACA,mBAAO,KAAP;AACH;AACJ;;AACD,eAAO,IAAP;AACH,OA9B8B;AA+B/BW,MAAAA,SAAS,EAAE,UAASb,CAAT,EAAY;AACnB,YAAI,CAAC5B,mBAAmB,CAAC4B,CAAD,CAAxB,EAA6B;AACzBA,UAAAA,CAAC,CAACQ,cAAF;AACAR,UAAAA,CAAC,CAACW,eAAF;;AACA,cAAIX,CAAC,CAACY,MAAN,EAAc;AACV,iBAAKE,iBAAL;;AACA,mBAAO,KAAP;AACH;AACJ;;AACD,eAAO,IAAP;AACH,OAzC8B;AA0C/BC,MAAAA,KAAK,EAAE,UAASf,CAAT,EAAY;AACf,YAAI,KAAKC,MAAL,CAAY,QAAZ,CAAJ,EAA2B;AACvBD,UAAAA,CAAC,CAACQ,cAAF;;AACA,eAAKQ,wBAAL,CAA8BhB,CAA9B;AACH;;AACD,eAAO,IAAP;AACH;AAhD8B,KAAtB,CAAb;AAkDH,GApDgC;AAqDjCiB,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,WAAO,KAAKnB,QAAL,GAAgBoB,MAAhB,CAAuB,CAAC;AAC3B5C,MAAAA,IAAI,EAAE,UADqB;AAE3B6C,MAAAA,IAAI,EAAEnD;AAFqB,KAAD,CAAvB,CAAP;AAIH,GA1DgC;AA2DjCoD,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,WAAOzD,MAAM,CAAC,KAAKmC,QAAL,EAAD,EAAkB;AAC3BuB,MAAAA,KAAK,EAAE,IADoB;AAE3BC,MAAAA,QAAQ,EAAE,IAFiB;AAG3BC,MAAAA,QAAQ,EAAE,IAHiB;AAI3BC,MAAAA,MAAM,EAAE,KAJmB;AAK3BC,MAAAA,iBAAiB,EAAE,IALQ;AAM3BC,MAAAA,cAAc,EAAE,WANW;AAO3BC,MAAAA,cAAc,EAAE,IAPW;AAQ3BC,MAAAA,kBAAkB,EAAE,IARO;AAS3BC,MAAAA,sBAAsB,EAAE,gBATG;AAU3BC,MAAAA,aAAa,EAAE,IAVY;AAW3BC,MAAAA,gBAAgB,EAAE,KAXS;AAY3BC,MAAAA,kBAAkB,EAAE,IAZO;AAa3BC,MAAAA,OAAO,EAAE,KAAK,CAba;AAc3BC,MAAAA,eAAe,EAAE;AACbC,QAAAA,SAAS,EAAE;AADE,OAdU;AAiB3BC,MAAAA,aAAa,EAAE,KAAKC,wBAAL,EAjBY;AAkB3BC,MAAAA,kBAAkB,EAAE,IAlBO;AAmB3BC,MAAAA,eAAe,EAAErE,mBAAmB,CAACsE,MAApB,CAA2B,IAA3B,CAnBU;AAoB3BC,MAAAA,gBAAgB,EAAEvE,mBAAmB,CAACsE,MAApB,CAA2B,QAA3B,CApBS;AAqB3BE,MAAAA,eAAe,EAAE,SArBU;AAsB3BC,MAAAA,sBAAsB,EAAE;AAtBG,KAAlB,CAAb;AAwBH,GApFgC;AAqFjCC,EAAAA,aAAa,EAAE,YAAW;AACtB,WAAO,IAAP;AACH,GAvFgC;AAwFjCP,EAAAA,wBAAwB,EAAE,UAASQ,YAAT,EAAuB;AAC7C,QAAIC,QAAQ,GAAG/E,mBAAmB,CAAC8E,YAAD,CAAlC;AACA,WAAO;AACHE,MAAAA,MAAM,EAAE;AACJC,QAAAA,CAAC,EAAE,CADC;AAEJC,QAAAA,CAAC,EAAE,CAAC;AAFA,OADL;AAKHC,MAAAA,EAAE,EAAEJ,QAAQ,GAAG,MALZ;AAMHK,MAAAA,EAAE,EAAEL,QAAQ,GAAG,SANZ;AAOHM,MAAAA,SAAS,EAAE;AAPR,KAAP;AASH,GAnGgC;AAoGjCC,EAAAA,oBAAoB,EAAE,YAAW;AAC7B,WAAO,KAAKvD,QAAL,GAAgBoB,MAAhB,CAAuB,CAAC;AAC3BoC,MAAAA,MAAM,EAAE,UAASC,OAAT,EAAkB;AACtB,YAAIC,SAAS,GAAG,cAAcD,OAAO,CAAC7D,QAAtC;AACA,eAAO8D,SAAP;AACH,OAJ0B;AAK3BC,MAAAA,OAAO,EAAE;AACLrB,QAAAA,aAAa,EAAE;AACXW,UAAAA,MAAM,EAAE;AACJE,YAAAA,CAAC,EAAE;AADC;AADG;AADV;AALkB,KAAD,CAAvB,CAAP;AAaH,GAlHgC;AAmHjCS,EAAAA,aAAa,EAAE,YAAW;AACtB,WAAO,KAAKC,QAAL,GAAgBC,IAAhB,CAAqB,MAAM3E,8BAA3B,EAA2D4E,KAA3D,EAAP;AACH,GArHgC;AAsHjCC,EAAAA,KAAK,EAAE,YAAW;AACd,SAAKhE,QAAL;;AACA,SAAKiE,sBAAL;;AACA,SAAKC,2BAAL;;AACA,SAAKC,oBAAL,CAA0B,KAAKhE,MAAL,CAAY,YAAZ,CAA1B;;AACA,SAAKiE,QAAL,CAAcC,KAAd,CAAoB,iBAApB,EAAuC,KAAKlE,MAAL,CAAY,iBAAZ,CAAvC;AACH,GA5HgC;AA6HjCgE,EAAAA,oBAAoB,EAAE,UAASpB,YAAT,EAAuB;AACzC,QAAI;AACAK,MAAAA,EAAE,EAAEA,EADJ;AAEAC,MAAAA,EAAE,EAAEA;AAFJ,QAGA,KAAKd,wBAAL,CAA8BQ,YAA9B,CAHJ;;AAIA,QAAIuB,eAAe,GAAG,KAAKnE,MAAL,CAAY,eAAZ,CAAtB;AACA,SAAKA,MAAL,CAAY,eAAZ,EAA6BtC,MAAM,CAAC,EAAD,EAAKyG,eAAL,EAAsB;AACrDlB,MAAAA,EAAE,EAAEA,EADiD;AAErDC,MAAAA,EAAE,EAAEA;AAFiD,KAAtB,CAAnC;AAIH,GAvIgC;AAwIjCY,EAAAA,sBAAsB,EAAE,YAAW;AAC/B,SAAKM,WAAL,GAAmB,KAAKC,qBAAL,CAA2B,UAA3B,EAAuC;AACtDC,MAAAA,iBAAiB,EAAE,CAAC,UAAD,EAAa,UAAb;AADmC,KAAvC,CAAnB;AAGA,SAAKC,YAAL,GAAoB,KAAKF,qBAAL,CAA2B,UAA3B,EAAuC;AACvDC,MAAAA,iBAAiB,EAAE,CAAC,UAAD,EAAa,UAAb;AADoC,KAAvC,CAApB;AAGH,GA/IgC;AAgJjCP,EAAAA,2BAA2B,EAAE,YAAW;AACpC,SAAKS,uBAAL,GAA+B,KAAKH,qBAAL,CAA2B,oBAA3B,EAAiD;AAC5EC,MAAAA,iBAAiB,EAAE,CAAC,UAAD,EAAa,UAAb;AADyD,KAAjD,CAA/B;AAGH,GApJgC;AAqJjCG,EAAAA,WAAW,EAAE,YAAW;AACpB,SAAKC,oBAAL;;AACA,SAAK7E,QAAL;AACA,SAAK6D,QAAL,GAAgBiB,QAAhB,CAAyB5F,sBAAzB;AACA,SAAK6F,OAAL,CAAa,MAAb,EAAqB,UAArB;AACH,GA1JgC;AA2JjCC,EAAAA,OAAO,EAAE,YAAW;AAChB,SAAKhF,QAAL;;AACA,SAAKiF,kBAAL;;AACA,SAAKC,sBAAL;;AACA,SAAKC,kBAAL;AACH,GAhKgC;AAiKjCC,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,QAAI,CAAC,KAAKjF,MAAL,CAAY,gBAAZ,CAAL,EAAoC;AAChC,WAAKkF,YAAL;AACH;AACJ,GArKgC;AAsKjCC,EAAAA,YAAY,EAAE,YAAW;AACrB,SAAKtF,QAAL;;AACA,SAAKuF,UAAL;;AACA,SAAKC,eAAL;AACH,GA1KgC;AA2KjCD,EAAAA,UAAU,EAAE,YAAW;AACnB,SAAKE,WAAL,GAAmB,KAAK5B,QAAL,GAAgB6B,SAAhB,CAA0BtI,CAAC,CAAC,OAAD,CAAD,CAAW0H,QAAX,CAAoB3F,8BAApB,CAA1B,EAA+EwG,QAA/E,GAA0FC,EAA1F,CAA6F,CAA7F,CAAnB;AACH,GA7KgC;AA8KjCJ,EAAAA,eAAe,EAAE,YAAW;AACxB,SAAKT,OAAL,CAAa;AACTc,MAAAA,QAAQ,EAAE,MADD;AAETC,MAAAA,YAAY,EAAE;AAFL,KAAb;AAIH,GAnLgC;AAoLjCC,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,WAAO,CAAC,KAAKC,WAAL,EAAD,IAAuB,KAAKhG,QAAL,EAA9B;AACH,GAtLgC;AAuLjCiG,EAAAA,gBAAgB,EAAE,YAAW;AACzB,SAAKjG,QAAL;;AACA,QAAI,KAAKG,MAAL,CAAY,eAAZ,CAAJ,EAAkC;AAC9B,WAAK+F,kBAAL;AACH;AACJ,GA5LgC;AA6LjCC,EAAAA,iBAAiB,EAAE,YAAW;AAC1B,WAAO,KAAKhG,MAAL,CAAY,eAAZ,KAAgC,KAAKiG,oBAAL,CAA0B,eAA1B,CAAvC;AACH,GA/LgC;AAgMjCC,EAAAA,WAAW,EAAE,YAAW;AACpB,QAAI,KAAKlG,MAAL,CAAY,eAAZ,CAAJ,EAAkC;AAC9B;AACH;;AACD,SAAKH,QAAL;AACH,GArMgC;AAsMjCsG,EAAAA,YAAY,EAAE,YAAW;AACrB,QAAItE,aAAa,GAAG,KAAKmE,iBAAL,EAApB;;AACAnE,IAAAA,aAAa,IAAI,KAAKuE,qBAAL,CAA2BvE,aAA3B,EAA0C,KAAKwE,gBAAL,EAA1C,CAAjB;AACH,GAzMgC;AA0MjCC,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,QAAIC,gBAAgB,GAAG,CAAC,CAAC,KAAKP,iBAAL,EAAzB;;AACA,QAAI,CAACO,gBAAL,EAAuB;AACnB,WAAK1G,QAAL;AACH;AACJ,GA/MgC;AAgNjC2G,EAAAA,YAAY,EAAE,YAAW;AACrB,QAAI,KAAKxG,MAAL,CAAY,wBAAZ,CAAJ,EAA2C;AACvC,WAAKyG,eAAL;AACH;;AACD,QAAIC,OAAO,GAAG,KAAK7G,QAAL,EAAd;AACA6G,IAAAA,OAAO,CAACC,MAAR,CAAe,KAAKR,YAAL,CAAkBS,IAAlB,CAAuB,IAAvB,CAAf;AACH,GAtNgC;AAuNjCR,EAAAA,qBAAqB,EAAE,UAASvE,aAAT,EAAwBgF,IAAxB,EAA8B;AACjD,QAAIC,SAAS,GAAGvJ,OAAO,CAAC,KAAKwJ,MAAL,EAAD,CAAvB;AACA,QAAIC,UAAU,GAAG,KAAK1B,WAAtB;;AACA,SAAK2B,qBAAL;;AACA,SAAKC,wBAAL;;AACA,SAAKC,qBAAL;;AACA,SAAKpB,kBAAL;;AACAiB,IAAAA,UAAU,CAACI,KAAX;AACA,QAAIC,gBAAgB,GAAGpK,CAAC,CAAC,OAAD,CAAD,CAAW0H,QAAX,CAAoBrF,uCAApB,EAA6DgI,QAA7D,CAAsEN,UAAtE,CAAvB;AACAnF,IAAAA,aAAa,CAAC0F,MAAd,CAAqB;AACjBC,MAAAA,KAAK,EAAEX,IADU;AAEjBY,MAAAA,SAAS,EAAE9J,gBAAgB,CAAC0J,gBAAD,CAFV;AAGjBK,MAAAA,UAAU,EAAE,MAAM;AACd,YAAIC,MAAM,GAAG,KAAKZ,MAAL,EAAb;;AACA,YAAI,CAACY,MAAM,CAACC,MAAZ,EAAoB;AAChB,gBAAMhK,MAAM,CAACiK,KAAP,CAAa,OAAb,CAAN;AACH;;AACD,aAAKC,eAAL;;AACAhB,QAAAA,SAAS,IAAI5J,YAAY,CAACoD,OAAb,CAAqBqH,MAArB,EAA6B,OAA7B,CAAb;AACH;AAVgB,KAArB;;AAYA,SAAKI,qBAAL,CAA2Bf,UAA3B;AACH,GA7OgC;;AA8OjCG,EAAAA,qBAAqB,GAAG;AACpB,QAAIa,qBAAJ,EAA2BC,qBAA3B,EAAkDC,qBAAlD;;AACA,QAAIxF,sBAAsB,GAAG,KAAK1C,MAAL,CAAY,wBAAZ,CAA7B;AACA0C,IAAAA,sBAAsB,KAAK,UAAUsF,qBAAqB,GAAG,KAAKG,eAAvC,KAA2D,KAAK,CAAL,KAAWH,qBAAtE,GAA8F,KAAK,CAAnG,GAAuGA,qBAAqB,CAACI,MAAtB,EAA5G,CAAtB;AACA,QAAIC,4BAA4B,GAAG,UAAUJ,qBAAqB,GAAG,KAAKK,wBAAvC,KAAoE,KAAK,CAAL,KAAWL,qBAA/E,GAAuG,KAAK,CAA5G,GAAgHA,qBAAqB,CAAC,CAAD,CAArB,CAAyBM,UAA5K;AACA,QAAIC,2BAA2B,GAAG,UAAUN,qBAAqB,GAAG,KAAKO,uBAAvC,KAAmE,KAAK,CAAL,KAAWP,qBAA9E,GAAsG,KAAK,CAA3G,GAA+GA,qBAAqB,CAAC,CAAD,CAArB,CAAyBK,UAA1K;AACA,aAASF,4BAAT,IAAyC,KAAK,CAAL,KAAWA,4BAApD,GAAmF,KAAK,CAAxF,GAA4FA,4BAA4B,CAACK,WAA7B,CAAyC,KAAKJ,wBAAL,CAA8B,CAA9B,CAAzC,CAA5F;AACA,aAASE,2BAAT,IAAwC,KAAK,CAAL,KAAWA,2BAAnD,GAAiF,KAAK,CAAtF,GAA0FA,2BAA2B,CAACE,WAA5B,CAAwC,KAAKD,uBAAL,CAA6B,CAA7B,CAAxC,CAA1F;AACH,GAtPgC;;AAuPjCV,EAAAA,qBAAqB,CAACf,UAAD,EAAa;AAC9B,QAAI2B,sBAAJ;;AACA,QAAIjG,sBAAsB,GAAG,KAAK1C,MAAL,CAAY,wBAAZ,CAA7B;AACAgH,IAAAA,UAAU,CAAC4B,OAAX,CAAmB,KAAKN,wBAAxB;AACA5F,IAAAA,sBAAsB,KAAK,UAAUiG,sBAAsB,GAAG,KAAKR,eAAxC,KAA4D,KAAK,CAAL,KAAWQ,sBAAvE,GAAgG,KAAK,CAArG,GAAyGA,sBAAsB,CAACrB,QAAvB,CAAgCN,UAAhC,CAA9G,CAAtB;AACAA,IAAAA,UAAU,CAAC6B,MAAX,CAAkB,KAAKJ,uBAAvB;AACH,GA7PgC;;AA8PjCvB,EAAAA,wBAAwB,GAAG;AACvB,SAAK4B,kBAAL,GAA0B,KAAKpF,QAAL,GAAgB8B,QAAhB,GAA2BC,EAA3B,CAA8B,CAA9B,CAA1B;AACH,GAhQgC;;AAiQjCqC,EAAAA,eAAe,EAAE,YAAW;AACxB,SAAKiB,iBAAL;;AACA,SAAKC,wBAAL;;AACA,SAAKC,cAAL;;AACA,SAAKC,sBAAL;AACH,GAtQgC;AAuQjCA,EAAAA,sBAAsB,EAAE,YAAW;AAC/BhM,IAAAA,YAAY,CAACiM,GAAb,CAAiB,KAAKpC,MAAL,EAAjB,EAAgC,YAAhC,EAA8C,KAAKqC,4BAAnD;;AACA,SAAKC,qBAAL;AACH,GA1QgC;AA2QjChD,EAAAA,gBAAgB,EAAE,YAAW;AACzB,WAAO,KAAKrG,MAAL,CAAY,OAAZ,CAAP;AACH,GA7QgC;AA8QjCsJ,EAAAA,cAAc,EAAE,YAAW;AACvB,SAAKC,gBAAL,CAAsBC,mBAAtB,CAA0C;AACtCC,MAAAA,cAAc,EAAE,IAAIjL,gBAAJ,CAAsB,UAASgF,OAAT,EAAkB;AACpD,YAAIkG,KAAK,GAAGzM,CAAC,CAAC,OAAD,CAAD,CAAW0H,QAAX,CAAoB1F,4BAApB,CAAZ;AACAhC,QAAAA,CAAC,CAACuG,OAAO,CAACiE,SAAT,CAAD,CAAqBoB,MAArB,CAA4Ba,KAA5B;AACH,OAHe;AADsB,KAA1C;;AAMA,SAAK7J,QAAL;AACH,GAtRgC;AAuRjCiF,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,QAAI6E,aAAa,GAAG,KAAKlG,aAAL,EAApB;;AACA,QAAImG,SAAS,GAAG1L,YAAY,CAACI,cAAD,EAAiB,KAAKuL,IAAtB,CAA5B;AACA,QAAI/H,gBAAgB,GAAG,KAAK9B,MAAL,CAAY,kBAAZ,CAAvB;AACA9C,IAAAA,YAAY,CAACiM,GAAb,CAAiBQ,aAAjB,EAAgCC,SAAhC;AACA1M,IAAAA,YAAY,CAAC4M,EAAb,CAAgBH,aAAhB,EAA+BC,SAA/B,EAA0C,KAAKG,qBAAL,CAA2BjI,gBAA3B,CAA1C;AACA,SAAK4B,QAAL,GAAgBsG,WAAhB,CAA4B3K,gCAA5B,EAA8DyC,gBAA9D;;AACA,QAAIA,gBAAJ,EAAsB;AAClB,WAAKmI,uBAAL,GAA+B,KAAKC,aAAL,CAAmB,KAAKC,YAAL,CAAkBvD,IAAlB,CAAuB,IAAvB,CAAnB,CAA/B;AACH;AACJ,GAjSgC;AAkSjC7B,EAAAA,sBAAsB,EAAE,YAAW;AAC/B,QAAIxF,KAAJ,EAAW;AACP,WAAK6K,qBAAL;;AACAlN,MAAAA,YAAY,CAAC4M,EAAb,CAAgB,KAAKrG,aAAL,EAAhB,EAAsCvF,YAAY,CAAC,UAAD,EAAa,KAAK2L,IAAlB,CAAlD,EAA2EQ,KAAK,IAAI;AAChF,YAAIC,SAAS,GAAGD,KAAK,CAACE,aAAtB;AACA,YAAIC,YAAY,GAAG,KAAKC,OAAL,GAAexN,CAAC,CAAC,KAAKwN,OAAL,EAAD,CAAD,CAAkBC,OAAlB,CAA0B,MAAMxL,wBAAhC,CAAf,GAA2E,KAAKyL,OAAnG;;AACA,YAAIL,SAAS,IAAI,KAAKtK,MAAL,CAAY,QAAZ,CAAjB,EAAwC;AACpC,cAAI4K,kBAAkB,GAAG,MAAM3N,CAAC,CAACqN,SAAD,CAAD,CAAaI,OAAb,CAAqB,MAAMxL,wBAA3B,EAAqDsL,YAArD,EAAmE5C,MAAlG;;AACA,cAAIgD,kBAAJ,EAAwB;AACpB,iBAAK3K,KAAL;AACH;AACJ;AACJ,OATD;AAUH;AACJ,GAhTgC;AAiTjCmK,EAAAA,qBAAqB,EAAE,YAAW;AAC9B7K,IAAAA,KAAK,IAAIrC,YAAY,CAACiM,GAAb,CAAiB,KAAK1F,aAAL,EAAjB,EAAuCvF,YAAY,CAAC,UAAD,EAAa,KAAK2L,IAAlB,CAAnD,CAAT;AACH,GAnTgC;AAoTjCE,EAAAA,qBAAqB,EAAE,UAASjI,gBAAT,EAA2B;AAC9C,WAAOA,gBAAgB,GAAG/B,CAAC,IAAI;AAC3B,WAAK8K,kBAAL,CAAwB9K,CAAxB;AACH,KAFsB,GAEnBA,CAAC,IAAI;AACL,WAAK+K,WAAL;AACH,KAJD;AAKH,GA1TgC;AA2TjCX,EAAAA,YAAY,EAAE,YAAW;AACrB,SAAKY,gBAAL;AACH,GA7TgC;AA8TjCF,EAAAA,kBAAkB,EAAE,UAAS9K,CAAT,EAAY;AAC5B,SAAKkK,uBAAL,CAA6B;AACzBI,MAAAA,KAAK,EAAEtK;AADkB,KAA7B;AAGH,GAlUgC;AAmUjCiL,EAAAA,2BAA2B,EAAE,YAAW;AACpC,WAAO,KAAKjE,MAAL,EAAP;AACH,GArUgC;AAsUjC+D,EAAAA,WAAW,EAAE,YAAW;AACpB,QAAI,KAAK9K,MAAL,CAAY,UAAZ,CAAJ,EAA6B;AACzB,aAAO,KAAP;AACH;;AACD,QAAI,KAAKA,MAAL,CAAY,mBAAZ,KAAoC,CAACzC,OAAO,CAAC,KAAKwJ,MAAL,EAAD,CAAhD,EAAiE;AAC7D,WAAKkE,mBAAL;;AACA/N,MAAAA,YAAY,CAACoD,OAAb,CAAqB,KAAKyG,MAAL,EAArB,EAAoC,OAApC;AACH;;AACD,WAAO,IAAP;AACH,GA/UgC;AAgVjCkE,EAAAA,mBAAmB,EAAE,YAAW;AAC5B,QAAIC,cAAc,GAAGC,SAAS,CAACvD,MAAV,GAAmB,CAAnB,IAAwB,KAAK,CAAL,KAAWuD,SAAS,CAAC,CAAD,CAA5C,GAAkDA,SAAS,CAAC,CAAD,CAA3D,GAAiE,KAAtF;;AACA,QAAIC,YAAY,GAAG,KAAKrE,MAAL,GAAcsE,GAAd,CAAkB,CAAlB,CAAnB;;AACA,QAAID,YAAJ,EAAkB;AACd,UAAI;AACAhK,QAAAA,KAAK,EAAEA;AADP,UAEAgK,YAFJ;AAGA,UAAIE,aAAa,GAAG7N,SAAS,CAAC2D,KAAD,CAAT,KAAqB8J,cAAc,IAAI,KAAKrF,WAAL,EAAvC,IAA6DzE,KAAK,CAACwG,MAAnE,GAA4E,CAAhG;;AACA,WAAK2D,MAAL,CAAY;AACRC,QAAAA,KAAK,EAAEF,aADC;AAERG,QAAAA,GAAG,EAAEH;AAFG,OAAZ,EAGG,IAHH;AAIH;AACJ,GA7VgC;AA8VjCzF,EAAAA,WAAW,EAAE,YAAW;AACpB,WAAO,KAAK7F,MAAL,CAAY,mBAAZ,CAAP;AACH,GAhWgC;AAiWjC+K,EAAAA,gBAAgB,EAAE,UAASW,SAAT,EAAoB;AAClC,QAAI,CAAC,KAAKZ,WAAL,EAAL,EAAyB;AACrB;AACH;;AACD,QAAI,CAAC,KAAK9K,MAAL,CAAY,UAAZ,CAAL,EAA8B;AAC1B0L,MAAAA,SAAS,GAAGP,SAAS,CAACvD,MAAV,GAAmB8D,SAAnB,GAA+B,CAAC,KAAK1L,MAAL,CAAY,QAAZ,CAA5C;AACA,WAAKA,MAAL,CAAY,QAAZ,EAAsB0L,SAAtB;AACH;AACJ,GAzWgC;AA0WjC1G,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,QAAIzD,MAAM,GAAG,KAAKvB,MAAL,CAAY,QAAZ,CAAb;;AACA,QAAIuB,MAAJ,EAAY;AACR,WAAK2D,YAAL;AACH;;AACD,SAAKxB,QAAL,GAAgBsG,WAAhB,CAA4B5K,uBAA5B,EAAqDmC,MAArD;;AACA,SAAKoK,eAAL,CAAqB,SAArB,EAAgCpK,MAAhC;;AACA,SAAKqD,OAAL,CAAa;AACTgH,MAAAA,QAAQ,EAAErK;AADD,KAAb;AAGA,SAAKqD,OAAL,CAAa,MAAb,EAAqBrD,MAAM,GAAG,KAAKsK,eAAR,GAA0B,KAAK,CAA1D,EAA6D,KAAKnI,QAAL,EAA7D;AACH,GArXgC;AAsXjCwB,EAAAA,YAAY,EAAE,YAAW;AACrB,QAAI,KAAKyF,OAAT,EAAkB;AACd;AACH;;AACD,SAAKA,OAAL,GAAe1N,CAAC,CAAC,OAAD,CAAD,CAAW0H,QAAX,CAAoBzF,wBAApB,EAA8CoI,QAA9C,CAAuD,KAAK5D,QAAL,EAAvD,CAAf;;AACA,SAAKoI,YAAL;;AACA,SAAKC,mBAAL;AACH,GA7XgC;AA8XjCA,EAAAA,mBAAmB,EAAE1O,IA9XY;AA+XjCyO,EAAAA,YAAY,EAAE,YAAW;AACrB,QAAIE,WAAW,GAAGtO,MAAM,CAAC,KAAKuO,YAAL,EAAD,EAAsB,KAAKhI,QAAL,CAAcC,KAAd,CAAoB,iBAApB,CAAtB,CAAxB;AACA,SAAKgI,MAAL,GAAc,KAAKC,gBAAL,CAAsB,KAAKxB,OAA3B,EAAoClM,KAApC,EAA2CuN,WAA3C,CAAd;;AACA,SAAKE,MAAL,CAAYpC,EAAZ,CAAe;AACXsC,MAAAA,OAAO,EAAE,KAAKC,oBAAL,CAA0BzF,IAA1B,CAA+B,IAA/B,CADE;AAEX0F,MAAAA,KAAK,EAAE,KAAKC,kBAAL,CAAwB3F,IAAxB,CAA6B,IAA7B,CAFI;AAGX4F,MAAAA,MAAM,EAAE,KAAKC,mBAAL,CAAyB7F,IAAzB,CAA8B,IAA9B,CAHG;AAIX8F,MAAAA,MAAM,EAAE,KAAKC,mBAAL,CAAyB/F,IAAzB,CAA8B,IAA9B,CAJG;AAKXgG,MAAAA,YAAY,EAAE,KAAKC,oBAAL,CAA0BjG,IAA1B,CAA+B,IAA/B;AALH,KAAf;;AAOA,SAAKiG,oBAAL;;AACA,SAAKC,kBAAL,CAAwB,KAAKZ,MAAL,CAAYa,QAAZ,EAAxB;;AACA,SAAKC,uBAAL,CAA6B,KAAKd,MAAlC,EAA0C,iBAA1C;AACH,GA5YgC;;AA6YjCY,EAAAA,kBAAkB,CAACG,aAAD,EAAgB;AAC9B,SAAKpB,eAAL,GAAuB,QAAQ,IAAI1O,IAAJ,EAA/B;AACA,SAAKyH,OAAL,CAAa,IAAb,EAAmB,KAAKiH,eAAxB,EAAyCoB,aAAzC;AACH,GAhZgC;;AAiZjCJ,EAAAA,oBAAoB,EAAExP,IAjZW;AAkZjC4O,EAAAA,YAAY,EAAE,YAAW;AACrB,WAAO;AACHiB,MAAAA,aAAa,EAAE,KAAKC,wBAAL,EADZ;AAEHtK,MAAAA,QAAQ,EAAEnF,MAAM,CAAC,KAAKsC,MAAL,CAAY,eAAZ,CAAD,EAA+B;AAC3CoN,QAAAA,EAAE,EAAE,KAAK1J,QAAL;AADuC,OAA/B,CAFb;AAKHxB,MAAAA,SAAS,EAAE,KAAKlC,MAAL,CAAY,2BAAZ,CALR;AAMHqN,MAAAA,+BAA+B,EAAE,IAN9B;AAOHC,MAAAA,KAAK,EAAE,MAAM3O,eAAe,CAAC,KAAK+E,QAAL,EAAD,CAPzB;AAQH6J,MAAAA,MAAM,EAAE,MARL;AASHC,MAAAA,OAAO,EAAE,KATN;AAUHC,MAAAA,WAAW,EAAE;AACTC,QAAAA,KAAK,EAAExO;AADE,OAVV;AAaHyO,MAAAA,kBAAkB,EAAE,IAbjB;AAcHC,MAAAA,mBAAmB,EAAE,KAAKC,4BAAL,CAAkCjH,IAAlC,CAAuC,IAAvC,CAdlB;AAeHkH,MAAAA,SAAS,EAAE;AACPC,QAAAA,IAAI,EAAE;AACFC,UAAAA,IAAI,EAAE,MADJ;AAEFC,UAAAA,QAAQ,EAAE,CAFR;AAGFC,UAAAA,IAAI,EAAE,CAHJ;AAIFC,UAAAA,EAAE,EAAE;AAJF,SADC;AAOPC,QAAAA,IAAI,EAAE;AACFJ,UAAAA,IAAI,EAAE,MADJ;AAEFC,UAAAA,QAAQ,EAAE,GAFR;AAGFC,UAAAA,IAAI,EAAE,CAHJ;AAIFC,UAAAA,EAAE,EAAE;AAJF;AAPC,OAfR;AA6BHzM,MAAAA,cAAc,EAAE,KA7Bb;AA8BH2M,MAAAA,iBAAiB,EAAE,KA9BhB;AA+BHC,MAAAA,eAAe,EAAE,KA/Bd;AAgCHC,MAAAA,WAAW,EAAE,KAhCV;AAiCHC,MAAAA,YAAY,EAAE,KAAKC,qBAAL,EAjCX;AAkCHC,MAAAA,YAAY,EAAE,KAAKC,uBAAL,CAA6B/H,IAA7B,CAAkC,IAAlC,CAlCX;AAmCHgI,MAAAA,UAAU,EAAE,KAnCT;AAoCHC,MAAAA,eAAe,EAAE;AApCd,KAAP;AAsCH,GAzbgC;AA0bjC1B,EAAAA,wBAAwB,EAAE,YAAW;AACjC,QAAI,CAAC,KAAKnN,MAAL,CAAY,oBAAZ,CAAL,EAAwC;AACpC,aAAO,IAAP;AACH;;AACD,WAAOD,CAAC,IAAI;AACR,WAAKyE,uBAAL,CAA6B;AACzBsK,QAAAA,KAAK,EAAE/O,CAAC,CAACgP;AADgB,OAA7B;AAGH,KAJD;AAKH,GAncgC;AAocjCC,EAAAA,iBAAiB,EAAE,YAAW;AAC1B,QAAIC,UAAU,GAAGrQ,YAAY,CAAC,KAAKoB,MAAL,CAAY,uBAAZ,CAAD,CAA7B;;AACA,QAAI,KAAK,CAAL,KAAWiP,UAAf,EAA2B;AACvB,WAAKtD,eAAL,CAAqB,OAArB,EAA8B,MAAMhN,eAAe,CAAC,KAAK+E,QAAL,EAAD,CAAnD;AACH;AACJ,GAzcgC;AA0cjCiL,EAAAA,uBAAuB,EAAE,UAAS5O,CAAT,EAAY;AACjCA,IAAAA,CAAC,CAAC8C,QAAF,IAAc,KAAKqJ,MAAL,CAAYgD,eAAZ,GAA8BlF,WAA9B,CAA0C7K,gCAA1C,EAA4EY,CAAC,CAAC8C,QAAF,CAAWG,CAAX,CAAamM,IAAzF,CAAd;AACH,GA5cgC;AA6cjC9C,EAAAA,oBAAoB,EAAEhP,IA7cW;AA8cjCoP,EAAAA,mBAAmB,EAAE,YAAW;AAC5B,SAAKzM,MAAL,CAAY,QAAZ,EAAsB,KAAtB;AACH,GAhdgC;AAidjCuM,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,QAAI6C,qBAAJ;;AACA,SAAKhL,WAAL;;AACA,QAAIiL,oBAAoB,GAAG,KAAKnD,MAAL,CAAYgD,eAAZ,EAA3B;;AACA,QAAIrM,QAAQ,GAAGhE,MAAM,CAACwQ,oBAAD,CAArB;;AACA,QAAI,KAAKC,MAAL,CAAY5D,SAAZ,MAA2B2D,oBAAoB,CAACE,QAArB,CAA8BpQ,gCAA9B,CAA/B,EAAgG;AAC5F,UAAIqQ,MAAM,GAAG,KAAKF,MAAL,CAAY5L,QAAZ,EAAb;;AACA5E,MAAAA,IAAI,CAACuQ,oBAAD,EAAuB;AACvBI,QAAAA,GAAG,EAAE5M,QAAQ,CAAC4M,GAAT,GAAeC,QAAQ,CAACF,MAAM,CAACG,GAAP,CAAW,UAAX,CAAD;AADL,OAAvB,CAAJ;AAGH;;AACD,cAAUP,qBAAqB,GAAG,KAAKQ,kBAAvC,KAA8D,KAAK,CAAL,KAAWR,qBAAzE,GAAiG,KAAK,CAAtG,GAA0GA,qBAAqB,CAACpP,MAAtB,CAA6B,iBAA7B,EAAgD,KAAK6P,oCAAL,EAAhD,CAA1G;AACH,GA7dgC;AA8djClD,EAAAA,mBAAmB,EAAE,YAAW;AAC5B,QAAImD,sBAAJ;;AACA,SAAKvL,YAAL;;AACA,cAAUuL,sBAAsB,GAAG,KAAKF,kBAAxC,KAA+D,KAAK,CAAL,KAAWE,sBAA1E,GAAmG,KAAK,CAAxG,GAA4GA,sBAAsB,CAAC9P,MAAvB,CAA8B,iBAA9B,EAAiD,KAAK6P,oCAAL,EAAjD,CAA5G;AACH,GAlegC;AAmejCA,EAAAA,oCAAoC,EAAE,YAAW;AAC7C,QAAIE,eAAe,GAAG,OAAtB;;AACA,QAAI,KAAK7D,MAAL,IAAe,KAAKA,MAAL,CAAYlM,MAAZ,CAAmB,SAAnB,CAAnB,EAAkD;AAC9C,UAAI;AACAyP,QAAAA,GAAG,EAAEO;AADL,UAEAnS,iBAAiB,CAACoS,KAAlB,CAAwB,KAAKvM,QAAL,EAAxB,CAFJ;AAGA,UAAI;AACA+L,QAAAA,GAAG,EAAES;AADL,UAEArS,iBAAiB,CAACoS,KAAlB,CAAwB,KAAK/D,MAAL,CAAYa,QAAZ,EAAxB,CAFJ;AAGAgD,MAAAA,eAAe,GAAGC,KAAK,GAAG,KAAKhQ,MAAL,CAAY,eAAZ,EAA6B8C,MAA7B,CAAoCE,CAA5C,GAAgDkN,QAAhD,GAA2D,OAA3D,GAAqE,OAAvF;AACH;;AACD,WAAOH,eAAP;AACH,GA/egC;AAgfjClC,EAAAA,4BAA4B,EAAE,UAASsC,IAAT,EAAe;AACzC,QAAI;AACAC,MAAAA,MAAM,EAAEA;AADR,QAEAD,IAFJ;AAGA,QAAIE,OAAO,GAAGpT,CAAC,CAACmT,MAAD,CAAf;AACA,QAAI3G,cAAc,GAAG,KAAK6G,SAAL,CAAe,UAAf,CAArB;AACA,QAAIC,eAAe,GAAG9G,cAAc,IAAIA,cAAc,CAAC/F,QAAf,EAAxC;AACA,QAAI8M,cAAc,GAAG,CAAC,CAACH,OAAO,CAAC3F,OAAR,CAAgB,KAAKhH,QAAL,EAAhB,EAAiCkE,MAAxD;AACA,QAAI6I,uBAAuB,GAAG,CAAC,CAACJ,OAAO,CAAC3F,OAAR,CAAgB6F,eAAhB,EAAiC3I,MAAjE;AACA,QAAI8I,cAAc,GAAG,CAACF,cAAD,IAAmB,CAACC,uBAAzC;AACA,WAAOC,cAAP;AACH,GA3fgC;AA4fjCC,EAAAA,MAAM,EAAE,YAAW;AACf,WAAO,KAAK1G,uBAAZ;;AACA,QAAI,KAAKU,OAAT,EAAkB;AACd,WAAKA,OAAL,CAAaiG,MAAb;;AACA,aAAO,KAAKjG,OAAZ;AACA,aAAO,KAAKuB,MAAZ;AACH;;AACD,SAAKrM,QAAL;AACH,GApgBgC;AAqgBjC8L,EAAAA,eAAe,EAAE,UAASkF,UAAT,EAAqBzP,KAArB,EAA4B;AACzC,SAAK0P,gBAAL,CAAsB,QAAtB,EAAgC3F,SAAhC;AACH,GAvgBgC;AAwgBjCtK,EAAAA,iBAAiB,EAAE,YAAW;AAC1B,QAAI,CAAC,KAAKb,MAAL,CAAY,UAAZ,CAAL,EAA8B;AAC1B,WAAK+K,gBAAL,CAAsB,IAAtB;AACH;AACJ,GA5gBgC;AA6gBjC0D,EAAAA,qBAAqB,EAAE,YAAW;AAC9B,WAAO,iBAAiB,KAAKzO,MAAL,CAAY,gBAAZ,CAAjB,GAAiD,KAAK+Q,wBAAL,EAAjD,GAAmF,EAA1F;AACH,GA/gBgC;AAghBjC1Q,EAAAA,qBAAqB,EAAE,YAAW;AAC9B,WAAO,KAAK6L,MAAL,CAAY8E,QAAZ,GAAuBrN,IAAvB,CAA4B,0BAA5B,CAAP;AACH,GAlhBgC;AAmhBjCvD,EAAAA,oBAAoB,EAAE,YAAW;AAC7B,WAAO,KAAK8L,MAAL,CAAY8E,QAAZ,GAAuBrN,IAAvB,CAA4B,4BAA5B,CAAP;AACH,GArhBgC;AAshBjCsN,EAAAA,uBAAuB,EAAE,UAASlR,CAAT,EAAY;AACjC,QAAI2D,QAAQ,GAAGzG,CAAC,CAAC8C,CAAC,CAACmR,aAAH,CAAhB;;AACA,QAAInR,CAAC,CAACI,QAAF,IAAcuD,QAAQ,CAACyN,EAAT,CAAY,KAAK9Q,qBAAL,EAAZ,CAAd,IAA2D,CAACN,CAAC,CAACI,QAAH,IAAeuD,QAAQ,CAACyN,EAAT,CAAY,KAAK/Q,oBAAL,EAAZ,CAA9E,EAAwH;AACpHlD,MAAAA,YAAY,CAACoD,OAAb,CAAqB,KAAKyG,MAAL,EAArB,EAAoC,OAApC;AACAhH,MAAAA,CAAC,CAACQ,cAAF;AACH;AACJ,GA5hBgC;AA6hBjC6Q,EAAAA,uBAAuB,EAAE,YAAW;AAChClU,IAAAA,YAAY,CAACoD,OAAb,CAAqB,KAAKyG,MAAL,EAArB,EAAoC,OAApC;AACA,SAAK9G,KAAL;AACH,GAhiBgC;AAiiBjCoR,EAAAA,8BAA8B,EAAE,UAAStR,CAAT,EAAY;AACxCA,IAAAA,CAAC,CAACgP,SAAF,CAAYuC,kBAAZ,CAA+B,KAA/B,EAAsC,KAAKL,uBAAL,CAA6BrK,IAA7B,CAAkC,IAAlC,CAAtC;AACA7G,IAAAA,CAAC,CAACgP,SAAF,CAAYuC,kBAAZ,CAA+B,QAA/B,EAAyC,KAAKF,uBAAL,CAA6BxK,IAA7B,CAAkC,IAAlC,CAAzC;AACH,GApiBgC;AAqiBjCmK,EAAAA,wBAAwB,EAAE,YAAW;AACjC,QAAIQ,aAAa,GAAG,CAAC;AACjBC,MAAAA,QAAQ,EAAE,MADO;AAEjBhO,MAAAA,OAAO,EAAE;AACLiO,QAAAA,OAAO,EAAE,KAAKC,mBAAL,CAAyB9K,IAAzB,CAA8B,IAA9B,CADJ;AAEL+K,QAAAA,IAAI,EAAE,KAAK3R,MAAL,CAAY,iBAAZ,CAFD;AAGLkN,QAAAA,aAAa,EAAE,KAAKmE,8BAAL,CAAoCzK,IAApC,CAAyC,IAAzC;AAHV;AAFQ,KAAD,EAOjB;AACC4K,MAAAA,QAAQ,EAAE,QADX;AAEChO,MAAAA,OAAO,EAAE;AACLiO,QAAAA,OAAO,EAAE,KAAKG,oBAAL,CAA0BhL,IAA1B,CAA+B,IAA/B,CADJ;AAEL+K,QAAAA,IAAI,EAAE,KAAK3R,MAAL,CAAY,kBAAZ,CAFD;AAGLkN,QAAAA,aAAa,EAAE,KAAKmE,8BAAL,CAAoCzK,IAApC,CAAyC,IAAzC;AAHV;AAFV,KAPiB,CAApB;AAeA,WAAO,KAAKiL,qBAAL,CAA2BN,aAA3B,CAAP;AACH,GAtjBgC;AAujBjCM,EAAAA,qBAAqB,EAAE,UAASN,aAAT,EAAwB;AAC3C,QAAI9O,eAAe,GAAG,KAAKzC,MAAL,CAAY,iBAAZ,CAAtB;AACA,QAAI8R,YAAY,GAAGP,aAAnB;;AACA,QAAI,cAAc9O,eAAlB,EAAmC;AAC/B,UAAII,QAAQ,GAAGvF,SAAS,CAACmF,eAAD,CAAxB;AACAjF,MAAAA,IAAI,CAACsU,YAAD,EAAgB,UAASC,CAAT,EAAYC,OAAZ,EAAqB;AACrCtU,QAAAA,MAAM,CAACsU,OAAD,EAAU;AACZC,UAAAA,OAAO,EAAEpP,QAAQ,CAAC,CAAD,CADL;AAEZqP,UAAAA,QAAQ,EAAErP,QAAQ,CAAC,CAAD;AAFN,SAAV,CAAN;AAIH,OALG,CAAJ;AAMH;;AACD,WAAOiP,YAAP;AACH,GApkBgC;AAqkBjCJ,EAAAA,mBAAmB,EAAE,YAAW;AAC5B,SAAKzR,KAAL;AACA,SAAKD,MAAL,CAAY,mBAAZ,KAAoC,KAAKmS,KAAL,EAApC;AACH,GAxkBgC;AAykBjCP,EAAAA,oBAAoB,EAAE,YAAW;AAC7B,SAAK3R,KAAL;AACA,SAAKD,MAAL,CAAY,mBAAZ,KAAoC,KAAKmS,KAAL,EAApC;AACH,GA5kBgC;AA6kBjCC,EAAAA,mBAAmB,EAAE,UAASC,IAAT,EAAe;AAChC,QAAI7O,OAAO,GAAGxF,MAAM,CAACsU,uBAAP,CAA+BD,IAA/B,CAAd;;AACA,SAAK1G,eAAL,CAAqBnI,OAArB;;AACA,QAAI+O,WAAW,GAAGC,MAAM,CAACC,IAAP,CAAYjP,OAAZ,CAAlB;;AACA,QAAI,CAAC,CAAD,KAAO+O,WAAW,CAACG,OAAZ,CAAoB,OAApB,CAAP,IAAuC,CAAC,CAAD,KAAOH,WAAW,CAACG,OAAZ,CAAoB,QAApB,CAAlD,EAAiF;AAC7E,WAAK1D,iBAAL;AACH;AACJ,GAplBgC;AAqlBjCtK,EAAAA,oBAAoB,EAAE,YAAW;AAC7B,QAAI,KAAK1E,MAAL,CAAY,wBAAZ,CAAJ,EAA2C;AACvC,WAAKmI,eAAL,GAAuBlL,CAAC,CAAC,SAAD,CAAD,CAAa0V,IAAb,CAAkB,MAAlB,EAA0B,QAA1B,EAAoCrL,QAApC,CAA6C,KAAK5D,QAAL,EAA7C,CAAvB;AACH;AACJ,GAzlBgC;AA0lBjC+C,EAAAA,eAAe,EAAE,YAAW;AACxB,SAAKmM,iBAAL,GAAyBC,GAAzB,CAA6B,KAAK7S,MAAL,CAAY,OAAZ,CAA7B;AACH,GA5lBgC;AA6lBjC4S,EAAAA,iBAAiB,EAAE,YAAW;AAC1B,QAAI,KAAK5S,MAAL,CAAY,wBAAZ,CAAJ,EAA2C;AACvC,aAAO,KAAKmI,eAAZ;AACH,KAFD,MAEO;AACH,aAAO,KAAKtI,QAAL,EAAP;AACH;AACJ,GAnmBgC;AAomBjCiT,EAAAA,QAAQ,EAAE,YAAW;AACjB,SAAK1I,qBAAL;;AACA,SAAKvK,QAAL;AACH,GAvmBgC;AAwmBjCkT,EAAAA,cAAc,EAAE,UAASV,IAAT,EAAe;AAC3B,QAAIW,YAAJ;;AACA,YAAQX,IAAI,CAAChU,IAAb;AACI,WAAK,OAAL;AACA,WAAK,QAAL;AACI,aAAKwB,QAAL,CAAcwS,IAAd;AACA,kBAAUW,YAAY,GAAG,KAAK9G,MAA9B,KAAyC,KAAK,CAAL,KAAW8G,YAApD,GAAmE,KAAK,CAAxE,GAA4EA,YAAY,CAACC,OAAb,EAA5E;AACA;;AACJ,WAAK,QAAL;AACI,aAAKjO,kBAAL;;AACA;;AACJ,WAAK,UAAL;AACA,WAAK,UAAL;AACI,aAAKlB,sBAAL;;AACA;;AACJ,WAAK,oBAAL;AACI,aAAKC,2BAAL;;AACA;;AACJ,WAAK,eAAL;AACI,YAAItG,SAAS,CAAC4U,IAAI,CAACjR,KAAN,CAAb,EAA2B;AACvB,eAAK+E,YAAL;AACH,SAFD,MAEO;AACH,eAAK+M,WAAL;AACH;;AACD;;AACJ,WAAK,mBAAL;AACA,WAAK,kBAAL;AACI,aAAKA,WAAL;;AACA;;AACJ,WAAK,wBAAL;AACA,WAAK,oBAAL;AACI,aAAKC,cAAL,CAAoB,CAAC,UAAD,CAApB;;AACA;;AACJ,WAAK,iBAAL;AACI,aAAKf,mBAAL,CAAyBC,IAAzB;;AACA,aAAKpO,QAAL,CAAcC,KAAd,CAAoB,iBAApB,EAAuC,KAAKlE,MAAL,CAAY,iBAAZ,CAAvC;;AACA;;AACJ,WAAK,eAAL;AACI;;AACJ,WAAK,gBAAL;AACI,YAAItB,SAAS,EAAb,EAAiB;AACb,eAAKwG,YAAL;AACH;;AACD;;AACJ,WAAK,gBAAL;AACA,WAAK,iBAAL;AACA,WAAK,kBAAL;AACA,WAAK,iBAAL;AACI,aAAKyG,eAAL,CAAqB,cAArB,EAAqC,KAAK8C,qBAAL,EAArC;;AACA;;AACJ,WAAK,wBAAL;AACI,YAAI,KAAKtG,eAAT,EAA0B;AACtB,eAAKA,eAAL,CAAqByI,MAArB;;AACA,eAAKzI,eAAL,GAAuB,KAAK,CAA5B;AACH;;AACD,aAAKzD,oBAAL;;AACA;;AACJ,WAAK,YAAL;AACI,aAAKV,oBAAL,CAA0BqO,IAAI,CAACjR,KAA/B;;AACA,aAAKvB,QAAL,CAAcwS,IAAd;AACA;;AACJ;AACI,aAAKxS,QAAL,CAAcwS,IAAd;AA5DR;AA8DH,GAxqBgC;AAyqBjCe,EAAAA,IAAI,EAAE,YAAW;AACb,SAAKpT,MAAL,CAAY,QAAZ,EAAsB,IAAtB;AACH,GA3qBgC;AA4qBjCC,EAAAA,KAAK,EAAE,YAAW;AACd,SAAKD,MAAL,CAAY,QAAZ,EAAsB,KAAtB;AACH,GA9qBgC;AA+qBjCqT,EAAAA,KAAK,EAAE,YAAW;AACd,WAAO1V,gBAAgB,CAAC,KAAKoJ,MAAL,EAAD,CAAvB;AACH,GAjrBgC;AAkrBjC0D,EAAAA,OAAO,EAAE,YAAW;AAChB,WAAO,KAAKyB,MAAL,GAAc,KAAKA,MAAL,CAAYzB,OAAZ,EAAd,GAAsC,IAA7C;AACH;AAprBgC,CAAhB,CAArB;AAsrBArN,iBAAiB,CAAC,kBAAD,EAAqBsC,cAArB,CAAjB;AACA,eAAeA,cAAf","sourcesContent":["/**\r\n * DevExtreme (esm/ui/drop_down_editor/ui.drop_down_editor.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport $ from \"../../core/renderer\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport Guid from \"../../core/guid\";\r\nimport registerComponent from \"../../core/component_registrator\";\r\nimport {\r\n    noop,\r\n    splitPair\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    focused\r\n} from \"../widget/selectors\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    isDefined\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    getPublicElement\r\n} from \"../../core/element\";\r\nimport errors from \"../widget/ui.errors\";\r\nimport animationPosition from \"../../animation/position\";\r\nimport {\r\n    getDefaultAlignment\r\n} from \"../../core/utils/position\";\r\nimport DropDownButton from \"./ui.drop_down_button\";\r\nimport Widget from \"../widget/ui.widget\";\r\nimport messageLocalization from \"../../localization/message\";\r\nimport {\r\n    addNamespace,\r\n    isCommandKeyPressed\r\n} from \"../../events/utils/index\";\r\nimport TextBox from \"../text_box\";\r\nimport {\r\n    name as clickEventName\r\n} from \"../../events/click\";\r\nimport devices from \"../../core/devices\";\r\nimport {\r\n    FunctionTemplate\r\n} from \"../../core/templates/function_template\";\r\nimport Popup from \"../popup\";\r\nimport {\r\n    hasWindow\r\n} from \"../../core/utils/window\";\r\nimport {\r\n    getElementWidth,\r\n    getSizeValue\r\n} from \"./utils\";\r\nimport {\r\n    locate,\r\n    move\r\n} from \"../../animation/translator\";\r\nvar DROP_DOWN_EDITOR_CLASS = \"dx-dropdowneditor\";\r\nvar DROP_DOWN_EDITOR_INPUT_WRAPPER = \"dx-dropdowneditor-input-wrapper\";\r\nvar DROP_DOWN_EDITOR_BUTTON_ICON = \"dx-dropdowneditor-icon\";\r\nvar DROP_DOWN_EDITOR_OVERLAY = \"dx-dropdowneditor-overlay\";\r\nvar DROP_DOWN_EDITOR_OVERLAY_FLIPPED = \"dx-dropdowneditor-overlay-flipped\";\r\nvar DROP_DOWN_EDITOR_ACTIVE = \"dx-dropdowneditor-active\";\r\nvar DROP_DOWN_EDITOR_FIELD_CLICKABLE = \"dx-dropdowneditor-field-clickable\";\r\nvar DROP_DOWN_EDITOR_FIELD_TEMPLATE_WRAPPER = \"dx-dropdowneditor-field-template-wrapper\";\r\nvar isIOs = \"ios\" === devices.current().platform;\r\nvar DropDownEditor = TextBox.inherit({\r\n    _supportedKeys: function() {\r\n        return extend({}, this.callBase(), {\r\n            tab: function(e) {\r\n                if (!this.option(\"opened\")) {\r\n                    return\r\n                }\r\n                if (\"instantly\" === this.option(\"applyValueMode\")) {\r\n                    this.close();\r\n                    return\r\n                }\r\n                var $focusableElement = e.shiftKey ? this._getLastPopupElement() : this._getFirstPopupElement();\r\n                $focusableElement && eventsEngine.trigger($focusableElement, \"focus\");\r\n                e.preventDefault()\r\n            },\r\n            escape: function(e) {\r\n                if (this.option(\"opened\")) {\r\n                    e.preventDefault()\r\n                }\r\n                this.close();\r\n                return true\r\n            },\r\n            upArrow: function(e) {\r\n                if (!isCommandKeyPressed(e)) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    if (e.altKey) {\r\n                        this.close();\r\n                        return false\r\n                    }\r\n                }\r\n                return true\r\n            },\r\n            downArrow: function(e) {\r\n                if (!isCommandKeyPressed(e)) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    if (e.altKey) {\r\n                        this._validatedOpening();\r\n                        return false\r\n                    }\r\n                }\r\n                return true\r\n            },\r\n            enter: function(e) {\r\n                if (this.option(\"opened\")) {\r\n                    e.preventDefault();\r\n                    this._valueChangeEventHandler(e)\r\n                }\r\n                return true\r\n            }\r\n        })\r\n    },\r\n    _getDefaultButtons: function() {\r\n        return this.callBase().concat([{\r\n            name: \"dropDown\",\r\n            Ctor: DropDownButton\r\n        }])\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            value: null,\r\n            onOpened: null,\r\n            onClosed: null,\r\n            opened: false,\r\n            acceptCustomValue: true,\r\n            applyValueMode: \"instantly\",\r\n            deferRendering: true,\r\n            activeStateEnabled: true,\r\n            dropDownButtonTemplate: \"dropDownButton\",\r\n            fieldTemplate: null,\r\n            openOnFieldClick: false,\r\n            showDropDownButton: true,\r\n            buttons: void 0,\r\n            dropDownOptions: {\r\n                showTitle: false\r\n            },\r\n            popupPosition: this._getDefaultPopupPosition(),\r\n            onPopupInitialized: null,\r\n            applyButtonText: messageLocalization.format(\"OK\"),\r\n            cancelButtonText: messageLocalization.format(\"Cancel\"),\r\n            buttonsLocation: \"default\",\r\n            useHiddenSubmitElement: false\r\n        })\r\n    },\r\n    _useTemplates: function() {\r\n        return true\r\n    },\r\n    _getDefaultPopupPosition: function(isRtlEnabled) {\r\n        var position = getDefaultAlignment(isRtlEnabled);\r\n        return {\r\n            offset: {\r\n                h: 0,\r\n                v: -1\r\n            },\r\n            my: position + \" top\",\r\n            at: position + \" bottom\",\r\n            collision: \"flip flip\"\r\n        }\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        return this.callBase().concat([{\r\n            device: function(_device) {\r\n                var isGeneric = \"generic\" === _device.platform;\r\n                return isGeneric\r\n            },\r\n            options: {\r\n                popupPosition: {\r\n                    offset: {\r\n                        v: 0\r\n                    }\r\n                }\r\n            }\r\n        }])\r\n    },\r\n    _inputWrapper: function() {\r\n        return this.$element().find(\".\" + DROP_DOWN_EDITOR_INPUT_WRAPPER).first()\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initVisibilityActions();\r\n        this._initPopupInitializedAction();\r\n        this._updatePopupPosition(this.option(\"rtlEnabled\"));\r\n        this._options.cache(\"dropDownOptions\", this.option(\"dropDownOptions\"))\r\n    },\r\n    _updatePopupPosition: function(isRtlEnabled) {\r\n        var {\r\n            my: my,\r\n            at: at\r\n        } = this._getDefaultPopupPosition(isRtlEnabled);\r\n        var currentPosition = this.option(\"popupPosition\");\r\n        this.option(\"popupPosition\", extend({}, currentPosition, {\r\n            my: my,\r\n            at: at\r\n        }))\r\n    },\r\n    _initVisibilityActions: function() {\r\n        this._openAction = this._createActionByOption(\"onOpened\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        });\r\n        this._closeAction = this._createActionByOption(\"onClosed\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })\r\n    },\r\n    _initPopupInitializedAction: function() {\r\n        this._popupInitializedAction = this._createActionByOption(\"onPopupInitialized\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })\r\n    },\r\n    _initMarkup: function() {\r\n        this._renderSubmitElement();\r\n        this.callBase();\r\n        this.$element().addClass(DROP_DOWN_EDITOR_CLASS);\r\n        this.setAria(\"role\", \"combobox\")\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._renderOpenHandler();\r\n        this._attachFocusOutHandler();\r\n        this._renderOpenedState()\r\n    },\r\n    _renderContentImpl: function() {\r\n        if (!this.option(\"deferRendering\")) {\r\n            this._createPopup()\r\n        }\r\n    },\r\n    _renderInput: function() {\r\n        this.callBase();\r\n        this._wrapInput();\r\n        this._setDefaultAria()\r\n    },\r\n    _wrapInput: function() {\r\n        this._$container = this.$element().wrapInner($(\"<div>\").addClass(DROP_DOWN_EDITOR_INPUT_WRAPPER)).children().eq(0)\r\n    },\r\n    _setDefaultAria: function() {\r\n        this.setAria({\r\n            haspopup: \"true\",\r\n            autocomplete: \"list\"\r\n        })\r\n    },\r\n    _readOnlyPropValue: function() {\r\n        return !this._isEditable() || this.callBase()\r\n    },\r\n    _cleanFocusState: function() {\r\n        this.callBase();\r\n        if (this.option(\"fieldTemplate\")) {\r\n            this._detachFocusEvents()\r\n        }\r\n    },\r\n    _getFieldTemplate: function() {\r\n        return this.option(\"fieldTemplate\") && this._getTemplateByOption(\"fieldTemplate\")\r\n    },\r\n    _renderMask: function() {\r\n        if (this.option(\"fieldTemplate\")) {\r\n            return\r\n        }\r\n        this.callBase()\r\n    },\r\n    _renderField: function() {\r\n        var fieldTemplate = this._getFieldTemplate();\r\n        fieldTemplate && this._renderTemplatedField(fieldTemplate, this._fieldRenderData())\r\n    },\r\n    _renderPlaceholder: function() {\r\n        var hasFieldTemplate = !!this._getFieldTemplate();\r\n        if (!hasFieldTemplate) {\r\n            this.callBase()\r\n        }\r\n    },\r\n    _renderValue: function() {\r\n        if (this.option(\"useHiddenSubmitElement\")) {\r\n            this._setSubmitValue()\r\n        }\r\n        var promise = this.callBase();\r\n        promise.always(this._renderField.bind(this))\r\n    },\r\n    _renderTemplatedField: function(fieldTemplate, data) {\r\n        var isFocused = focused(this._input());\r\n        var $container = this._$container;\r\n        this._detachKeyboardEvents();\r\n        this._refreshButtonsContainer();\r\n        this._detachWrapperContent();\r\n        this._detachFocusEvents();\r\n        $container.empty();\r\n        var $templateWrapper = $(\"<div>\").addClass(DROP_DOWN_EDITOR_FIELD_TEMPLATE_WRAPPER).appendTo($container);\r\n        fieldTemplate.render({\r\n            model: data,\r\n            container: getPublicElement($templateWrapper),\r\n            onRendered: () => {\r\n                var $input = this._input();\r\n                if (!$input.length) {\r\n                    throw errors.Error(\"E1010\")\r\n                }\r\n                this._integrateInput();\r\n                isFocused && eventsEngine.trigger($input, \"focus\")\r\n            }\r\n        });\r\n        this._attachWrapperContent($container)\r\n    },\r\n    _detachWrapperContent() {\r\n        var _this$_$submitElement, _this$_$beforeButtons, _this$_$afterButtonsC;\r\n        var useHiddenSubmitElement = this.option(\"useHiddenSubmitElement\");\r\n        useHiddenSubmitElement && (null === (_this$_$submitElement = this._$submitElement) || void 0 === _this$_$submitElement ? void 0 : _this$_$submitElement.detach());\r\n        var beforeButtonsContainerParent = null === (_this$_$beforeButtons = this._$beforeButtonsContainer) || void 0 === _this$_$beforeButtons ? void 0 : _this$_$beforeButtons[0].parentNode;\r\n        var afterButtonsContainerParent = null === (_this$_$afterButtonsC = this._$afterButtonsContainer) || void 0 === _this$_$afterButtonsC ? void 0 : _this$_$afterButtonsC[0].parentNode;\r\n        null === beforeButtonsContainerParent || void 0 === beforeButtonsContainerParent ? void 0 : beforeButtonsContainerParent.removeChild(this._$beforeButtonsContainer[0]);\r\n        null === afterButtonsContainerParent || void 0 === afterButtonsContainerParent ? void 0 : afterButtonsContainerParent.removeChild(this._$afterButtonsContainer[0])\r\n    },\r\n    _attachWrapperContent($container) {\r\n        var _this$_$submitElement2;\r\n        var useHiddenSubmitElement = this.option(\"useHiddenSubmitElement\");\r\n        $container.prepend(this._$beforeButtonsContainer);\r\n        useHiddenSubmitElement && (null === (_this$_$submitElement2 = this._$submitElement) || void 0 === _this$_$submitElement2 ? void 0 : _this$_$submitElement2.appendTo($container));\r\n        $container.append(this._$afterButtonsContainer)\r\n    },\r\n    _refreshButtonsContainer() {\r\n        this._$buttonsContainer = this.$element().children().eq(0)\r\n    },\r\n    _integrateInput: function() {\r\n        this._renderFocusState();\r\n        this._refreshValueChangeEvent();\r\n        this._refreshEvents();\r\n        this._refreshEmptinessEvent()\r\n    },\r\n    _refreshEmptinessEvent: function() {\r\n        eventsEngine.off(this._input(), \"input blur\", this._toggleEmptinessEventHandler);\r\n        this._renderEmptinessEvent()\r\n    },\r\n    _fieldRenderData: function() {\r\n        return this.option(\"value\")\r\n    },\r\n    _initTemplates: function() {\r\n        this._templateManager.addDefaultTemplates({\r\n            dropDownButton: new FunctionTemplate((function(options) {\r\n                var $icon = $(\"<div>\").addClass(DROP_DOWN_EDITOR_BUTTON_ICON);\r\n                $(options.container).append($icon)\r\n            }))\r\n        });\r\n        this.callBase()\r\n    },\r\n    _renderOpenHandler: function() {\r\n        var $inputWrapper = this._inputWrapper();\r\n        var eventName = addNamespace(clickEventName, this.NAME);\r\n        var openOnFieldClick = this.option(\"openOnFieldClick\");\r\n        eventsEngine.off($inputWrapper, eventName);\r\n        eventsEngine.on($inputWrapper, eventName, this._getInputClickHandler(openOnFieldClick));\r\n        this.$element().toggleClass(DROP_DOWN_EDITOR_FIELD_CLICKABLE, openOnFieldClick);\r\n        if (openOnFieldClick) {\r\n            this._openOnFieldClickAction = this._createAction(this._openHandler.bind(this))\r\n        }\r\n    },\r\n    _attachFocusOutHandler: function() {\r\n        if (isIOs) {\r\n            this._detachFocusOutEvents();\r\n            eventsEngine.on(this._inputWrapper(), addNamespace(\"focusout\", this.NAME), event => {\r\n                var newTarget = event.relatedTarget;\r\n                var popupWrapper = this.content ? $(this.content()).closest(\".\" + DROP_DOWN_EDITOR_OVERLAY) : this._$popup;\r\n                if (newTarget && this.option(\"opened\")) {\r\n                    var isNewTargetOutside = 0 === $(newTarget).closest(\".\" + DROP_DOWN_EDITOR_OVERLAY, popupWrapper).length;\r\n                    if (isNewTargetOutside) {\r\n                        this.close()\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    },\r\n    _detachFocusOutEvents: function() {\r\n        isIOs && eventsEngine.off(this._inputWrapper(), addNamespace(\"focusout\", this.NAME))\r\n    },\r\n    _getInputClickHandler: function(openOnFieldClick) {\r\n        return openOnFieldClick ? e => {\r\n            this._executeOpenAction(e)\r\n        } : e => {\r\n            this._focusInput()\r\n        }\r\n    },\r\n    _openHandler: function() {\r\n        this._toggleOpenState()\r\n    },\r\n    _executeOpenAction: function(e) {\r\n        this._openOnFieldClickAction({\r\n            event: e\r\n        })\r\n    },\r\n    _keyboardEventBindingTarget: function() {\r\n        return this._input()\r\n    },\r\n    _focusInput: function() {\r\n        if (this.option(\"disabled\")) {\r\n            return false\r\n        }\r\n        if (this.option(\"focusStateEnabled\") && !focused(this._input())) {\r\n            this._resetCaretPosition();\r\n            eventsEngine.trigger(this._input(), \"focus\")\r\n        }\r\n        return true\r\n    },\r\n    _resetCaretPosition: function() {\r\n        var ignoreEditable = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : false;\r\n        var inputElement = this._input().get(0);\r\n        if (inputElement) {\r\n            var {\r\n                value: value\r\n            } = inputElement;\r\n            var caretPosition = isDefined(value) && (ignoreEditable || this._isEditable()) ? value.length : 0;\r\n            this._caret({\r\n                start: caretPosition,\r\n                end: caretPosition\r\n            }, true)\r\n        }\r\n    },\r\n    _isEditable: function() {\r\n        return this.option(\"acceptCustomValue\")\r\n    },\r\n    _toggleOpenState: function(isVisible) {\r\n        if (!this._focusInput()) {\r\n            return\r\n        }\r\n        if (!this.option(\"readOnly\")) {\r\n            isVisible = arguments.length ? isVisible : !this.option(\"opened\");\r\n            this.option(\"opened\", isVisible)\r\n        }\r\n    },\r\n    _renderOpenedState: function() {\r\n        var opened = this.option(\"opened\");\r\n        if (opened) {\r\n            this._createPopup()\r\n        }\r\n        this.$element().toggleClass(DROP_DOWN_EDITOR_ACTIVE, opened);\r\n        this._setPopupOption(\"visible\", opened);\r\n        this.setAria({\r\n            expanded: opened\r\n        });\r\n        this.setAria(\"owns\", opened ? this._popupContentId : void 0, this.$element())\r\n    },\r\n    _createPopup: function() {\r\n        if (this._$popup) {\r\n            return\r\n        }\r\n        this._$popup = $(\"<div>\").addClass(DROP_DOWN_EDITOR_OVERLAY).appendTo(this.$element());\r\n        this._renderPopup();\r\n        this._renderPopupContent()\r\n    },\r\n    _renderPopupContent: noop,\r\n    _renderPopup: function() {\r\n        var popupConfig = extend(this._popupConfig(), this._options.cache(\"dropDownOptions\"));\r\n        this._popup = this._createComponent(this._$popup, Popup, popupConfig);\r\n        this._popup.on({\r\n            showing: this._popupShowingHandler.bind(this),\r\n            shown: this._popupShownHandler.bind(this),\r\n            hiding: this._popupHidingHandler.bind(this),\r\n            hidden: this._popupHiddenHandler.bind(this),\r\n            contentReady: this._contentReadyHandler.bind(this)\r\n        });\r\n        this._contentReadyHandler();\r\n        this._setPopupContentId(this._popup.$content());\r\n        this._bindInnerWidgetOptions(this._popup, \"dropDownOptions\")\r\n    },\r\n    _setPopupContentId($popupContent) {\r\n        this._popupContentId = \"dx-\" + new Guid;\r\n        this.setAria(\"id\", this._popupContentId, $popupContent)\r\n    },\r\n    _contentReadyHandler: noop,\r\n    _popupConfig: function() {\r\n        return {\r\n            onInitialized: this._popupInitializedHandler(),\r\n            position: extend(this.option(\"popupPosition\"), {\r\n                of: this.$element()\r\n            }),\r\n            showTitle: this.option(\"dropDownOptions.showTitle\"),\r\n            _ignoreFunctionValueDeprecation: true,\r\n            width: () => getElementWidth(this.$element()),\r\n            height: \"auto\",\r\n            shading: false,\r\n            wrapperAttr: {\r\n                class: DROP_DOWN_EDITOR_OVERLAY\r\n            },\r\n            hideOnParentScroll: true,\r\n            closeOnOutsideClick: this._closeOutsideDropDownHandler.bind(this),\r\n            animation: {\r\n                show: {\r\n                    type: \"fade\",\r\n                    duration: 0,\r\n                    from: 0,\r\n                    to: 1\r\n                },\r\n                hide: {\r\n                    type: \"fade\",\r\n                    duration: 400,\r\n                    from: 1,\r\n                    to: 0\r\n                }\r\n            },\r\n            deferRendering: false,\r\n            focusStateEnabled: false,\r\n            showCloseButton: false,\r\n            dragEnabled: false,\r\n            toolbarItems: this._getPopupToolbarItems(),\r\n            onPositioned: this._popupPositionedHandler.bind(this),\r\n            fullScreen: false,\r\n            contentTemplate: null\r\n        }\r\n    },\r\n    _popupInitializedHandler: function() {\r\n        if (!this.option(\"onPopupInitialized\")) {\r\n            return null\r\n        }\r\n        return e => {\r\n            this._popupInitializedAction({\r\n                popup: e.component\r\n            })\r\n        }\r\n    },\r\n    _dimensionChanged: function() {\r\n        var popupWidth = getSizeValue(this.option(\"dropDownOptions.width\"));\r\n        if (void 0 === popupWidth) {\r\n            this._setPopupOption(\"width\", () => getElementWidth(this.$element()))\r\n        }\r\n    },\r\n    _popupPositionedHandler: function(e) {\r\n        e.position && this._popup.$overlayContent().toggleClass(DROP_DOWN_EDITOR_OVERLAY_FLIPPED, e.position.v.flip)\r\n    },\r\n    _popupShowingHandler: noop,\r\n    _popupHidingHandler: function() {\r\n        this.option(\"opened\", false)\r\n    },\r\n    _popupShownHandler: function() {\r\n        var _this$_validationMess;\r\n        this._openAction();\r\n        var $popupOverlayContent = this._popup.$overlayContent();\r\n        var position = locate($popupOverlayContent);\r\n        if (this._label.isVisible() && $popupOverlayContent.hasClass(DROP_DOWN_EDITOR_OVERLAY_FLIPPED)) {\r\n            var $label = this._label.$element();\r\n            move($popupOverlayContent, {\r\n                top: position.top - parseInt($label.css(\"fontSize\"))\r\n            })\r\n        }\r\n        null === (_this$_validationMess = this._validationMessage) || void 0 === _this$_validationMess ? void 0 : _this$_validationMess.option(\"positionRequest\", this._getValidationMessagePositionRequest())\r\n    },\r\n    _popupHiddenHandler: function() {\r\n        var _this$_validationMess2;\r\n        this._closeAction();\r\n        null === (_this$_validationMess2 = this._validationMessage) || void 0 === _this$_validationMess2 ? void 0 : _this$_validationMess2.option(\"positionRequest\", this._getValidationMessagePositionRequest())\r\n    },\r\n    _getValidationMessagePositionRequest: function() {\r\n        var positionRequest = \"below\";\r\n        if (this._popup && this._popup.option(\"visible\")) {\r\n            var {\r\n                top: myTop\r\n            } = animationPosition.setup(this.$element());\r\n            var {\r\n                top: popupTop\r\n            } = animationPosition.setup(this._popup.$content());\r\n            positionRequest = myTop + this.option(\"popupPosition\").offset.v > popupTop ? \"below\" : \"above\"\r\n        }\r\n        return positionRequest\r\n    },\r\n    _closeOutsideDropDownHandler: function(_ref) {\r\n        var {\r\n            target: target\r\n        } = _ref;\r\n        var $target = $(target);\r\n        var dropDownButton = this.getButton(\"dropDown\");\r\n        var $dropDownButton = dropDownButton && dropDownButton.$element();\r\n        var isInputClicked = !!$target.closest(this.$element()).length;\r\n        var isDropDownButtonClicked = !!$target.closest($dropDownButton).length;\r\n        var isOutsideClick = !isInputClicked && !isDropDownButtonClicked;\r\n        return isOutsideClick\r\n    },\r\n    _clean: function() {\r\n        delete this._openOnFieldClickAction;\r\n        if (this._$popup) {\r\n            this._$popup.remove();\r\n            delete this._$popup;\r\n            delete this._popup\r\n        }\r\n        this.callBase()\r\n    },\r\n    _setPopupOption: function(optionName, value) {\r\n        this._setWidgetOption(\"_popup\", arguments)\r\n    },\r\n    _validatedOpening: function() {\r\n        if (!this.option(\"readOnly\")) {\r\n            this._toggleOpenState(true)\r\n        }\r\n    },\r\n    _getPopupToolbarItems: function() {\r\n        return \"useButtons\" === this.option(\"applyValueMode\") ? this._popupToolbarItemsConfig() : []\r\n    },\r\n    _getFirstPopupElement: function() {\r\n        return this._popup.$wrapper().find(\".dx-popup-done.dx-button\")\r\n    },\r\n    _getLastPopupElement: function() {\r\n        return this._popup.$wrapper().find(\".dx-popup-cancel.dx-button\")\r\n    },\r\n    _popupElementTabHandler: function(e) {\r\n        var $element = $(e.currentTarget);\r\n        if (e.shiftKey && $element.is(this._getFirstPopupElement()) || !e.shiftKey && $element.is(this._getLastPopupElement())) {\r\n            eventsEngine.trigger(this._input(), \"focus\");\r\n            e.preventDefault()\r\n        }\r\n    },\r\n    _popupElementEscHandler: function() {\r\n        eventsEngine.trigger(this._input(), \"focus\");\r\n        this.close()\r\n    },\r\n    _popupButtonInitializedHandler: function(e) {\r\n        e.component.registerKeyHandler(\"tab\", this._popupElementTabHandler.bind(this));\r\n        e.component.registerKeyHandler(\"escape\", this._popupElementEscHandler.bind(this))\r\n    },\r\n    _popupToolbarItemsConfig: function() {\r\n        var buttonsConfig = [{\r\n            shortcut: \"done\",\r\n            options: {\r\n                onClick: this._applyButtonHandler.bind(this),\r\n                text: this.option(\"applyButtonText\"),\r\n                onInitialized: this._popupButtonInitializedHandler.bind(this)\r\n            }\r\n        }, {\r\n            shortcut: \"cancel\",\r\n            options: {\r\n                onClick: this._cancelButtonHandler.bind(this),\r\n                text: this.option(\"cancelButtonText\"),\r\n                onInitialized: this._popupButtonInitializedHandler.bind(this)\r\n            }\r\n        }];\r\n        return this._applyButtonsLocation(buttonsConfig)\r\n    },\r\n    _applyButtonsLocation: function(buttonsConfig) {\r\n        var buttonsLocation = this.option(\"buttonsLocation\");\r\n        var resultConfig = buttonsConfig;\r\n        if (\"default\" !== buttonsLocation) {\r\n            var position = splitPair(buttonsLocation);\r\n            each(resultConfig, (function(_, element) {\r\n                extend(element, {\r\n                    toolbar: position[0],\r\n                    location: position[1]\r\n                })\r\n            }))\r\n        }\r\n        return resultConfig\r\n    },\r\n    _applyButtonHandler: function() {\r\n        this.close();\r\n        this.option(\"focusStateEnabled\") && this.focus()\r\n    },\r\n    _cancelButtonHandler: function() {\r\n        this.close();\r\n        this.option(\"focusStateEnabled\") && this.focus()\r\n    },\r\n    _popupOptionChanged: function(args) {\r\n        var options = Widget.getOptionsFromContainer(args);\r\n        this._setPopupOption(options);\r\n        var optionsKeys = Object.keys(options);\r\n        if (-1 !== optionsKeys.indexOf(\"width\") || -1 !== optionsKeys.indexOf(\"height\")) {\r\n            this._dimensionChanged()\r\n        }\r\n    },\r\n    _renderSubmitElement: function() {\r\n        if (this.option(\"useHiddenSubmitElement\")) {\r\n            this._$submitElement = $(\"<input>\").attr(\"type\", \"hidden\").appendTo(this.$element())\r\n        }\r\n    },\r\n    _setSubmitValue: function() {\r\n        this._getSubmitElement().val(this.option(\"value\"))\r\n    },\r\n    _getSubmitElement: function() {\r\n        if (this.option(\"useHiddenSubmitElement\")) {\r\n            return this._$submitElement\r\n        } else {\r\n            return this.callBase()\r\n        }\r\n    },\r\n    _dispose: function() {\r\n        this._detachFocusOutEvents();\r\n        this.callBase()\r\n    },\r\n    _optionChanged: function(args) {\r\n        var _this$_popup;\r\n        switch (args.name) {\r\n            case \"width\":\r\n            case \"height\":\r\n                this.callBase(args);\r\n                null === (_this$_popup = this._popup) || void 0 === _this$_popup ? void 0 : _this$_popup.repaint();\r\n                break;\r\n            case \"opened\":\r\n                this._renderOpenedState();\r\n                break;\r\n            case \"onOpened\":\r\n            case \"onClosed\":\r\n                this._initVisibilityActions();\r\n                break;\r\n            case \"onPopupInitialized\":\r\n                this._initPopupInitializedAction();\r\n                break;\r\n            case \"fieldTemplate\":\r\n                if (isDefined(args.value)) {\r\n                    this._renderField()\r\n                } else {\r\n                    this._invalidate()\r\n                }\r\n                break;\r\n            case \"acceptCustomValue\":\r\n            case \"openOnFieldClick\":\r\n                this._invalidate();\r\n                break;\r\n            case \"dropDownButtonTemplate\":\r\n            case \"showDropDownButton\":\r\n                this._updateButtons([\"dropDown\"]);\r\n                break;\r\n            case \"dropDownOptions\":\r\n                this._popupOptionChanged(args);\r\n                this._options.cache(\"dropDownOptions\", this.option(\"dropDownOptions\"));\r\n                break;\r\n            case \"popupPosition\":\r\n                break;\r\n            case \"deferRendering\":\r\n                if (hasWindow()) {\r\n                    this._createPopup()\r\n                }\r\n                break;\r\n            case \"applyValueMode\":\r\n            case \"applyButtonText\":\r\n            case \"cancelButtonText\":\r\n            case \"buttonsLocation\":\r\n                this._setPopupOption(\"toolbarItems\", this._getPopupToolbarItems());\r\n                break;\r\n            case \"useHiddenSubmitElement\":\r\n                if (this._$submitElement) {\r\n                    this._$submitElement.remove();\r\n                    this._$submitElement = void 0\r\n                }\r\n                this._renderSubmitElement();\r\n                break;\r\n            case \"rtlEnabled\":\r\n                this._updatePopupPosition(args.value);\r\n                this.callBase(args);\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    open: function() {\r\n        this.option(\"opened\", true)\r\n    },\r\n    close: function() {\r\n        this.option(\"opened\", false)\r\n    },\r\n    field: function() {\r\n        return getPublicElement(this._input())\r\n    },\r\n    content: function() {\r\n        return this._popup ? this._popup.content() : null\r\n    }\r\n});\r\nregisterComponent(\"dxDropDownEditor\", DropDownEditor);\r\nexport default DropDownEditor;\r\n"]},"metadata":{},"sourceType":"module"}