{"ast":null,"code":"/**\r\n * DevExtreme (esm/viz/chart_components/crosshair.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { patchFontOptions } from \"../core/utils\";\nimport { extend } from \"../../core/utils/extend\";\nvar math = Math;\nvar mathAbs = math.abs;\nvar mathMin = math.min;\nvar mathMax = math.max;\nvar mathFloor = math.floor;\nvar HORIZONTAL = \"horizontal\";\nvar VERTICAL = \"vertical\";\nvar LABEL_BACKGROUND_PADDING_X = 8;\nvar LABEL_BACKGROUND_PADDING_Y = 4;\nvar CENTER = \"center\";\nvar RIGHT = \"right\";\nvar LEFT = \"left\";\nvar TOP = \"top\";\nvar BOTTOM = \"bottom\";\nexport function getMargins() {\n  return {\n    x: LABEL_BACKGROUND_PADDING_X,\n    y: LABEL_BACKGROUND_PADDING_Y\n  };\n}\n\nfunction getRectangleBBox(bBox) {\n  return {\n    x: bBox.x - LABEL_BACKGROUND_PADDING_X,\n    y: bBox.y - LABEL_BACKGROUND_PADDING_Y,\n    width: bBox.width + 2 * LABEL_BACKGROUND_PADDING_X,\n    height: bBox.height + 2 * LABEL_BACKGROUND_PADDING_Y\n  };\n}\n\nfunction getLabelCheckerPosition(x, y, isHorizontal, canvas) {\n  var params = isHorizontal ? [\"x\", \"width\", \"y\", \"height\", y, 0] : [\"y\", \"height\", \"x\", \"width\", x, 1];\n  return function (bBox, position, coord) {\n    var labelCoord = {\n      x: coord.x,\n      y: coord.y\n    };\n    var rectangleBBox = getRectangleBBox(bBox);\n    var delta = isHorizontal ? coord.y - bBox.y - bBox.height / 2 : coord.y - bBox.y;\n    labelCoord.y = isHorizontal || !isHorizontal && position === BOTTOM ? coord.y + delta : coord.y;\n\n    if (rectangleBBox[params[0]] < 0) {\n      labelCoord[params[0]] -= rectangleBBox[params[0]];\n    } else if (rectangleBBox[params[0]] + rectangleBBox[params[1]] + delta * params[5] > canvas[params[1]]) {\n      labelCoord[params[0]] -= rectangleBBox[params[0]] + rectangleBBox[params[1]] + delta * params[5] - canvas[params[1]];\n    }\n\n    if (params[4] - rectangleBBox[params[3]] / 2 < 0) {\n      labelCoord[params[2]] -= params[4] - rectangleBBox[params[3]] / 2;\n    } else if (params[4] + rectangleBBox[params[3]] / 2 > canvas[params[3]]) {\n      labelCoord[params[2]] -= params[4] + rectangleBBox[params[3]] / 2 - canvas[params[3]];\n    }\n\n    return labelCoord;\n  };\n}\n\nexport function Crosshair(renderer, options, params, group) {\n  this._renderer = renderer;\n  this._crosshairGroup = group;\n  this._options = {};\n  this.update(options, params);\n}\nCrosshair.prototype = {\n  constructor: Crosshair,\n  update: function (options, params) {\n    var canvas = params.canvas;\n    this._canvas = {\n      top: canvas.top,\n      bottom: canvas.height - canvas.bottom,\n      left: canvas.left,\n      right: canvas.width - canvas.right,\n      width: canvas.width,\n      height: canvas.height\n    };\n    this._axes = params.axes;\n    this._panes = params.panes;\n\n    this._prepareOptions(options, HORIZONTAL);\n\n    this._prepareOptions(options, VERTICAL);\n  },\n  dispose: function () {\n    this._renderer = this._crosshairGroup = this._options = this._axes = this._canvas = this._horizontalGroup = this._verticalGroup = this._horizontal = this._vertical = this._circle = this._panes = null;\n  },\n  _prepareOptions: function (options, direction) {\n    var lineOptions = options[direction + \"Line\"];\n    this._options[direction] = {\n      visible: lineOptions.visible,\n      line: {\n        stroke: lineOptions.color || options.color,\n        \"stroke-width\": lineOptions.width || options.width,\n        dashStyle: lineOptions.dashStyle || options.dashStyle,\n        opacity: lineOptions.opacity || options.opacity,\n        \"stroke-linecap\": \"butt\"\n      },\n      label: extend(true, {}, options.label, lineOptions.label)\n    };\n  },\n  _createLines: function (options, sharpParam, group) {\n    var lines = [];\n    var canvas = this._canvas;\n    var points = [canvas.left, canvas.top, canvas.left, canvas.top];\n\n    for (var i = 0; i < 2; i++) {\n      lines.push(this._renderer.path(points, \"line\").attr(options).sharp(sharpParam).append(group));\n    }\n\n    return lines;\n  },\n  render: function () {\n    var renderer = this._renderer;\n    var options = this._options;\n    var verticalOptions = options.vertical;\n    var horizontalOptions = options.horizontal;\n    var extraOptions = horizontalOptions.visible ? horizontalOptions.line : verticalOptions.line;\n    var circleOptions = {\n      stroke: extraOptions.stroke,\n      \"stroke-width\": extraOptions[\"stroke-width\"],\n      dashStyle: extraOptions.dashStyle,\n      opacity: extraOptions.opacity\n    };\n    var canvas = this._canvas;\n    this._horizontal = {};\n    this._vertical = {};\n    this._circle = renderer.circle(canvas.left, canvas.top, 0).attr(circleOptions).append(this._crosshairGroup);\n    this._horizontalGroup = renderer.g().append(this._crosshairGroup);\n    this._verticalGroup = renderer.g().append(this._crosshairGroup);\n\n    if (verticalOptions.visible) {\n      this._vertical.lines = this._createLines(verticalOptions.line, \"h\", this._verticalGroup);\n      this._vertical.labels = this._createLabels(this._axes[0], verticalOptions, false, this._verticalGroup);\n    }\n\n    if (horizontalOptions.visible) {\n      this._horizontal.lines = this._createLines(horizontalOptions.line, \"v\", this._horizontalGroup);\n      this._horizontal.labels = this._createLabels(this._axes[1], horizontalOptions, true, this._horizontalGroup);\n    }\n\n    this.hide();\n  },\n  _createLabels: function (axes, options, isHorizontal, group) {\n    var canvas = this._canvas;\n    var renderer = this._renderer;\n    var x;\n    var y;\n    var text;\n    var labels = [];\n    var background;\n    var currentLabelPos;\n    var labelOptions = options.label;\n\n    if (labelOptions.visible) {\n      axes.forEach(function (axis) {\n        var position = axis.getOptions().position;\n\n        if (axis.getTranslator().getBusinessRange().isEmpty()) {\n          return;\n        }\n\n        currentLabelPos = axis.getLabelsPosition();\n\n        if (isHorizontal) {\n          y = canvas.top;\n          x = currentLabelPos;\n        } else {\n          x = canvas.left;\n          y = currentLabelPos;\n        }\n\n        var align = position === TOP || position === BOTTOM ? CENTER : position === RIGHT ? LEFT : RIGHT;\n        background = renderer.rect(0, 0, 0, 0).attr({\n          fill: labelOptions.backgroundColor || options.line.stroke\n        }).append(group);\n        text = renderer.text(\"0\", 0, 0).css(patchFontOptions(options.label.font)).attr({\n          align: align,\n          class: labelOptions.cssClass\n        }).append(group);\n        labels.push({\n          text: text,\n          background: background,\n          axis: axis,\n          options: labelOptions,\n          pos: {\n            coord: currentLabelPos,\n            side: position\n          },\n          startXY: {\n            x: x,\n            y: y\n          }\n        });\n      });\n    }\n\n    return labels;\n  },\n  _updateText: function (value, axisName, labels, point, func) {\n    var that = this;\n    labels.forEach(function (label) {\n      var axis = label.axis;\n      var coord = label.startXY;\n      var textElement = label.text;\n      var backgroundElement = label.background;\n      var text = \"\";\n\n      if (!axis.name || axis.name === axisName) {\n        text = axis.getFormattedValue(value, label.options, point);\n      }\n\n      if (text) {\n        textElement.attr({\n          text: text,\n          x: coord.x,\n          y: coord.y\n        });\n        textElement.attr(func(textElement.getBBox(), label.pos.side, coord));\n\n        that._updateLinesCanvas(label);\n\n        backgroundElement.attr(getRectangleBBox(textElement.getBBox()));\n      } else {\n        textElement.attr({\n          text: \"\"\n        });\n        backgroundElement.attr({\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0\n        });\n      }\n    });\n  },\n  hide: function () {\n    this._crosshairGroup.attr({\n      visibility: \"hidden\"\n    });\n  },\n  _updateLinesCanvas: function (label) {\n    var position = label.pos.side;\n    var labelCoord = label.pos.coord;\n    var coords = this._linesCanvas;\n    var canvas = this._canvas;\n    coords[position] = coords[position] !== canvas[position] && mathAbs(coords[position] - canvas[position]) < mathAbs(labelCoord - canvas[position]) ? coords[position] : labelCoord;\n  },\n  _updateLines: function (lines, x, y, r, isHorizontal) {\n    var coords = this._linesCanvas;\n    var canvas = this._canvas;\n    var points = isHorizontal ? [[mathMin(x - r, coords.left), canvas.top, x - r, canvas.top], [x + r, canvas.top, mathMax(coords.right, x + r), canvas.top]] : [[canvas.left, mathMin(coords.top, y - r), canvas.left, y - r], [canvas.left, y + r, canvas.left, mathMax(coords.bottom, y + r)]];\n\n    for (var i = 0; i < 2; i++) {\n      lines[i].attr({\n        points: points[i]\n      }).sharp(isHorizontal ? \"v\" : \"h\", isHorizontal ? y === canvas.bottom ? -1 : 1 : x === canvas.right ? -1 : 1);\n    }\n  },\n  _resetLinesCanvas: function () {\n    var canvas = this._canvas;\n    this._linesCanvas = {\n      left: canvas.left,\n      right: canvas.right,\n      top: canvas.top,\n      bottom: canvas.bottom\n    };\n  },\n  _getClipRectForPane: function (x, y) {\n    var panes = this._panes;\n    var i;\n    var coords;\n\n    for (i = 0; i < panes.length; i++) {\n      coords = panes[i].coords;\n\n      if (coords.left <= x && coords.right >= x && coords.top <= y && coords.bottom >= y) {\n        return panes[i].clipRect;\n      }\n    }\n\n    return {\n      id: null\n    };\n  },\n  show: function (data) {\n    var point = data.point;\n    var pointData = point.getCrosshairData(data.x, data.y);\n    var r = point.getPointRadius();\n    var horizontal = this._horizontal;\n    var vertical = this._vertical;\n    var rad = !r ? 0 : r + 3;\n    var canvas = this._canvas;\n    var x = mathFloor(pointData.x);\n    var y = mathFloor(pointData.y);\n\n    if (x >= canvas.left && x <= canvas.right && y >= canvas.top && y <= canvas.bottom) {\n      this._crosshairGroup.attr({\n        visibility: \"visible\"\n      });\n\n      this._resetLinesCanvas();\n\n      this._circle.attr({\n        cx: x,\n        cy: y,\n        r: rad,\n        \"clip-path\": this._getClipRectForPane(x, y).id\n      });\n\n      if (horizontal.lines) {\n        this._updateText(pointData.yValue, pointData.axis, horizontal.labels, point, getLabelCheckerPosition(x, y, true, canvas));\n\n        this._updateLines(horizontal.lines, x, y, rad, true);\n\n        this._horizontalGroup.attr({\n          translateY: y - canvas.top\n        });\n      }\n\n      if (vertical.lines) {\n        this._updateText(pointData.xValue, pointData.axis, vertical.labels, point, getLabelCheckerPosition(x, y, false, canvas));\n\n        this._updateLines(vertical.lines, x, y, rad, false);\n\n        this._verticalGroup.attr({\n          translateX: x - canvas.left\n        });\n      }\n    } else {\n      this.hide();\n    }\n  }\n};","map":{"version":3,"sources":["/Users/rahulsharma/node_modules/devextreme/esm/viz/chart_components/crosshair.js"],"names":["patchFontOptions","extend","math","Math","mathAbs","abs","mathMin","min","mathMax","max","mathFloor","floor","HORIZONTAL","VERTICAL","LABEL_BACKGROUND_PADDING_X","LABEL_BACKGROUND_PADDING_Y","CENTER","RIGHT","LEFT","TOP","BOTTOM","getMargins","x","y","getRectangleBBox","bBox","width","height","getLabelCheckerPosition","isHorizontal","canvas","params","position","coord","labelCoord","rectangleBBox","delta","Crosshair","renderer","options","group","_renderer","_crosshairGroup","_options","update","prototype","constructor","_canvas","top","bottom","left","right","_axes","axes","_panes","panes","_prepareOptions","dispose","_horizontalGroup","_verticalGroup","_horizontal","_vertical","_circle","direction","lineOptions","visible","line","stroke","color","dashStyle","opacity","label","_createLines","sharpParam","lines","points","i","push","path","attr","sharp","append","render","verticalOptions","vertical","horizontalOptions","horizontal","extraOptions","circleOptions","circle","g","labels","_createLabels","hide","text","background","currentLabelPos","labelOptions","forEach","axis","getOptions","getTranslator","getBusinessRange","isEmpty","getLabelsPosition","align","rect","fill","backgroundColor","css","font","class","cssClass","pos","side","startXY","_updateText","value","axisName","point","func","that","textElement","backgroundElement","name","getFormattedValue","getBBox","_updateLinesCanvas","visibility","coords","_linesCanvas","_updateLines","r","_resetLinesCanvas","_getClipRectForPane","length","clipRect","id","show","data","pointData","getCrosshairData","getPointRadius","rad","cx","cy","yValue","translateY","xValue","translateX"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/viz/chart_components/crosshair.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    patchFontOptions\r\n} from \"../core/utils\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nvar math = Math;\r\nvar mathAbs = math.abs;\r\nvar mathMin = math.min;\r\nvar mathMax = math.max;\r\nvar mathFloor = math.floor;\r\nvar HORIZONTAL = \"horizontal\";\r\nvar VERTICAL = \"vertical\";\r\nvar LABEL_BACKGROUND_PADDING_X = 8;\r\nvar LABEL_BACKGROUND_PADDING_Y = 4;\r\nvar CENTER = \"center\";\r\nvar RIGHT = \"right\";\r\nvar LEFT = \"left\";\r\nvar TOP = \"top\";\r\nvar BOTTOM = \"bottom\";\r\nexport function getMargins() {\r\n    return {\r\n        x: LABEL_BACKGROUND_PADDING_X,\r\n        y: LABEL_BACKGROUND_PADDING_Y\r\n    }\r\n}\r\n\r\nfunction getRectangleBBox(bBox) {\r\n    return {\r\n        x: bBox.x - LABEL_BACKGROUND_PADDING_X,\r\n        y: bBox.y - LABEL_BACKGROUND_PADDING_Y,\r\n        width: bBox.width + 2 * LABEL_BACKGROUND_PADDING_X,\r\n        height: bBox.height + 2 * LABEL_BACKGROUND_PADDING_Y\r\n    }\r\n}\r\n\r\nfunction getLabelCheckerPosition(x, y, isHorizontal, canvas) {\r\n    var params = isHorizontal ? [\"x\", \"width\", \"y\", \"height\", y, 0] : [\"y\", \"height\", \"x\", \"width\", x, 1];\r\n    return function(bBox, position, coord) {\r\n        var labelCoord = {\r\n            x: coord.x,\r\n            y: coord.y\r\n        };\r\n        var rectangleBBox = getRectangleBBox(bBox);\r\n        var delta = isHorizontal ? coord.y - bBox.y - bBox.height / 2 : coord.y - bBox.y;\r\n        labelCoord.y = isHorizontal || !isHorizontal && position === BOTTOM ? coord.y + delta : coord.y;\r\n        if (rectangleBBox[params[0]] < 0) {\r\n            labelCoord[params[0]] -= rectangleBBox[params[0]]\r\n        } else if (rectangleBBox[params[0]] + rectangleBBox[params[1]] + delta * params[5] > canvas[params[1]]) {\r\n            labelCoord[params[0]] -= rectangleBBox[params[0]] + rectangleBBox[params[1]] + delta * params[5] - canvas[params[1]]\r\n        }\r\n        if (params[4] - rectangleBBox[params[3]] / 2 < 0) {\r\n            labelCoord[params[2]] -= params[4] - rectangleBBox[params[3]] / 2\r\n        } else if (params[4] + rectangleBBox[params[3]] / 2 > canvas[params[3]]) {\r\n            labelCoord[params[2]] -= params[4] + rectangleBBox[params[3]] / 2 - canvas[params[3]]\r\n        }\r\n        return labelCoord\r\n    }\r\n}\r\nexport function Crosshair(renderer, options, params, group) {\r\n    this._renderer = renderer;\r\n    this._crosshairGroup = group;\r\n    this._options = {};\r\n    this.update(options, params)\r\n}\r\nCrosshair.prototype = {\r\n    constructor: Crosshair,\r\n    update: function(options, params) {\r\n        var canvas = params.canvas;\r\n        this._canvas = {\r\n            top: canvas.top,\r\n            bottom: canvas.height - canvas.bottom,\r\n            left: canvas.left,\r\n            right: canvas.width - canvas.right,\r\n            width: canvas.width,\r\n            height: canvas.height\r\n        };\r\n        this._axes = params.axes;\r\n        this._panes = params.panes;\r\n        this._prepareOptions(options, HORIZONTAL);\r\n        this._prepareOptions(options, VERTICAL)\r\n    },\r\n    dispose: function() {\r\n        this._renderer = this._crosshairGroup = this._options = this._axes = this._canvas = this._horizontalGroup = this._verticalGroup = this._horizontal = this._vertical = this._circle = this._panes = null\r\n    },\r\n    _prepareOptions: function(options, direction) {\r\n        var lineOptions = options[direction + \"Line\"];\r\n        this._options[direction] = {\r\n            visible: lineOptions.visible,\r\n            line: {\r\n                stroke: lineOptions.color || options.color,\r\n                \"stroke-width\": lineOptions.width || options.width,\r\n                dashStyle: lineOptions.dashStyle || options.dashStyle,\r\n                opacity: lineOptions.opacity || options.opacity,\r\n                \"stroke-linecap\": \"butt\"\r\n            },\r\n            label: extend(true, {}, options.label, lineOptions.label)\r\n        }\r\n    },\r\n    _createLines: function(options, sharpParam, group) {\r\n        var lines = [];\r\n        var canvas = this._canvas;\r\n        var points = [canvas.left, canvas.top, canvas.left, canvas.top];\r\n        for (var i = 0; i < 2; i++) {\r\n            lines.push(this._renderer.path(points, \"line\").attr(options).sharp(sharpParam).append(group))\r\n        }\r\n        return lines\r\n    },\r\n    render: function() {\r\n        var renderer = this._renderer;\r\n        var options = this._options;\r\n        var verticalOptions = options.vertical;\r\n        var horizontalOptions = options.horizontal;\r\n        var extraOptions = horizontalOptions.visible ? horizontalOptions.line : verticalOptions.line;\r\n        var circleOptions = {\r\n            stroke: extraOptions.stroke,\r\n            \"stroke-width\": extraOptions[\"stroke-width\"],\r\n            dashStyle: extraOptions.dashStyle,\r\n            opacity: extraOptions.opacity\r\n        };\r\n        var canvas = this._canvas;\r\n        this._horizontal = {};\r\n        this._vertical = {};\r\n        this._circle = renderer.circle(canvas.left, canvas.top, 0).attr(circleOptions).append(this._crosshairGroup);\r\n        this._horizontalGroup = renderer.g().append(this._crosshairGroup);\r\n        this._verticalGroup = renderer.g().append(this._crosshairGroup);\r\n        if (verticalOptions.visible) {\r\n            this._vertical.lines = this._createLines(verticalOptions.line, \"h\", this._verticalGroup);\r\n            this._vertical.labels = this._createLabels(this._axes[0], verticalOptions, false, this._verticalGroup)\r\n        }\r\n        if (horizontalOptions.visible) {\r\n            this._horizontal.lines = this._createLines(horizontalOptions.line, \"v\", this._horizontalGroup);\r\n            this._horizontal.labels = this._createLabels(this._axes[1], horizontalOptions, true, this._horizontalGroup)\r\n        }\r\n        this.hide()\r\n    },\r\n    _createLabels: function(axes, options, isHorizontal, group) {\r\n        var canvas = this._canvas;\r\n        var renderer = this._renderer;\r\n        var x;\r\n        var y;\r\n        var text;\r\n        var labels = [];\r\n        var background;\r\n        var currentLabelPos;\r\n        var labelOptions = options.label;\r\n        if (labelOptions.visible) {\r\n            axes.forEach((function(axis) {\r\n                var position = axis.getOptions().position;\r\n                if (axis.getTranslator().getBusinessRange().isEmpty()) {\r\n                    return\r\n                }\r\n                currentLabelPos = axis.getLabelsPosition();\r\n                if (isHorizontal) {\r\n                    y = canvas.top;\r\n                    x = currentLabelPos\r\n                } else {\r\n                    x = canvas.left;\r\n                    y = currentLabelPos\r\n                }\r\n                var align = position === TOP || position === BOTTOM ? CENTER : position === RIGHT ? LEFT : RIGHT;\r\n                background = renderer.rect(0, 0, 0, 0).attr({\r\n                    fill: labelOptions.backgroundColor || options.line.stroke\r\n                }).append(group);\r\n                text = renderer.text(\"0\", 0, 0).css(patchFontOptions(options.label.font)).attr({\r\n                    align: align,\r\n                    class: labelOptions.cssClass\r\n                }).append(group);\r\n                labels.push({\r\n                    text: text,\r\n                    background: background,\r\n                    axis: axis,\r\n                    options: labelOptions,\r\n                    pos: {\r\n                        coord: currentLabelPos,\r\n                        side: position\r\n                    },\r\n                    startXY: {\r\n                        x: x,\r\n                        y: y\r\n                    }\r\n                })\r\n            }))\r\n        }\r\n        return labels\r\n    },\r\n    _updateText: function(value, axisName, labels, point, func) {\r\n        var that = this;\r\n        labels.forEach((function(label) {\r\n            var axis = label.axis;\r\n            var coord = label.startXY;\r\n            var textElement = label.text;\r\n            var backgroundElement = label.background;\r\n            var text = \"\";\r\n            if (!axis.name || axis.name === axisName) {\r\n                text = axis.getFormattedValue(value, label.options, point)\r\n            }\r\n            if (text) {\r\n                textElement.attr({\r\n                    text: text,\r\n                    x: coord.x,\r\n                    y: coord.y\r\n                });\r\n                textElement.attr(func(textElement.getBBox(), label.pos.side, coord));\r\n                that._updateLinesCanvas(label);\r\n                backgroundElement.attr(getRectangleBBox(textElement.getBBox()))\r\n            } else {\r\n                textElement.attr({\r\n                    text: \"\"\r\n                });\r\n                backgroundElement.attr({\r\n                    x: 0,\r\n                    y: 0,\r\n                    width: 0,\r\n                    height: 0\r\n                })\r\n            }\r\n        }))\r\n    },\r\n    hide: function() {\r\n        this._crosshairGroup.attr({\r\n            visibility: \"hidden\"\r\n        })\r\n    },\r\n    _updateLinesCanvas: function(label) {\r\n        var position = label.pos.side;\r\n        var labelCoord = label.pos.coord;\r\n        var coords = this._linesCanvas;\r\n        var canvas = this._canvas;\r\n        coords[position] = coords[position] !== canvas[position] && mathAbs(coords[position] - canvas[position]) < mathAbs(labelCoord - canvas[position]) ? coords[position] : labelCoord\r\n    },\r\n    _updateLines: function(lines, x, y, r, isHorizontal) {\r\n        var coords = this._linesCanvas;\r\n        var canvas = this._canvas;\r\n        var points = isHorizontal ? [\r\n            [mathMin(x - r, coords.left), canvas.top, x - r, canvas.top],\r\n            [x + r, canvas.top, mathMax(coords.right, x + r), canvas.top]\r\n        ] : [\r\n            [canvas.left, mathMin(coords.top, y - r), canvas.left, y - r],\r\n            [canvas.left, y + r, canvas.left, mathMax(coords.bottom, y + r)]\r\n        ];\r\n        for (var i = 0; i < 2; i++) {\r\n            lines[i].attr({\r\n                points: points[i]\r\n            }).sharp(isHorizontal ? \"v\" : \"h\", isHorizontal ? y === canvas.bottom ? -1 : 1 : x === canvas.right ? -1 : 1)\r\n        }\r\n    },\r\n    _resetLinesCanvas: function() {\r\n        var canvas = this._canvas;\r\n        this._linesCanvas = {\r\n            left: canvas.left,\r\n            right: canvas.right,\r\n            top: canvas.top,\r\n            bottom: canvas.bottom\r\n        }\r\n    },\r\n    _getClipRectForPane: function(x, y) {\r\n        var panes = this._panes;\r\n        var i;\r\n        var coords;\r\n        for (i = 0; i < panes.length; i++) {\r\n            coords = panes[i].coords;\r\n            if (coords.left <= x && coords.right >= x && coords.top <= y && coords.bottom >= y) {\r\n                return panes[i].clipRect\r\n            }\r\n        }\r\n        return {\r\n            id: null\r\n        }\r\n    },\r\n    show: function(data) {\r\n        var point = data.point;\r\n        var pointData = point.getCrosshairData(data.x, data.y);\r\n        var r = point.getPointRadius();\r\n        var horizontal = this._horizontal;\r\n        var vertical = this._vertical;\r\n        var rad = !r ? 0 : r + 3;\r\n        var canvas = this._canvas;\r\n        var x = mathFloor(pointData.x);\r\n        var y = mathFloor(pointData.y);\r\n        if (x >= canvas.left && x <= canvas.right && y >= canvas.top && y <= canvas.bottom) {\r\n            this._crosshairGroup.attr({\r\n                visibility: \"visible\"\r\n            });\r\n            this._resetLinesCanvas();\r\n            this._circle.attr({\r\n                cx: x,\r\n                cy: y,\r\n                r: rad,\r\n                \"clip-path\": this._getClipRectForPane(x, y).id\r\n            });\r\n            if (horizontal.lines) {\r\n                this._updateText(pointData.yValue, pointData.axis, horizontal.labels, point, getLabelCheckerPosition(x, y, true, canvas));\r\n                this._updateLines(horizontal.lines, x, y, rad, true);\r\n                this._horizontalGroup.attr({\r\n                    translateY: y - canvas.top\r\n                })\r\n            }\r\n            if (vertical.lines) {\r\n                this._updateText(pointData.xValue, pointData.axis, vertical.labels, point, getLabelCheckerPosition(x, y, false, canvas));\r\n                this._updateLines(vertical.lines, x, y, rad, false);\r\n                this._verticalGroup.attr({\r\n                    translateX: x - canvas.left\r\n                })\r\n            }\r\n        } else {\r\n            this.hide()\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}