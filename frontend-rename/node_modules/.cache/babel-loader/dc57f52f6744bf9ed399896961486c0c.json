{"ast":null,"code":"/**\r\n * DevExtreme (esm/core/utils/selection_filter.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getKeyHash, equalByValue } from \"./common\";\nimport { isString, isObject } from \"./type\";\nexport var SelectionFilterCreator = function (selectedItemKeys, isSelectAll) {\n  this.getLocalFilter = function (keyGetter, equalKeys, equalByReference, keyExpr) {\n    equalKeys = void 0 === equalKeys ? equalByValue : equalKeys;\n    return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr);\n  };\n\n  this.getExpr = function (keyExpr) {\n    if (!keyExpr) {\n      return;\n    }\n\n    var filterExpr;\n    selectedItemKeys.forEach(function (key, index) {\n      filterExpr = filterExpr || [];\n      var filterExprPart;\n\n      if (index > 0) {\n        filterExpr.push(isSelectAll ? \"and\" : \"or\");\n      }\n\n      if (isString(keyExpr)) {\n        filterExprPart = getFilterForPlainKey(keyExpr, key);\n      } else {\n        filterExprPart = function (keyExpr, itemKeyValue) {\n          var filterExpr = [];\n\n          for (var i = 0, length = keyExpr.length; i < length; i++) {\n            var currentKeyExpr = keyExpr[i];\n            var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\n            var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\n\n            if (!filterExprPart) {\n              break;\n            }\n\n            if (i > 0) {\n              filterExpr.push(isSelectAll ? \"or\" : \"and\");\n            }\n\n            filterExpr.push(filterExprPart);\n          }\n\n          return filterExpr;\n        }(keyExpr, key);\n      }\n\n      filterExpr.push(filterExprPart);\n    });\n\n    if (filterExpr && 1 === filterExpr.length) {\n      filterExpr = filterExpr[0];\n    }\n\n    return filterExpr;\n  };\n\n  this.getCombinedFilter = function (keyExpr, dataSourceFilter) {\n    var filterExpr = this.getExpr(keyExpr);\n    var combinedFilter = filterExpr;\n\n    if (isSelectAll && dataSourceFilter) {\n      if (filterExpr) {\n        combinedFilter = [];\n        combinedFilter.push(filterExpr);\n        combinedFilter.push(dataSourceFilter);\n      } else {\n        combinedFilter = dataSourceFilter;\n      }\n    }\n\n    return combinedFilter;\n  };\n\n  var selectedItemKeyHashesMap;\n\n  function functionFilter(equalKeys, keyOf, equalByReference, keyExpr, item) {\n    var key = keyOf(item);\n    var keyHash;\n    var i;\n\n    if (!equalByReference) {\n      keyHash = getKeyHash(key);\n\n      if (!isObject(keyHash)) {\n        var selectedKeyHashesMap = function (selectedItemKeys) {\n          if (!selectedItemKeyHashesMap) {\n            selectedItemKeyHashesMap = {};\n\n            for (var i = 0; i < selectedItemKeys.length; i++) {\n              selectedItemKeyHashesMap[getKeyHash(selectedItemKeys[i])] = true;\n            }\n          }\n\n          return selectedItemKeyHashesMap;\n        }(function (keys, keyOf, keyExpr) {\n          return Array.isArray(keyExpr) ? keys.map(key => keyOf(key)) : keys;\n        }(selectedItemKeys, keyOf, keyExpr));\n\n        if (selectedKeyHashesMap[keyHash]) {\n          return !isSelectAll;\n        }\n\n        return !!isSelectAll;\n      }\n    }\n\n    for (i = 0; i < selectedItemKeys.length; i++) {\n      if (equalKeys(selectedItemKeys[i], key)) {\n        return !isSelectAll;\n      }\n    }\n\n    return !!isSelectAll;\n  }\n\n  function getFilterForPlainKey(keyExpr, keyValue) {\n    if (void 0 === keyValue) {\n      return;\n    }\n\n    return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue];\n  }\n};","map":{"version":3,"sources":["/Users/rahulsharma/node_modules/devextreme/esm/core/utils/selection_filter.js"],"names":["getKeyHash","equalByValue","isString","isObject","SelectionFilterCreator","selectedItemKeys","isSelectAll","getLocalFilter","keyGetter","equalKeys","equalByReference","keyExpr","functionFilter","bind","getExpr","filterExpr","forEach","key","index","filterExprPart","push","getFilterForPlainKey","itemKeyValue","i","length","currentKeyExpr","currentKeyValue","getCombinedFilter","dataSourceFilter","combinedFilter","selectedItemKeyHashesMap","keyOf","item","keyHash","selectedKeyHashesMap","keys","Array","isArray","map","keyValue"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/core/utils/selection_filter.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getKeyHash,\r\n    equalByValue\r\n} from \"./common\";\r\nimport {\r\n    isString,\r\n    isObject\r\n} from \"./type\";\r\nexport var SelectionFilterCreator = function(selectedItemKeys, isSelectAll) {\r\n    this.getLocalFilter = function(keyGetter, equalKeys, equalByReference, keyExpr) {\r\n        equalKeys = void 0 === equalKeys ? equalByValue : equalKeys;\r\n        return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr)\r\n    };\r\n    this.getExpr = function(keyExpr) {\r\n        if (!keyExpr) {\r\n            return\r\n        }\r\n        var filterExpr;\r\n        selectedItemKeys.forEach((function(key, index) {\r\n            filterExpr = filterExpr || [];\r\n            var filterExprPart;\r\n            if (index > 0) {\r\n                filterExpr.push(isSelectAll ? \"and\" : \"or\")\r\n            }\r\n            if (isString(keyExpr)) {\r\n                filterExprPart = getFilterForPlainKey(keyExpr, key)\r\n            } else {\r\n                filterExprPart = function(keyExpr, itemKeyValue) {\r\n                    var filterExpr = [];\r\n                    for (var i = 0, length = keyExpr.length; i < length; i++) {\r\n                        var currentKeyExpr = keyExpr[i];\r\n                        var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\r\n                        var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\r\n                        if (!filterExprPart) {\r\n                            break\r\n                        }\r\n                        if (i > 0) {\r\n                            filterExpr.push(isSelectAll ? \"or\" : \"and\")\r\n                        }\r\n                        filterExpr.push(filterExprPart)\r\n                    }\r\n                    return filterExpr\r\n                }(keyExpr, key)\r\n            }\r\n            filterExpr.push(filterExprPart)\r\n        }));\r\n        if (filterExpr && 1 === filterExpr.length) {\r\n            filterExpr = filterExpr[0]\r\n        }\r\n        return filterExpr\r\n    };\r\n    this.getCombinedFilter = function(keyExpr, dataSourceFilter) {\r\n        var filterExpr = this.getExpr(keyExpr);\r\n        var combinedFilter = filterExpr;\r\n        if (isSelectAll && dataSourceFilter) {\r\n            if (filterExpr) {\r\n                combinedFilter = [];\r\n                combinedFilter.push(filterExpr);\r\n                combinedFilter.push(dataSourceFilter)\r\n            } else {\r\n                combinedFilter = dataSourceFilter\r\n            }\r\n        }\r\n        return combinedFilter\r\n    };\r\n    var selectedItemKeyHashesMap;\r\n\r\n    function functionFilter(equalKeys, keyOf, equalByReference, keyExpr, item) {\r\n        var key = keyOf(item);\r\n        var keyHash;\r\n        var i;\r\n        if (!equalByReference) {\r\n            keyHash = getKeyHash(key);\r\n            if (!isObject(keyHash)) {\r\n                var selectedKeyHashesMap = function(selectedItemKeys) {\r\n                    if (!selectedItemKeyHashesMap) {\r\n                        selectedItemKeyHashesMap = {};\r\n                        for (var i = 0; i < selectedItemKeys.length; i++) {\r\n                            selectedItemKeyHashesMap[getKeyHash(selectedItemKeys[i])] = true\r\n                        }\r\n                    }\r\n                    return selectedItemKeyHashesMap\r\n                }(function(keys, keyOf, keyExpr) {\r\n                    return Array.isArray(keyExpr) ? keys.map(key => keyOf(key)) : keys\r\n                }(selectedItemKeys, keyOf, keyExpr));\r\n                if (selectedKeyHashesMap[keyHash]) {\r\n                    return !isSelectAll\r\n                }\r\n                return !!isSelectAll\r\n            }\r\n        }\r\n        for (i = 0; i < selectedItemKeys.length; i++) {\r\n            if (equalKeys(selectedItemKeys[i], key)) {\r\n                return !isSelectAll\r\n            }\r\n        }\r\n        return !!isSelectAll\r\n    }\r\n\r\n    function getFilterForPlainKey(keyExpr, keyValue) {\r\n        if (void 0 === keyValue) {\r\n            return\r\n        }\r\n        return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue]\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}