{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/grid_core/ui.grid_core.grid_view.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getOuterWidth, getInnerWidth, getWidth, getHeight, setHeight } from \"../../core/utils/size\";\nimport $ from \"../../core/renderer\";\nimport modules from \"./ui.grid_core.modules\";\nimport { deferRender, deferUpdate } from \"../../core/utils/common\";\nimport { hasWindow, getWindow } from \"../../core/utils/window\";\nimport { each } from \"../../core/utils/iterator\";\nimport { isString, isDefined, isNumeric } from \"../../core/utils/type\";\nimport { getBoundingRect } from \"../../core/utils/position\";\nimport gridCoreUtils from \"./ui.grid_core.utils\";\nimport messageLocalization from \"../../localization/message\";\nimport { when, Deferred } from \"../../core/utils/deferred\";\nimport domAdapter from \"../../core/dom_adapter\";\nimport * as accessibility from \"../shared/accessibility\";\nvar BORDERS_CLASS = \"borders\";\nvar TABLE_FIXED_CLASS = \"table-fixed\";\nvar IMPORTANT_MARGIN_CLASS = \"important-margin\";\nvar GRIDBASE_CONTAINER_CLASS = \"dx-gridbase-container\";\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\nvar VIEW_NAMES = [\"columnsSeparatorView\", \"blockSeparatorView\", \"trackerView\", \"headerPanel\", \"columnHeadersView\", \"rowsView\", \"footerView\", \"columnChooserView\", \"filterPanelView\", \"pagerView\", \"draggingHeaderView\", \"contextMenuView\", \"errorView\", \"headerFilterView\", \"filterBuilderView\"];\n\nvar isPercentWidth = function (width) {\n  return isString(width) && \"%\" === width.slice(-1);\n};\n\nvar isPixelWidth = function (width) {\n  return isString(width) && \"px\" === width.slice(-2);\n};\n\nvar getContainerHeight = function ($container) {\n  var clientHeight = $container.get(0).clientHeight;\n  var paddingTop = parseFloat($container.css(\"paddingTop\"));\n  var paddingBottom = parseFloat($container.css(\"paddingBottom\"));\n  return clientHeight - paddingTop - paddingBottom;\n};\n\nvar calculateFreeWidth = function (that, widths) {\n  var contentWidth = that._rowsView.contentWidth();\n\n  var totalWidth = that._getTotalWidth(widths, contentWidth);\n\n  return contentWidth - totalWidth;\n};\n\nvar calculateFreeWidthWithCurrentMinWidth = function (that, columnIndex, currentMinWidth, widths) {\n  return calculateFreeWidth(that, widths.map(function (width, index) {\n    return index === columnIndex ? currentMinWidth : width;\n  }));\n};\n\nvar restoreFocus = function (focusedElement, selectionRange) {\n  accessibility.hiddenFocus(focusedElement);\n  gridCoreUtils.setSelectionRange(focusedElement, selectionRange);\n};\n\nvar ResizingController = modules.ViewController.inherit({\n  _initPostRenderHandlers: function () {\n    var dataController = this._dataController;\n\n    if (!this._refreshSizesHandler) {\n      this._refreshSizesHandler = e => {\n        dataController.changed.remove(this._refreshSizesHandler);\n        var templateDeferreds = e && e.templateDeferreds || [];\n        when.apply(this, templateDeferreds).done(() => {\n          this._refreshSizes(e);\n        });\n      };\n\n      dataController.changed.add(() => {\n        dataController.changed.add(this._refreshSizesHandler);\n      });\n    }\n  },\n  _refreshSizes: function (e) {\n    var resizeDeferred;\n    var that = this;\n    var changeType = e && e.changeType;\n    var isDelayed = e && e.isDelayed;\n\n    var items = that._dataController.items();\n\n    if (!e || \"refresh\" === changeType || \"prepend\" === changeType || \"append\" === changeType) {\n      if (!isDelayed) {\n        resizeDeferred = that.resize();\n      }\n    } else if (\"update\" === changeType) {\n      var _e$changeTypes;\n\n      if (0 === (null === (_e$changeTypes = e.changeTypes) || void 0 === _e$changeTypes ? void 0 : _e$changeTypes.length)) {\n        return;\n      }\n\n      if ((items.length > 1 || \"insert\" !== e.changeTypes[0]) && !(0 === items.length && \"remove\" === e.changeTypes[0]) && !e.needUpdateDimensions) {\n        deferUpdate(() => deferRender(() => deferUpdate(() => {\n          that._setScrollerSpacing(that._hasHeight);\n\n          that._rowsView.resize();\n        })));\n      } else {\n        resizeDeferred = that.resize();\n      }\n    }\n\n    if (changeType && \"updateSelection\" !== changeType && \"updateFocusedRow\" !== changeType && \"pageIndex\" !== changeType && !isDelayed) {\n      when(resizeDeferred).done(function () {\n        that._setAriaRowColCount();\n\n        that.fireContentReadyAction();\n      });\n    }\n  },\n  fireContentReadyAction: function () {\n    this.component._fireContentReadyAction();\n  },\n  _setAriaRowColCount: function () {\n    var component = this.component;\n    component.setAria({\n      rowCount: this._dataController.totalItemsCount(),\n      colCount: component.columnCount()\n    }, component.$element().children(\".\" + GRIDBASE_CONTAINER_CLASS));\n  },\n  _getBestFitWidths: function () {\n    var _widths;\n\n    var rowsView = this._rowsView;\n    var columnHeadersView = this._columnHeadersView;\n    var widths = rowsView.getColumnWidths();\n\n    if (!(null !== (_widths = widths) && void 0 !== _widths && _widths.length)) {\n      var _rowsView$getTableEle;\n\n      var headersTableElement = columnHeadersView.getTableElement();\n      columnHeadersView.setTableElement(null === (_rowsView$getTableEle = rowsView.getTableElement()) || void 0 === _rowsView$getTableEle ? void 0 : _rowsView$getTableEle.children(\".dx-header\"));\n      widths = columnHeadersView.getColumnWidths();\n      columnHeadersView.setTableElement(headersTableElement);\n    }\n\n    return widths;\n  },\n  _setVisibleWidths: function (visibleColumns, widths) {\n    var columnsController = this._columnsController;\n    columnsController.beginUpdate();\n    each(visibleColumns, function (index, column) {\n      var columnId = columnsController.getColumnId(column);\n      columnsController.columnOption(columnId, \"visibleWidth\", widths[index]);\n    });\n    columnsController.endUpdate();\n  },\n  _toggleBestFitModeForView: function (view, className, isBestFit) {\n    if (!view || !view.isVisible()) {\n      return;\n    }\n\n    var $rowsTables = this._rowsView.getTableElements();\n\n    var $viewTables = view.getTableElements();\n    each($rowsTables, (index, tableElement) => {\n      var $tableBody;\n      var $rowsTable = $(tableElement);\n      var $viewTable = $viewTables.eq(index);\n\n      if ($viewTable && $viewTable.length) {\n        if (isBestFit) {\n          $tableBody = $viewTable.children(\"tbody\").appendTo($rowsTable);\n        } else {\n          $tableBody = $rowsTable.children(\".\" + className).appendTo($viewTable);\n        }\n\n        $tableBody.toggleClass(className, isBestFit);\n        $tableBody.toggleClass(this.addWidgetPrefix(\"best-fit\"), isBestFit);\n      }\n    });\n  },\n  _toggleBestFitMode: function (isBestFit) {\n    var $rowsTable = this._rowsView.getTableElement();\n\n    var $rowsFixedTable = this._rowsView.getTableElements().eq(1);\n\n    if (!$rowsTable) {\n      return;\n    }\n\n    $rowsTable.css(\"tableLayout\", isBestFit ? \"auto\" : \"fixed\");\n    $rowsTable.children(\"colgroup\").css(\"display\", isBestFit ? \"none\" : \"\");\n    $rowsFixedTable.toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\n\n    this._toggleBestFitModeForView(this._columnHeadersView, \"dx-header\", isBestFit);\n\n    this._toggleBestFitModeForView(this._footerView, \"dx-footer\", isBestFit);\n\n    if (this._needStretch()) {\n      $rowsTable.get(0).style.width = isBestFit ? \"auto\" : \"\";\n    }\n  },\n  _synchronizeColumns: function () {\n    var columnsController = this._columnsController;\n    var visibleColumns = columnsController.getVisibleColumns();\n    var columnAutoWidth = this.option(\"columnAutoWidth\");\n\n    var needBestFit = this._needBestFit();\n\n    var hasMinWidth = false;\n    var resetBestFitMode;\n    var isColumnWidthsCorrected = false;\n    var resultWidths = [];\n    var focusedElement;\n    var selectionRange;\n    !needBestFit && each(visibleColumns, function (index, column) {\n      if (\"auto\" === column.width) {\n        needBestFit = true;\n        return false;\n      }\n    });\n    each(visibleColumns, function (index, column) {\n      if (column.minWidth) {\n        hasMinWidth = true;\n        return false;\n      }\n    });\n\n    this._setVisibleWidths(visibleColumns, []);\n\n    if (needBestFit) {\n      focusedElement = domAdapter.getActiveElement();\n      selectionRange = gridCoreUtils.getSelectionRange(focusedElement);\n\n      this._toggleBestFitMode(true);\n\n      resetBestFitMode = true;\n    }\n\n    var $element = this.component.$element();\n\n    if ($element && $element[0] && this._maxWidth) {\n      delete this._maxWidth;\n      $element[0].style.maxWidth = \"\";\n    }\n\n    deferUpdate(() => {\n      if (needBestFit) {\n        resultWidths = this._getBestFitWidths();\n        each(visibleColumns, function (index, column) {\n          var columnId = columnsController.getColumnId(column);\n          columnsController.columnOption(columnId, \"bestFitWidth\", resultWidths[index], true);\n        });\n      } else if (hasMinWidth) {\n        resultWidths = this._getBestFitWidths();\n      }\n\n      each(visibleColumns, function (index) {\n        var width = this.width;\n\n        if (\"auto\" !== width) {\n          if (isDefined(width)) {\n            resultWidths[index] = isNumeric(width) || isPixelWidth(width) ? parseFloat(width) : width;\n          } else if (!columnAutoWidth) {\n            resultWidths[index] = void 0;\n          }\n        }\n      });\n\n      if (resetBestFitMode) {\n        this._toggleBestFitMode(false);\n\n        resetBestFitMode = false;\n\n        if (focusedElement && focusedElement !== domAdapter.getActiveElement()) {\n          var isFocusOutsideWindow = getBoundingRect(focusedElement).bottom < 0;\n\n          if (!isFocusOutsideWindow) {\n            restoreFocus(focusedElement, selectionRange);\n          }\n        }\n      }\n\n      isColumnWidthsCorrected = this._correctColumnWidths(resultWidths, visibleColumns);\n\n      if (columnAutoWidth) {\n        !function () {\n          var expandColumnWidth;\n          each(visibleColumns, function (index, column) {\n            if (\"groupExpand\" === column.type) {\n              expandColumnWidth = resultWidths[index];\n            }\n          });\n          each(visibleColumns, function (index, column) {\n            if (\"groupExpand\" === column.type && expandColumnWidth) {\n              resultWidths[index] = expandColumnWidth;\n            }\n          });\n        }();\n\n        if (this._needStretch()) {\n          this._processStretch(resultWidths, visibleColumns);\n        }\n      }\n\n      deferRender(() => {\n        if (needBestFit || isColumnWidthsCorrected) {\n          this._setVisibleWidths(visibleColumns, resultWidths);\n        }\n      });\n    });\n  },\n  _needBestFit: function () {\n    return this.option(\"columnAutoWidth\");\n  },\n  _needStretch: function () {\n    return this._columnsController.getVisibleColumns().some(c => \"auto\" === c.width && !c.command);\n  },\n  _getAverageColumnsWidth: function (resultWidths) {\n    var freeWidth = calculateFreeWidth(this, resultWidths);\n    var columnCountWithoutWidth = resultWidths.filter(function (width) {\n      return void 0 === width;\n    }).length;\n    return freeWidth / columnCountWithoutWidth;\n  },\n  _correctColumnWidths: function (resultWidths, visibleColumns) {\n    var that = this;\n    var i;\n    var hasPercentWidth = false;\n    var hasAutoWidth = false;\n    var isColumnWidthsCorrected = false;\n    var $element = that.component.$element();\n    var hasWidth = that._hasWidth;\n\n    var _loop = function () {\n      var index = i;\n      var column = visibleColumns[index];\n      var isHiddenColumn = resultWidths[index] === HIDDEN_COLUMNS_WIDTH;\n      var width = resultWidths[index];\n      var minWidth = column.minWidth;\n\n      if (minWidth) {\n        if (void 0 === width) {\n          var averageColumnsWidth = that._getAverageColumnsWidth(resultWidths);\n\n          width = averageColumnsWidth;\n        } else if (isPercentWidth(width)) {\n          var freeWidth = calculateFreeWidthWithCurrentMinWidth(that, index, minWidth, resultWidths);\n\n          if (freeWidth < 0) {\n            width = -1;\n          }\n        }\n      }\n\n      var realColumnWidth = that._getRealColumnWidth(index, resultWidths.map(function (columnWidth, columnIndex) {\n        return index === columnIndex ? width : columnWidth;\n      }));\n\n      if (minWidth && !isHiddenColumn && realColumnWidth < minWidth) {\n        resultWidths[index] = minWidth;\n        isColumnWidthsCorrected = true;\n        i = -1;\n      }\n\n      if (!isDefined(column.width)) {\n        hasAutoWidth = true;\n      }\n\n      if (isPercentWidth(column.width)) {\n        hasPercentWidth = true;\n      }\n    };\n\n    for (i = 0; i < visibleColumns.length; i++) {\n      _loop();\n    }\n\n    if (!hasAutoWidth && resultWidths.length) {\n      var $rowsViewElement = that._rowsView.element();\n\n      var contentWidth = that._rowsView.contentWidth();\n\n      var scrollbarWidth = that._rowsView.getScrollbarWidth();\n\n      var totalWidth = that._getTotalWidth(resultWidths, contentWidth);\n\n      if (totalWidth < contentWidth) {\n        var lastColumnIndex = gridCoreUtils.getLastResizableColumnIndex(visibleColumns, resultWidths);\n\n        if (lastColumnIndex >= 0) {\n          resultWidths[lastColumnIndex] = \"auto\";\n          isColumnWidthsCorrected = true;\n\n          if (false === hasWidth && !hasPercentWidth) {\n            var borderWidth = that.option(\"showBorders\") ? Math.ceil(getOuterWidth($rowsViewElement) - getInnerWidth($rowsViewElement)) : 0;\n            that._maxWidth = totalWidth + scrollbarWidth + borderWidth;\n            $element.css(\"maxWidth\", that._maxWidth);\n          }\n        }\n      }\n    }\n\n    return isColumnWidthsCorrected;\n  },\n  _processStretch: function (resultSizes, visibleColumns) {\n    var groupSize = this._rowsView.contentWidth();\n\n    var tableSize = this._getTotalWidth(resultSizes, groupSize);\n\n    var unusedIndexes = {\n      length: 0\n    };\n\n    if (!resultSizes.length) {\n      return;\n    }\n\n    each(visibleColumns, function (index) {\n      if (this.width || resultSizes[index] === HIDDEN_COLUMNS_WIDTH) {\n        unusedIndexes[index] = true;\n        unusedIndexes.length++;\n      }\n    });\n    var diff = groupSize - tableSize;\n    var diffElement = Math.floor(diff / (resultSizes.length - unusedIndexes.length));\n    var onePixelElementsCount = diff - diffElement * (resultSizes.length - unusedIndexes.length);\n\n    if (diff >= 0) {\n      for (var i = 0; i < resultSizes.length; i++) {\n        if (unusedIndexes[i]) {\n          continue;\n        }\n\n        resultSizes[i] += diffElement;\n\n        if (onePixelElementsCount > 0) {\n          if (onePixelElementsCount < 1) {\n            resultSizes[i] += onePixelElementsCount;\n            onePixelElementsCount = 0;\n          } else {\n            resultSizes[i]++;\n            onePixelElementsCount--;\n          }\n        }\n      }\n    }\n  },\n  _getRealColumnWidth: function (columnIndex, columnWidths, groupWidth) {\n    var ratio = 1;\n    var width = columnWidths[columnIndex];\n\n    if (!isPercentWidth(width)) {\n      return parseFloat(width);\n    }\n\n    var percentTotalWidth = columnWidths.reduce((sum, width, index) => {\n      if (!isPercentWidth(width)) {\n        return sum;\n      }\n\n      return sum + parseFloat(width);\n    }, 0);\n    var pixelTotalWidth = columnWidths.reduce((sum, width) => {\n      if (!width || width === HIDDEN_COLUMNS_WIDTH || isPercentWidth(width)) {\n        return sum;\n      }\n\n      return sum + parseFloat(width);\n    }, 0);\n    groupWidth = groupWidth || this._rowsView.contentWidth();\n    var freeSpace = groupWidth - pixelTotalWidth;\n    var percentTotalWidthInPixel = percentTotalWidth * groupWidth / 100;\n\n    if (pixelTotalWidth > 0 && percentTotalWidthInPixel + pixelTotalWidth >= groupWidth) {\n      ratio = percentTotalWidthInPixel > freeSpace ? freeSpace / percentTotalWidthInPixel : 1;\n    }\n\n    return parseFloat(width) * groupWidth * ratio / 100;\n  },\n  _getTotalWidth: function (widths, groupWidth) {\n    var result = 0;\n\n    for (var i = 0; i < widths.length; i++) {\n      var width = widths[i];\n\n      if (width && width !== HIDDEN_COLUMNS_WIDTH) {\n        result += this._getRealColumnWidth(i, widths, groupWidth);\n      }\n    }\n\n    return Math.ceil(result);\n  },\n  updateSize: function (rootElement) {\n    var $groupElement;\n    var width;\n    var $rootElement = $(rootElement);\n    var importantMarginClass = this.addWidgetPrefix(IMPORTANT_MARGIN_CLASS);\n\n    if (void 0 === this._hasHeight && $rootElement && $rootElement.is(\":visible\") && getWidth($rootElement)) {\n      $groupElement = $rootElement.children(\".\" + this.getWidgetContainerClass());\n\n      if ($groupElement.length) {\n        $groupElement.detach();\n      }\n\n      this._hasHeight = !!getContainerHeight($rootElement);\n      width = getWidth($rootElement);\n      $rootElement.addClass(importantMarginClass);\n      this._hasWidth = getWidth($rootElement) === width;\n      $rootElement.removeClass(importantMarginClass);\n\n      if ($groupElement.length) {\n        $groupElement.appendTo($rootElement);\n      }\n    }\n  },\n  publicMethods: function () {\n    return [\"resize\", \"updateDimensions\"];\n  },\n  resize: function () {\n    return !this.component._requireResize && this.updateDimensions();\n  },\n  updateDimensions: function (checkSize) {\n    var that = this;\n\n    that._initPostRenderHandlers();\n\n    if (!that._checkSize(checkSize)) {\n      return;\n    }\n\n    var prevResult = that._resizeDeferred;\n    var result = that._resizeDeferred = new Deferred();\n    when(prevResult).always(function () {\n      deferRender(function () {\n        if (that._dataController.isLoaded()) {\n          that._synchronizeColumns();\n        }\n\n        that._resetGroupElementHeight();\n\n        deferUpdate(function () {\n          deferRender(function () {\n            deferUpdate(function () {\n              that._updateDimensionsCore();\n            });\n          });\n        });\n      }).done(result.resolve).fail(result.reject);\n    });\n    return result.promise();\n  },\n  _resetGroupElementHeight: function () {\n    var groupElement = this.component.$element().children().get(0);\n\n    var scrollable = this._rowsView.getScrollable();\n\n    if (groupElement && groupElement.style.height && (!scrollable || !scrollable.scrollTop())) {\n      groupElement.style.height = \"\";\n    }\n  },\n  _checkSize: function (checkSize) {\n    var $rootElement = this.component.$element();\n\n    if (checkSize && (this._lastWidth === getWidth($rootElement) && this._lastHeight === getHeight($rootElement) && this._devicePixelRatio === getWindow().devicePixelRatio || !$rootElement.is(\":visible\"))) {\n      return false;\n    }\n\n    return true;\n  },\n  _setScrollerSpacingCore: function (hasHeight) {\n    var that = this;\n    var vScrollbarWidth = hasHeight ? that._rowsView.getScrollbarWidth() : 0;\n\n    var hScrollbarWidth = that._rowsView.getScrollbarWidth(true);\n\n    deferRender(function () {\n      that._columnHeadersView && that._columnHeadersView.setScrollerSpacing(vScrollbarWidth);\n      that._footerView && that._footerView.setScrollerSpacing(vScrollbarWidth);\n\n      that._rowsView.setScrollerSpacing(vScrollbarWidth, hScrollbarWidth);\n    });\n  },\n  _setScrollerSpacing: function (hasHeight) {\n    if (true === this.option(\"scrolling.useNative\")) {\n      deferRender(() => {\n        deferUpdate(() => {\n          this._setScrollerSpacingCore(hasHeight);\n        });\n      });\n    } else {\n      this._setScrollerSpacingCore(hasHeight);\n    }\n  },\n  _updateDimensionsCore: function () {\n    var that = this;\n    var dataController = that._dataController;\n    var rowsView = that._rowsView;\n    var $rootElement = that.component.$element();\n    var groupElement = $rootElement.children().get(0);\n    var rootElementHeight = $rootElement && ($rootElement.get(0).clientHeight || getHeight($rootElement));\n    var maxHeight = parseInt($rootElement.css(\"maxHeight\"));\n    var maxHeightHappened = maxHeight && rootElementHeight >= maxHeight;\n    var height = that.option(\"height\") || $rootElement.get(0).style.height;\n    var editorFactory = that.getController(\"editorFactory\");\n    var isMaxHeightApplied = maxHeightHappened && groupElement.scrollHeight === groupElement.offsetHeight;\n    var $testDiv;\n    that.updateSize($rootElement);\n    var hasHeight = that._hasHeight || maxHeightHappened;\n\n    if (height && that._hasHeight ^ \"auto\" !== height) {\n      $testDiv = $(\"<div>\");\n      setHeight($testDiv, height);\n      $testDiv.appendTo($rootElement);\n      that._hasHeight = !!getHeight($testDiv);\n      $testDiv.remove();\n    }\n\n    deferRender(function () {\n      rowsView.height(null, hasHeight);\n\n      if (maxHeightHappened && !isMaxHeightApplied) {\n        $(groupElement).css(\"height\", maxHeight);\n      }\n\n      if (!dataController.isLoaded()) {\n        rowsView.setLoading(dataController.isLoading());\n        return;\n      }\n\n      deferUpdate(function () {\n        that._updateLastSizes($rootElement);\n\n        that._setScrollerSpacing(hasHeight);\n\n        each(VIEW_NAMES, function (index, viewName) {\n          var view = that.getView(viewName);\n\n          if (view) {\n            view.resize();\n          }\n        });\n        editorFactory && editorFactory.resize();\n      });\n    });\n  },\n  _updateLastSizes: function ($rootElement) {\n    this._lastWidth = getWidth($rootElement);\n    this._lastHeight = getHeight($rootElement);\n    this._devicePixelRatio = getWindow().devicePixelRatio;\n  },\n  optionChanged: function (args) {\n    switch (args.name) {\n      case \"width\":\n      case \"height\":\n        this.component._renderDimensions();\n\n        this.resize();\n\n      case \"renderAsync\":\n        args.handled = true;\n        return;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  init: function () {\n    this._dataController = this.getController(\"data\");\n    this._columnsController = this.getController(\"columns\");\n    this._columnHeadersView = this.getView(\"columnHeadersView\");\n    this._footerView = this.getView(\"footerView\");\n    this._rowsView = this.getView(\"rowsView\");\n  }\n});\nvar SynchronizeScrollingController = modules.ViewController.inherit({\n  _scrollChangedHandler: function (views, pos, viewName) {\n    for (var j = 0; j < views.length; j++) {\n      if (views[j] && views[j].name !== viewName) {\n        views[j].scrollTo({\n          left: pos.left,\n          top: pos.top\n        });\n      }\n    }\n  },\n  init: function () {\n    var views = [this.getView(\"columnHeadersView\"), this.getView(\"footerView\"), this.getView(\"rowsView\")];\n\n    for (var i = 0; i < views.length; i++) {\n      var view = views[i];\n\n      if (view) {\n        view.scrollChanged.add(this._scrollChangedHandler.bind(this, views));\n      }\n    }\n  }\n});\nvar GridView = modules.View.inherit({\n  _endUpdateCore: function () {\n    if (this.component._requireResize) {\n      this.component._requireResize = false;\n\n      this._resizingController.resize();\n    }\n  },\n  _getWidgetAriaLabel: function () {\n    return \"dxDataGrid-ariaDataGrid\";\n  },\n  init: function () {\n    this._resizingController = this.getController(\"resizing\");\n    this._dataController = this.getController(\"data\");\n  },\n  getView: function (name) {\n    return this.component._views[name];\n  },\n  element: function () {\n    return this._groupElement;\n  },\n  optionChanged: function (args) {\n    if (isDefined(this._groupElement) && \"showBorders\" === args.name) {\n      this._groupElement.toggleClass(this.addWidgetPrefix(BORDERS_CLASS), !!args.value);\n\n      args.handled = true;\n    } else {\n      this.callBase(args);\n    }\n  },\n  _renderViews: function ($groupElement) {\n    var that = this;\n    each(VIEW_NAMES, function (index, viewName) {\n      var view = that.getView(viewName);\n\n      if (view) {\n        view.render($groupElement);\n      }\n    });\n  },\n  _getTableRoleName: function () {\n    return \"grid\";\n  },\n  render: function ($rootElement) {\n    var isFirstRender = !this._groupElement;\n    var $groupElement = this._groupElement || $(\"<div>\").addClass(this.getWidgetContainerClass());\n    $groupElement.addClass(GRIDBASE_CONTAINER_CLASS);\n    $groupElement.toggleClass(this.addWidgetPrefix(BORDERS_CLASS), !!this.option(\"showBorders\"));\n    this.setAria(\"role\", \"presentation\", $rootElement);\n    this.component.setAria({\n      role: this._getTableRoleName(),\n      label: messageLocalization.format(this._getWidgetAriaLabel())\n    }, $groupElement);\n    this._rootElement = $rootElement || this._rootElement;\n\n    if (isFirstRender) {\n      this._groupElement = $groupElement;\n      hasWindow() && this.getController(\"resizing\").updateSize($rootElement);\n      $groupElement.appendTo($rootElement);\n    }\n\n    this._renderViews($groupElement);\n  },\n  update: function () {\n    var $rootElement = this._rootElement;\n    var $groupElement = this._groupElement;\n    var resizingController = this.getController(\"resizing\");\n\n    if ($rootElement && $groupElement) {\n      resizingController.resize();\n\n      if (this._dataController.isLoaded()) {\n        this._resizingController.fireContentReadyAction();\n      }\n    }\n  }\n});\nexport var gridViewModule = {\n  defaultOptions: function () {\n    return {\n      showBorders: false,\n      renderAsync: false\n    };\n  },\n  controllers: {\n    resizing: ResizingController,\n    synchronizeScrolling: SynchronizeScrollingController\n  },\n  views: {\n    gridView: GridView\n  },\n  VIEW_NAMES: VIEW_NAMES\n};","map":{"version":3,"sources":["/Users/rahulsharma/node_modules/devextreme/esm/ui/grid_core/ui.grid_core.grid_view.js"],"names":["getOuterWidth","getInnerWidth","getWidth","getHeight","setHeight","$","modules","deferRender","deferUpdate","hasWindow","getWindow","each","isString","isDefined","isNumeric","getBoundingRect","gridCoreUtils","messageLocalization","when","Deferred","domAdapter","accessibility","BORDERS_CLASS","TABLE_FIXED_CLASS","IMPORTANT_MARGIN_CLASS","GRIDBASE_CONTAINER_CLASS","HIDDEN_COLUMNS_WIDTH","VIEW_NAMES","isPercentWidth","width","slice","isPixelWidth","getContainerHeight","$container","clientHeight","get","paddingTop","parseFloat","css","paddingBottom","calculateFreeWidth","that","widths","contentWidth","_rowsView","totalWidth","_getTotalWidth","calculateFreeWidthWithCurrentMinWidth","columnIndex","currentMinWidth","map","index","restoreFocus","focusedElement","selectionRange","hiddenFocus","setSelectionRange","ResizingController","ViewController","inherit","_initPostRenderHandlers","dataController","_dataController","_refreshSizesHandler","e","changed","remove","templateDeferreds","apply","done","_refreshSizes","add","resizeDeferred","changeType","isDelayed","items","resize","_e$changeTypes","changeTypes","length","needUpdateDimensions","_setScrollerSpacing","_hasHeight","_setAriaRowColCount","fireContentReadyAction","component","_fireContentReadyAction","setAria","rowCount","totalItemsCount","colCount","columnCount","$element","children","_getBestFitWidths","_widths","rowsView","columnHeadersView","_columnHeadersView","getColumnWidths","_rowsView$getTableEle","headersTableElement","getTableElement","setTableElement","_setVisibleWidths","visibleColumns","columnsController","_columnsController","beginUpdate","column","columnId","getColumnId","columnOption","endUpdate","_toggleBestFitModeForView","view","className","isBestFit","isVisible","$rowsTables","getTableElements","$viewTables","tableElement","$tableBody","$rowsTable","$viewTable","eq","appendTo","toggleClass","addWidgetPrefix","_toggleBestFitMode","$rowsFixedTable","_footerView","_needStretch","style","_synchronizeColumns","getVisibleColumns","columnAutoWidth","option","needBestFit","_needBestFit","hasMinWidth","resetBestFitMode","isColumnWidthsCorrected","resultWidths","minWidth","getActiveElement","getSelectionRange","_maxWidth","maxWidth","isFocusOutsideWindow","bottom","_correctColumnWidths","expandColumnWidth","type","_processStretch","some","c","command","_getAverageColumnsWidth","freeWidth","columnCountWithoutWidth","filter","i","hasPercentWidth","hasAutoWidth","hasWidth","_hasWidth","_loop","isHiddenColumn","averageColumnsWidth","realColumnWidth","_getRealColumnWidth","columnWidth","$rowsViewElement","element","scrollbarWidth","getScrollbarWidth","lastColumnIndex","getLastResizableColumnIndex","borderWidth","Math","ceil","resultSizes","groupSize","tableSize","unusedIndexes","diff","diffElement","floor","onePixelElementsCount","columnWidths","groupWidth","ratio","percentTotalWidth","reduce","sum","pixelTotalWidth","freeSpace","percentTotalWidthInPixel","result","updateSize","rootElement","$groupElement","$rootElement","importantMarginClass","is","getWidgetContainerClass","detach","addClass","removeClass","publicMethods","_requireResize","updateDimensions","checkSize","_checkSize","prevResult","_resizeDeferred","always","isLoaded","_resetGroupElementHeight","_updateDimensionsCore","resolve","fail","reject","promise","groupElement","scrollable","getScrollable","height","scrollTop","_lastWidth","_lastHeight","_devicePixelRatio","devicePixelRatio","_setScrollerSpacingCore","hasHeight","vScrollbarWidth","hScrollbarWidth","setScrollerSpacing","rootElementHeight","maxHeight","parseInt","maxHeightHappened","editorFactory","getController","isMaxHeightApplied","scrollHeight","offsetHeight","$testDiv","setLoading","isLoading","_updateLastSizes","viewName","getView","optionChanged","args","name","_renderDimensions","handled","callBase","init","SynchronizeScrollingController","_scrollChangedHandler","views","pos","j","scrollTo","left","top","scrollChanged","bind","GridView","View","_endUpdateCore","_resizingController","_getWidgetAriaLabel","_views","_groupElement","value","_renderViews","render","_getTableRoleName","isFirstRender","role","label","format","_rootElement","update","resizingController","gridViewModule","defaultOptions","showBorders","renderAsync","controllers","resizing","synchronizeScrolling","gridView"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/grid_core/ui.grid_core.grid_view.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getOuterWidth,\r\n    getInnerWidth,\r\n    getWidth,\r\n    getHeight,\r\n    setHeight\r\n} from \"../../core/utils/size\";\r\nimport $ from \"../../core/renderer\";\r\nimport modules from \"./ui.grid_core.modules\";\r\nimport {\r\n    deferRender,\r\n    deferUpdate\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    hasWindow,\r\n    getWindow\r\n} from \"../../core/utils/window\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport {\r\n    isString,\r\n    isDefined,\r\n    isNumeric\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    getBoundingRect\r\n} from \"../../core/utils/position\";\r\nimport gridCoreUtils from \"./ui.grid_core.utils\";\r\nimport messageLocalization from \"../../localization/message\";\r\nimport {\r\n    when,\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nimport domAdapter from \"../../core/dom_adapter\";\r\nimport * as accessibility from \"../shared/accessibility\";\r\nvar BORDERS_CLASS = \"borders\";\r\nvar TABLE_FIXED_CLASS = \"table-fixed\";\r\nvar IMPORTANT_MARGIN_CLASS = \"important-margin\";\r\nvar GRIDBASE_CONTAINER_CLASS = \"dx-gridbase-container\";\r\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\r\nvar VIEW_NAMES = [\"columnsSeparatorView\", \"blockSeparatorView\", \"trackerView\", \"headerPanel\", \"columnHeadersView\", \"rowsView\", \"footerView\", \"columnChooserView\", \"filterPanelView\", \"pagerView\", \"draggingHeaderView\", \"contextMenuView\", \"errorView\", \"headerFilterView\", \"filterBuilderView\"];\r\nvar isPercentWidth = function(width) {\r\n    return isString(width) && \"%\" === width.slice(-1)\r\n};\r\nvar isPixelWidth = function(width) {\r\n    return isString(width) && \"px\" === width.slice(-2)\r\n};\r\nvar getContainerHeight = function($container) {\r\n    var clientHeight = $container.get(0).clientHeight;\r\n    var paddingTop = parseFloat($container.css(\"paddingTop\"));\r\n    var paddingBottom = parseFloat($container.css(\"paddingBottom\"));\r\n    return clientHeight - paddingTop - paddingBottom\r\n};\r\nvar calculateFreeWidth = function(that, widths) {\r\n    var contentWidth = that._rowsView.contentWidth();\r\n    var totalWidth = that._getTotalWidth(widths, contentWidth);\r\n    return contentWidth - totalWidth\r\n};\r\nvar calculateFreeWidthWithCurrentMinWidth = function(that, columnIndex, currentMinWidth, widths) {\r\n    return calculateFreeWidth(that, widths.map((function(width, index) {\r\n        return index === columnIndex ? currentMinWidth : width\r\n    })))\r\n};\r\nvar restoreFocus = function(focusedElement, selectionRange) {\r\n    accessibility.hiddenFocus(focusedElement);\r\n    gridCoreUtils.setSelectionRange(focusedElement, selectionRange)\r\n};\r\nvar ResizingController = modules.ViewController.inherit({\r\n    _initPostRenderHandlers: function() {\r\n        var dataController = this._dataController;\r\n        if (!this._refreshSizesHandler) {\r\n            this._refreshSizesHandler = e => {\r\n                dataController.changed.remove(this._refreshSizesHandler);\r\n                var templateDeferreds = e && e.templateDeferreds || [];\r\n                when.apply(this, templateDeferreds).done(() => {\r\n                    this._refreshSizes(e)\r\n                })\r\n            };\r\n            dataController.changed.add(() => {\r\n                dataController.changed.add(this._refreshSizesHandler)\r\n            })\r\n        }\r\n    },\r\n    _refreshSizes: function(e) {\r\n        var resizeDeferred;\r\n        var that = this;\r\n        var changeType = e && e.changeType;\r\n        var isDelayed = e && e.isDelayed;\r\n        var items = that._dataController.items();\r\n        if (!e || \"refresh\" === changeType || \"prepend\" === changeType || \"append\" === changeType) {\r\n            if (!isDelayed) {\r\n                resizeDeferred = that.resize()\r\n            }\r\n        } else if (\"update\" === changeType) {\r\n            var _e$changeTypes;\r\n            if (0 === (null === (_e$changeTypes = e.changeTypes) || void 0 === _e$changeTypes ? void 0 : _e$changeTypes.length)) {\r\n                return\r\n            }\r\n            if ((items.length > 1 || \"insert\" !== e.changeTypes[0]) && !(0 === items.length && \"remove\" === e.changeTypes[0]) && !e.needUpdateDimensions) {\r\n                deferUpdate(() => deferRender(() => deferUpdate(() => {\r\n                    that._setScrollerSpacing(that._hasHeight);\r\n                    that._rowsView.resize()\r\n                })))\r\n            } else {\r\n                resizeDeferred = that.resize()\r\n            }\r\n        }\r\n        if (changeType && \"updateSelection\" !== changeType && \"updateFocusedRow\" !== changeType && \"pageIndex\" !== changeType && !isDelayed) {\r\n            when(resizeDeferred).done((function() {\r\n                that._setAriaRowColCount();\r\n                that.fireContentReadyAction()\r\n            }))\r\n        }\r\n    },\r\n    fireContentReadyAction: function() {\r\n        this.component._fireContentReadyAction()\r\n    },\r\n    _setAriaRowColCount: function() {\r\n        var component = this.component;\r\n        component.setAria({\r\n            rowCount: this._dataController.totalItemsCount(),\r\n            colCount: component.columnCount()\r\n        }, component.$element().children(\".\" + GRIDBASE_CONTAINER_CLASS))\r\n    },\r\n    _getBestFitWidths: function() {\r\n        var _widths;\r\n        var rowsView = this._rowsView;\r\n        var columnHeadersView = this._columnHeadersView;\r\n        var widths = rowsView.getColumnWidths();\r\n        if (!(null !== (_widths = widths) && void 0 !== _widths && _widths.length)) {\r\n            var _rowsView$getTableEle;\r\n            var headersTableElement = columnHeadersView.getTableElement();\r\n            columnHeadersView.setTableElement(null === (_rowsView$getTableEle = rowsView.getTableElement()) || void 0 === _rowsView$getTableEle ? void 0 : _rowsView$getTableEle.children(\".dx-header\"));\r\n            widths = columnHeadersView.getColumnWidths();\r\n            columnHeadersView.setTableElement(headersTableElement)\r\n        }\r\n        return widths\r\n    },\r\n    _setVisibleWidths: function(visibleColumns, widths) {\r\n        var columnsController = this._columnsController;\r\n        columnsController.beginUpdate();\r\n        each(visibleColumns, (function(index, column) {\r\n            var columnId = columnsController.getColumnId(column);\r\n            columnsController.columnOption(columnId, \"visibleWidth\", widths[index])\r\n        }));\r\n        columnsController.endUpdate()\r\n    },\r\n    _toggleBestFitModeForView: function(view, className, isBestFit) {\r\n        if (!view || !view.isVisible()) {\r\n            return\r\n        }\r\n        var $rowsTables = this._rowsView.getTableElements();\r\n        var $viewTables = view.getTableElements();\r\n        each($rowsTables, (index, tableElement) => {\r\n            var $tableBody;\r\n            var $rowsTable = $(tableElement);\r\n            var $viewTable = $viewTables.eq(index);\r\n            if ($viewTable && $viewTable.length) {\r\n                if (isBestFit) {\r\n                    $tableBody = $viewTable.children(\"tbody\").appendTo($rowsTable)\r\n                } else {\r\n                    $tableBody = $rowsTable.children(\".\" + className).appendTo($viewTable)\r\n                }\r\n                $tableBody.toggleClass(className, isBestFit);\r\n                $tableBody.toggleClass(this.addWidgetPrefix(\"best-fit\"), isBestFit)\r\n            }\r\n        })\r\n    },\r\n    _toggleBestFitMode: function(isBestFit) {\r\n        var $rowsTable = this._rowsView.getTableElement();\r\n        var $rowsFixedTable = this._rowsView.getTableElements().eq(1);\r\n        if (!$rowsTable) {\r\n            return\r\n        }\r\n        $rowsTable.css(\"tableLayout\", isBestFit ? \"auto\" : \"fixed\");\r\n        $rowsTable.children(\"colgroup\").css(\"display\", isBestFit ? \"none\" : \"\");\r\n        $rowsFixedTable.toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\r\n        this._toggleBestFitModeForView(this._columnHeadersView, \"dx-header\", isBestFit);\r\n        this._toggleBestFitModeForView(this._footerView, \"dx-footer\", isBestFit);\r\n        if (this._needStretch()) {\r\n            $rowsTable.get(0).style.width = isBestFit ? \"auto\" : \"\"\r\n        }\r\n    },\r\n    _synchronizeColumns: function() {\r\n        var columnsController = this._columnsController;\r\n        var visibleColumns = columnsController.getVisibleColumns();\r\n        var columnAutoWidth = this.option(\"columnAutoWidth\");\r\n        var needBestFit = this._needBestFit();\r\n        var hasMinWidth = false;\r\n        var resetBestFitMode;\r\n        var isColumnWidthsCorrected = false;\r\n        var resultWidths = [];\r\n        var focusedElement;\r\n        var selectionRange;\r\n        !needBestFit && each(visibleColumns, (function(index, column) {\r\n            if (\"auto\" === column.width) {\r\n                needBestFit = true;\r\n                return false\r\n            }\r\n        }));\r\n        each(visibleColumns, (function(index, column) {\r\n            if (column.minWidth) {\r\n                hasMinWidth = true;\r\n                return false\r\n            }\r\n        }));\r\n        this._setVisibleWidths(visibleColumns, []);\r\n        if (needBestFit) {\r\n            focusedElement = domAdapter.getActiveElement();\r\n            selectionRange = gridCoreUtils.getSelectionRange(focusedElement);\r\n            this._toggleBestFitMode(true);\r\n            resetBestFitMode = true\r\n        }\r\n        var $element = this.component.$element();\r\n        if ($element && $element[0] && this._maxWidth) {\r\n            delete this._maxWidth;\r\n            $element[0].style.maxWidth = \"\"\r\n        }\r\n        deferUpdate(() => {\r\n            if (needBestFit) {\r\n                resultWidths = this._getBestFitWidths();\r\n                each(visibleColumns, (function(index, column) {\r\n                    var columnId = columnsController.getColumnId(column);\r\n                    columnsController.columnOption(columnId, \"bestFitWidth\", resultWidths[index], true)\r\n                }))\r\n            } else if (hasMinWidth) {\r\n                resultWidths = this._getBestFitWidths()\r\n            }\r\n            each(visibleColumns, (function(index) {\r\n                var width = this.width;\r\n                if (\"auto\" !== width) {\r\n                    if (isDefined(width)) {\r\n                        resultWidths[index] = isNumeric(width) || isPixelWidth(width) ? parseFloat(width) : width\r\n                    } else if (!columnAutoWidth) {\r\n                        resultWidths[index] = void 0\r\n                    }\r\n                }\r\n            }));\r\n            if (resetBestFitMode) {\r\n                this._toggleBestFitMode(false);\r\n                resetBestFitMode = false;\r\n                if (focusedElement && focusedElement !== domAdapter.getActiveElement()) {\r\n                    var isFocusOutsideWindow = getBoundingRect(focusedElement).bottom < 0;\r\n                    if (!isFocusOutsideWindow) {\r\n                        restoreFocus(focusedElement, selectionRange)\r\n                    }\r\n                }\r\n            }\r\n            isColumnWidthsCorrected = this._correctColumnWidths(resultWidths, visibleColumns);\r\n            if (columnAutoWidth) {\r\n                ! function() {\r\n                    var expandColumnWidth;\r\n                    each(visibleColumns, (function(index, column) {\r\n                        if (\"groupExpand\" === column.type) {\r\n                            expandColumnWidth = resultWidths[index]\r\n                        }\r\n                    }));\r\n                    each(visibleColumns, (function(index, column) {\r\n                        if (\"groupExpand\" === column.type && expandColumnWidth) {\r\n                            resultWidths[index] = expandColumnWidth\r\n                        }\r\n                    }))\r\n                }();\r\n                if (this._needStretch()) {\r\n                    this._processStretch(resultWidths, visibleColumns)\r\n                }\r\n            }\r\n            deferRender(() => {\r\n                if (needBestFit || isColumnWidthsCorrected) {\r\n                    this._setVisibleWidths(visibleColumns, resultWidths)\r\n                }\r\n            })\r\n        })\r\n    },\r\n    _needBestFit: function() {\r\n        return this.option(\"columnAutoWidth\")\r\n    },\r\n    _needStretch: function() {\r\n        return this._columnsController.getVisibleColumns().some(c => \"auto\" === c.width && !c.command)\r\n    },\r\n    _getAverageColumnsWidth: function(resultWidths) {\r\n        var freeWidth = calculateFreeWidth(this, resultWidths);\r\n        var columnCountWithoutWidth = resultWidths.filter((function(width) {\r\n            return void 0 === width\r\n        })).length;\r\n        return freeWidth / columnCountWithoutWidth\r\n    },\r\n    _correctColumnWidths: function(resultWidths, visibleColumns) {\r\n        var that = this;\r\n        var i;\r\n        var hasPercentWidth = false;\r\n        var hasAutoWidth = false;\r\n        var isColumnWidthsCorrected = false;\r\n        var $element = that.component.$element();\r\n        var hasWidth = that._hasWidth;\r\n        var _loop = function() {\r\n            var index = i;\r\n            var column = visibleColumns[index];\r\n            var isHiddenColumn = resultWidths[index] === HIDDEN_COLUMNS_WIDTH;\r\n            var width = resultWidths[index];\r\n            var minWidth = column.minWidth;\r\n            if (minWidth) {\r\n                if (void 0 === width) {\r\n                    var averageColumnsWidth = that._getAverageColumnsWidth(resultWidths);\r\n                    width = averageColumnsWidth\r\n                } else if (isPercentWidth(width)) {\r\n                    var freeWidth = calculateFreeWidthWithCurrentMinWidth(that, index, minWidth, resultWidths);\r\n                    if (freeWidth < 0) {\r\n                        width = -1\r\n                    }\r\n                }\r\n            }\r\n            var realColumnWidth = that._getRealColumnWidth(index, resultWidths.map((function(columnWidth, columnIndex) {\r\n                return index === columnIndex ? width : columnWidth\r\n            })));\r\n            if (minWidth && !isHiddenColumn && realColumnWidth < minWidth) {\r\n                resultWidths[index] = minWidth;\r\n                isColumnWidthsCorrected = true;\r\n                i = -1\r\n            }\r\n            if (!isDefined(column.width)) {\r\n                hasAutoWidth = true\r\n            }\r\n            if (isPercentWidth(column.width)) {\r\n                hasPercentWidth = true\r\n            }\r\n        };\r\n        for (i = 0; i < visibleColumns.length; i++) {\r\n            _loop()\r\n        }\r\n        if (!hasAutoWidth && resultWidths.length) {\r\n            var $rowsViewElement = that._rowsView.element();\r\n            var contentWidth = that._rowsView.contentWidth();\r\n            var scrollbarWidth = that._rowsView.getScrollbarWidth();\r\n            var totalWidth = that._getTotalWidth(resultWidths, contentWidth);\r\n            if (totalWidth < contentWidth) {\r\n                var lastColumnIndex = gridCoreUtils.getLastResizableColumnIndex(visibleColumns, resultWidths);\r\n                if (lastColumnIndex >= 0) {\r\n                    resultWidths[lastColumnIndex] = \"auto\";\r\n                    isColumnWidthsCorrected = true;\r\n                    if (false === hasWidth && !hasPercentWidth) {\r\n                        var borderWidth = that.option(\"showBorders\") ? Math.ceil(getOuterWidth($rowsViewElement) - getInnerWidth($rowsViewElement)) : 0;\r\n                        that._maxWidth = totalWidth + scrollbarWidth + borderWidth;\r\n                        $element.css(\"maxWidth\", that._maxWidth)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return isColumnWidthsCorrected\r\n    },\r\n    _processStretch: function(resultSizes, visibleColumns) {\r\n        var groupSize = this._rowsView.contentWidth();\r\n        var tableSize = this._getTotalWidth(resultSizes, groupSize);\r\n        var unusedIndexes = {\r\n            length: 0\r\n        };\r\n        if (!resultSizes.length) {\r\n            return\r\n        }\r\n        each(visibleColumns, (function(index) {\r\n            if (this.width || resultSizes[index] === HIDDEN_COLUMNS_WIDTH) {\r\n                unusedIndexes[index] = true;\r\n                unusedIndexes.length++\r\n            }\r\n        }));\r\n        var diff = groupSize - tableSize;\r\n        var diffElement = Math.floor(diff / (resultSizes.length - unusedIndexes.length));\r\n        var onePixelElementsCount = diff - diffElement * (resultSizes.length - unusedIndexes.length);\r\n        if (diff >= 0) {\r\n            for (var i = 0; i < resultSizes.length; i++) {\r\n                if (unusedIndexes[i]) {\r\n                    continue\r\n                }\r\n                resultSizes[i] += diffElement;\r\n                if (onePixelElementsCount > 0) {\r\n                    if (onePixelElementsCount < 1) {\r\n                        resultSizes[i] += onePixelElementsCount;\r\n                        onePixelElementsCount = 0\r\n                    } else {\r\n                        resultSizes[i]++;\r\n                        onePixelElementsCount--\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _getRealColumnWidth: function(columnIndex, columnWidths, groupWidth) {\r\n        var ratio = 1;\r\n        var width = columnWidths[columnIndex];\r\n        if (!isPercentWidth(width)) {\r\n            return parseFloat(width)\r\n        }\r\n        var percentTotalWidth = columnWidths.reduce((sum, width, index) => {\r\n            if (!isPercentWidth(width)) {\r\n                return sum\r\n            }\r\n            return sum + parseFloat(width)\r\n        }, 0);\r\n        var pixelTotalWidth = columnWidths.reduce((sum, width) => {\r\n            if (!width || width === HIDDEN_COLUMNS_WIDTH || isPercentWidth(width)) {\r\n                return sum\r\n            }\r\n            return sum + parseFloat(width)\r\n        }, 0);\r\n        groupWidth = groupWidth || this._rowsView.contentWidth();\r\n        var freeSpace = groupWidth - pixelTotalWidth;\r\n        var percentTotalWidthInPixel = percentTotalWidth * groupWidth / 100;\r\n        if (pixelTotalWidth > 0 && percentTotalWidthInPixel + pixelTotalWidth >= groupWidth) {\r\n            ratio = percentTotalWidthInPixel > freeSpace ? freeSpace / percentTotalWidthInPixel : 1\r\n        }\r\n        return parseFloat(width) * groupWidth * ratio / 100\r\n    },\r\n    _getTotalWidth: function(widths, groupWidth) {\r\n        var result = 0;\r\n        for (var i = 0; i < widths.length; i++) {\r\n            var width = widths[i];\r\n            if (width && width !== HIDDEN_COLUMNS_WIDTH) {\r\n                result += this._getRealColumnWidth(i, widths, groupWidth)\r\n            }\r\n        }\r\n        return Math.ceil(result)\r\n    },\r\n    updateSize: function(rootElement) {\r\n        var $groupElement;\r\n        var width;\r\n        var $rootElement = $(rootElement);\r\n        var importantMarginClass = this.addWidgetPrefix(IMPORTANT_MARGIN_CLASS);\r\n        if (void 0 === this._hasHeight && $rootElement && $rootElement.is(\":visible\") && getWidth($rootElement)) {\r\n            $groupElement = $rootElement.children(\".\" + this.getWidgetContainerClass());\r\n            if ($groupElement.length) {\r\n                $groupElement.detach()\r\n            }\r\n            this._hasHeight = !!getContainerHeight($rootElement);\r\n            width = getWidth($rootElement);\r\n            $rootElement.addClass(importantMarginClass);\r\n            this._hasWidth = getWidth($rootElement) === width;\r\n            $rootElement.removeClass(importantMarginClass);\r\n            if ($groupElement.length) {\r\n                $groupElement.appendTo($rootElement)\r\n            }\r\n        }\r\n    },\r\n    publicMethods: function() {\r\n        return [\"resize\", \"updateDimensions\"]\r\n    },\r\n    resize: function() {\r\n        return !this.component._requireResize && this.updateDimensions()\r\n    },\r\n    updateDimensions: function(checkSize) {\r\n        var that = this;\r\n        that._initPostRenderHandlers();\r\n        if (!that._checkSize(checkSize)) {\r\n            return\r\n        }\r\n        var prevResult = that._resizeDeferred;\r\n        var result = that._resizeDeferred = new Deferred;\r\n        when(prevResult).always((function() {\r\n            deferRender((function() {\r\n                if (that._dataController.isLoaded()) {\r\n                    that._synchronizeColumns()\r\n                }\r\n                that._resetGroupElementHeight();\r\n                deferUpdate((function() {\r\n                    deferRender((function() {\r\n                        deferUpdate((function() {\r\n                            that._updateDimensionsCore()\r\n                        }))\r\n                    }))\r\n                }))\r\n            })).done(result.resolve).fail(result.reject)\r\n        }));\r\n        return result.promise()\r\n    },\r\n    _resetGroupElementHeight: function() {\r\n        var groupElement = this.component.$element().children().get(0);\r\n        var scrollable = this._rowsView.getScrollable();\r\n        if (groupElement && groupElement.style.height && (!scrollable || !scrollable.scrollTop())) {\r\n            groupElement.style.height = \"\"\r\n        }\r\n    },\r\n    _checkSize: function(checkSize) {\r\n        var $rootElement = this.component.$element();\r\n        if (checkSize && (this._lastWidth === getWidth($rootElement) && this._lastHeight === getHeight($rootElement) && this._devicePixelRatio === getWindow().devicePixelRatio || !$rootElement.is(\":visible\"))) {\r\n            return false\r\n        }\r\n        return true\r\n    },\r\n    _setScrollerSpacingCore: function(hasHeight) {\r\n        var that = this;\r\n        var vScrollbarWidth = hasHeight ? that._rowsView.getScrollbarWidth() : 0;\r\n        var hScrollbarWidth = that._rowsView.getScrollbarWidth(true);\r\n        deferRender((function() {\r\n            that._columnHeadersView && that._columnHeadersView.setScrollerSpacing(vScrollbarWidth);\r\n            that._footerView && that._footerView.setScrollerSpacing(vScrollbarWidth);\r\n            that._rowsView.setScrollerSpacing(vScrollbarWidth, hScrollbarWidth)\r\n        }))\r\n    },\r\n    _setScrollerSpacing: function(hasHeight) {\r\n        if (true === this.option(\"scrolling.useNative\")) {\r\n            deferRender(() => {\r\n                deferUpdate(() => {\r\n                    this._setScrollerSpacingCore(hasHeight)\r\n                })\r\n            })\r\n        } else {\r\n            this._setScrollerSpacingCore(hasHeight)\r\n        }\r\n    },\r\n    _updateDimensionsCore: function() {\r\n        var that = this;\r\n        var dataController = that._dataController;\r\n        var rowsView = that._rowsView;\r\n        var $rootElement = that.component.$element();\r\n        var groupElement = $rootElement.children().get(0);\r\n        var rootElementHeight = $rootElement && ($rootElement.get(0).clientHeight || getHeight($rootElement));\r\n        var maxHeight = parseInt($rootElement.css(\"maxHeight\"));\r\n        var maxHeightHappened = maxHeight && rootElementHeight >= maxHeight;\r\n        var height = that.option(\"height\") || $rootElement.get(0).style.height;\r\n        var editorFactory = that.getController(\"editorFactory\");\r\n        var isMaxHeightApplied = maxHeightHappened && groupElement.scrollHeight === groupElement.offsetHeight;\r\n        var $testDiv;\r\n        that.updateSize($rootElement);\r\n        var hasHeight = that._hasHeight || maxHeightHappened;\r\n        if (height && that._hasHeight ^ \"auto\" !== height) {\r\n            $testDiv = $(\"<div>\");\r\n            setHeight($testDiv, height);\r\n            $testDiv.appendTo($rootElement);\r\n            that._hasHeight = !!getHeight($testDiv);\r\n            $testDiv.remove()\r\n        }\r\n        deferRender((function() {\r\n            rowsView.height(null, hasHeight);\r\n            if (maxHeightHappened && !isMaxHeightApplied) {\r\n                $(groupElement).css(\"height\", maxHeight)\r\n            }\r\n            if (!dataController.isLoaded()) {\r\n                rowsView.setLoading(dataController.isLoading());\r\n                return\r\n            }\r\n            deferUpdate((function() {\r\n                that._updateLastSizes($rootElement);\r\n                that._setScrollerSpacing(hasHeight);\r\n                each(VIEW_NAMES, (function(index, viewName) {\r\n                    var view = that.getView(viewName);\r\n                    if (view) {\r\n                        view.resize()\r\n                    }\r\n                }));\r\n                editorFactory && editorFactory.resize()\r\n            }))\r\n        }))\r\n    },\r\n    _updateLastSizes: function($rootElement) {\r\n        this._lastWidth = getWidth($rootElement);\r\n        this._lastHeight = getHeight($rootElement);\r\n        this._devicePixelRatio = getWindow().devicePixelRatio\r\n    },\r\n    optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"width\":\r\n            case \"height\":\r\n                this.component._renderDimensions();\r\n                this.resize();\r\n            case \"renderAsync\":\r\n                args.handled = true;\r\n                return;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    init: function() {\r\n        this._dataController = this.getController(\"data\");\r\n        this._columnsController = this.getController(\"columns\");\r\n        this._columnHeadersView = this.getView(\"columnHeadersView\");\r\n        this._footerView = this.getView(\"footerView\");\r\n        this._rowsView = this.getView(\"rowsView\")\r\n    }\r\n});\r\nvar SynchronizeScrollingController = modules.ViewController.inherit({\r\n    _scrollChangedHandler: function(views, pos, viewName) {\r\n        for (var j = 0; j < views.length; j++) {\r\n            if (views[j] && views[j].name !== viewName) {\r\n                views[j].scrollTo({\r\n                    left: pos.left,\r\n                    top: pos.top\r\n                })\r\n            }\r\n        }\r\n    },\r\n    init: function() {\r\n        var views = [this.getView(\"columnHeadersView\"), this.getView(\"footerView\"), this.getView(\"rowsView\")];\r\n        for (var i = 0; i < views.length; i++) {\r\n            var view = views[i];\r\n            if (view) {\r\n                view.scrollChanged.add(this._scrollChangedHandler.bind(this, views))\r\n            }\r\n        }\r\n    }\r\n});\r\nvar GridView = modules.View.inherit({\r\n    _endUpdateCore: function() {\r\n        if (this.component._requireResize) {\r\n            this.component._requireResize = false;\r\n            this._resizingController.resize()\r\n        }\r\n    },\r\n    _getWidgetAriaLabel: function() {\r\n        return \"dxDataGrid-ariaDataGrid\"\r\n    },\r\n    init: function() {\r\n        this._resizingController = this.getController(\"resizing\");\r\n        this._dataController = this.getController(\"data\")\r\n    },\r\n    getView: function(name) {\r\n        return this.component._views[name]\r\n    },\r\n    element: function() {\r\n        return this._groupElement\r\n    },\r\n    optionChanged: function(args) {\r\n        if (isDefined(this._groupElement) && \"showBorders\" === args.name) {\r\n            this._groupElement.toggleClass(this.addWidgetPrefix(BORDERS_CLASS), !!args.value);\r\n            args.handled = true\r\n        } else {\r\n            this.callBase(args)\r\n        }\r\n    },\r\n    _renderViews: function($groupElement) {\r\n        var that = this;\r\n        each(VIEW_NAMES, (function(index, viewName) {\r\n            var view = that.getView(viewName);\r\n            if (view) {\r\n                view.render($groupElement)\r\n            }\r\n        }))\r\n    },\r\n    _getTableRoleName: function() {\r\n        return \"grid\"\r\n    },\r\n    render: function($rootElement) {\r\n        var isFirstRender = !this._groupElement;\r\n        var $groupElement = this._groupElement || $(\"<div>\").addClass(this.getWidgetContainerClass());\r\n        $groupElement.addClass(GRIDBASE_CONTAINER_CLASS);\r\n        $groupElement.toggleClass(this.addWidgetPrefix(BORDERS_CLASS), !!this.option(\"showBorders\"));\r\n        this.setAria(\"role\", \"presentation\", $rootElement);\r\n        this.component.setAria({\r\n            role: this._getTableRoleName(),\r\n            label: messageLocalization.format(this._getWidgetAriaLabel())\r\n        }, $groupElement);\r\n        this._rootElement = $rootElement || this._rootElement;\r\n        if (isFirstRender) {\r\n            this._groupElement = $groupElement;\r\n            hasWindow() && this.getController(\"resizing\").updateSize($rootElement);\r\n            $groupElement.appendTo($rootElement)\r\n        }\r\n        this._renderViews($groupElement)\r\n    },\r\n    update: function() {\r\n        var $rootElement = this._rootElement;\r\n        var $groupElement = this._groupElement;\r\n        var resizingController = this.getController(\"resizing\");\r\n        if ($rootElement && $groupElement) {\r\n            resizingController.resize();\r\n            if (this._dataController.isLoaded()) {\r\n                this._resizingController.fireContentReadyAction()\r\n            }\r\n        }\r\n    }\r\n});\r\nexport var gridViewModule = {\r\n    defaultOptions: function() {\r\n        return {\r\n            showBorders: false,\r\n            renderAsync: false\r\n        }\r\n    },\r\n    controllers: {\r\n        resizing: ResizingController,\r\n        synchronizeScrolling: SynchronizeScrollingController\r\n    },\r\n    views: {\r\n        gridView: GridView\r\n    },\r\n    VIEW_NAMES: VIEW_NAMES\r\n};\r\n"]},"metadata":{},"sourceType":"module"}